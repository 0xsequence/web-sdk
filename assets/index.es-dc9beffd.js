import{c as hr,t as bi,g as f1,a as ne,b as p1,w as $l,r as jl,f as vc,d as fo,e as d1,I as _i,A as g1,U as v1,h as Q,i as y1,j as cc,k as m1,_ as _1,P as w1,V as Ah,l as b1,D as E1,C as x1,Z as Ch,$ as I1,m as S1,n as oo,q as P1,o as Ml,p as Fr,y as A1,s as C1,X as cs,u as Ft,v as rr,x as mi,z as ur,B as O1,E as us,F as Ul,G as R1,H as T1,J as N1,K as ql,L as L1,M as zl,Y as kl,N as ls,O as uc,Q as ro,R as ps,S as D1,T as io,W as F1,a0 as $1,a1 as j1,a2 as M1,a3 as U1,a4 as Va,a5 as Oh,a6 as q1,a7 as z1,a8 as k1,a9 as Rh,aa as H1,ab as B1,ac as V1,ad as K1,ae as G1,af as W1,ag as J1,ah as Y1,ai as so,aj as Hl,ak as Ka,al as X1,am as Z1}from"./index-f0cc94c3.js";var kt={},Q1={get exports(){return kt},set exports(c){kt=c}},fs=typeof Reflect=="object"?Reflect:null,Th=fs&&typeof fs.apply=="function"?fs.apply:function(r,i,n){return Function.prototype.apply.call(r,i,n)},no;fs&&typeof fs.ownKeys=="function"?no=fs.ownKeys:Object.getOwnPropertySymbols?no=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:no=function(r){return Object.getOwnPropertyNames(r)};function em(c){console&&console.warn&&console.warn(c)}var Bl=Number.isNaN||function(r){return r!==r};function He(){He.init.call(this)}Q1.exports=He;kt.once=sm;He.EventEmitter=He;He.prototype._events=void 0;He.prototype._eventsCount=0;He.prototype._maxListeners=void 0;var Nh=10;function po(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(He,"defaultMaxListeners",{enumerable:!0,get:function(){return Nh},set:function(c){if(typeof c!="number"||c<0||Bl(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");Nh=c}});He.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};He.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||Bl(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function Vl(c){return c._maxListeners===void 0?He.defaultMaxListeners:c._maxListeners}He.prototype.getMaxListeners=function(){return Vl(this)};He.prototype.emit=function(r){for(var i=[],n=1;n<arguments.length;n++)i.push(arguments[n]);var o=r==="error",h=this._events;if(h!==void 0)o=o&&h.error===void 0;else if(!o)return!1;if(o){var d;if(i.length>0&&(d=i[0]),d instanceof Error)throw d;var y=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw y.context=d,y}var w=h[r];if(w===void 0)return!1;if(typeof w=="function")Th(w,this,i);else for(var A=w.length,F=Yl(w,A),n=0;n<A;++n)Th(F[n],this,i);return!0};function Kl(c,r,i,n){var o,h,d;if(po(i),h=c._events,h===void 0?(h=c._events=Object.create(null),c._eventsCount=0):(h.newListener!==void 0&&(c.emit("newListener",r,i.listener?i.listener:i),h=c._events),d=h[r]),d===void 0)d=h[r]=i,++c._eventsCount;else if(typeof d=="function"?d=h[r]=n?[i,d]:[d,i]:n?d.unshift(i):d.push(i),o=Vl(c),o>0&&d.length>o&&!d.warned){d.warned=!0;var y=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");y.name="MaxListenersExceededWarning",y.emitter=c,y.type=r,y.count=d.length,em(y)}return c}He.prototype.addListener=function(r,i){return Kl(this,r,i,!1)};He.prototype.on=He.prototype.addListener;He.prototype.prependListener=function(r,i){return Kl(this,r,i,!0)};function tm(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Gl(c,r,i){var n={fired:!1,wrapFn:void 0,target:c,type:r,listener:i},o=tm.bind(n);return o.listener=i,n.wrapFn=o,o}He.prototype.once=function(r,i){return po(i),this.on(r,Gl(this,r,i)),this};He.prototype.prependOnceListener=function(r,i){return po(i),this.prependListener(r,Gl(this,r,i)),this};He.prototype.removeListener=function(r,i){var n,o,h,d,y;if(po(i),o=this._events,o===void 0)return this;if(n=o[r],n===void 0)return this;if(n===i||n.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete o[r],o.removeListener&&this.emit("removeListener",r,n.listener||i));else if(typeof n!="function"){for(h=-1,d=n.length-1;d>=0;d--)if(n[d]===i||n[d].listener===i){y=n[d].listener,h=d;break}if(h<0)return this;h===0?n.shift():rm(n,h),n.length===1&&(o[r]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",r,y||i)}return this};He.prototype.off=He.prototype.removeListener;He.prototype.removeAllListeners=function(r){var i,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[r]),this;if(arguments.length===0){var h=Object.keys(n),d;for(o=0;o<h.length;++o)d=h[o],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=n[r],typeof i=="function")this.removeListener(r,i);else if(i!==void 0)for(o=i.length-1;o>=0;o--)this.removeListener(r,i[o]);return this};function Wl(c,r,i){var n=c._events;if(n===void 0)return[];var o=n[r];return o===void 0?[]:typeof o=="function"?i?[o.listener||o]:[o]:i?im(o):Yl(o,o.length)}He.prototype.listeners=function(r){return Wl(this,r,!0)};He.prototype.rawListeners=function(r){return Wl(this,r,!1)};He.listenerCount=function(c,r){return typeof c.listenerCount=="function"?c.listenerCount(r):Jl.call(c,r)};He.prototype.listenerCount=Jl;function Jl(c){var r=this._events;if(r!==void 0){var i=r[c];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}He.prototype.eventNames=function(){return this._eventsCount>0?no(this._events):[]};function Yl(c,r){for(var i=new Array(r),n=0;n<r;++n)i[n]=c[n];return i}function rm(c,r){for(;r+1<c.length;r++)c[r]=c[r+1];c.pop()}function im(c){for(var r=new Array(c.length),i=0;i<r.length;++i)r[i]=c[i].listener||c[i];return r}function sm(c,r){return new Promise(function(i,n){function o(d){c.removeListener(r,h),n(d)}function h(){typeof c.removeListener=="function"&&c.removeListener("error",o),i([].slice.call(arguments))}Xl(c,r,h,{once:!0}),r!=="error"&&nm(c,o,{once:!0})})}function nm(c,r,i){typeof c.on=="function"&&Xl(c,"error",r,i)}function Xl(c,r,i,n){if(typeof c.on=="function")n.once?c.once(r,i):c.on(r,i);else if(typeof c.addEventListener=="function")c.addEventListener(r,function o(h){n.once&&c.removeEventListener(r,o),i(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}var go={},Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});function om(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return JSON.parse(c)}catch{return c}}Ks.safeJsonParse=om;function am(c){return typeof c=="string"?c:JSON.stringify(c,(r,i)=>typeof i>"u"?null:i)}Ks.safeJsonStringify=am;var ao={},Ga={get exports(){return ao},set exports(c){ao=c}},Lh;function cm(){return Lh||(Lh=1,function(){let c;function r(){}c=r,c.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},c.prototype.setItem=function(i,n){this[i]=String(n)},c.prototype.removeItem=function(i){delete this[i]},c.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(n){i[n]=void 0,delete i[n]})},c.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof hr<"u"&&hr.localStorage?Ga.exports=hr.localStorage:typeof window<"u"&&window.localStorage?Ga.exports=window.localStorage:Ga.exports=new r}()),ao}var Wa={},Ds={},Dh;function um(){if(Dh)return Ds;Dh=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.IKeyValueStorage=void 0;class c{}return Ds.IKeyValueStorage=c,Ds}var Fs={},Fh;function hm(){if(Fh)return Fs;Fh=1,Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.parseEntry=void 0;const c=Ks;function r(i){var n;return[i[0],c.safeJsonParse((n=i[1])!==null&&n!==void 0?n:"")]}return Fs.parseEntry=r,Fs}var $h;function lm(){return $h||($h=1,function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=bi;r.__exportStar(um(),c),r.__exportStar(hm(),c)}(Wa)),Wa}Object.defineProperty(go,"__esModule",{value:!0});go.KeyValueStorage=void 0;const hs=bi,jh=Ks,fm=hs.__importDefault(cm()),pm=lm();class Zl{constructor(){this.localStorage=fm.default}getKeys(){return hs.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return hs.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(pm.parseEntry)})}getItem(r){return hs.__awaiter(this,void 0,void 0,function*(){const i=this.localStorage.getItem(r);if(i!==null)return jh.safeJsonParse(i)})}setItem(r,i){return hs.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(r,jh.safeJsonStringify(i))})}removeItem(r){return hs.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(r)})}}go.KeyValueStorage=Zl;var dm=go.default=Zl,ds={},$s={},Ja={},js={};let qi=class{};const gm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:qi},Symbol.toStringTag,{value:"Module"})),vm=f1(gm);var Mh;function ym(){if(Mh)return js;Mh=1,Object.defineProperty(js,"__esModule",{value:!0}),js.IHeartBeat=void 0;const c=vm;class r extends c.IEvents{constructor(n){super()}}return js.IHeartBeat=r,js}var Uh;function Ql(){return Uh||(Uh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),bi.__exportStar(ym(),c)}(Ja)),Ja}var Ya={},Mi={},qh;function mm(){if(qh)return Mi;qh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const c=ne;return Mi.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var zh;function ef(){return zh||(zh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),bi.__exportStar(mm(),c)}(Ya)),Ya}var kh;function _m(){if(kh)return $s;kh=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.HeartBeat=void 0;const c=bi,r=kt,i=ne,n=Ql(),o=ef();class h extends n.IHeartBeat{constructor(y){super(y),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(y==null?void 0:y.interval)||o.HEARTBEAT_INTERVAL}static init(y){return c.__awaiter(this,void 0,void 0,function*(){const w=new h(y);return yield w.init(),w})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(y,w){this.events.on(y,w)}once(y,w){this.events.once(y,w)}off(y,w){this.events.off(y,w)}removeListener(y,w){this.events.removeListener(y,w)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return $s.HeartBeat=h,$s}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=bi;r.__exportStar(_m(),c),r.__exportStar(Ql(),c),r.__exportStar(ef(),c)})(ds);var Re={},Xa,Hh;function wm(){if(Hh)return Xa;Hh=1;function c(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}Xa=r;function r(i,n,o){var h=o&&o.stringify||c,d=1;if(typeof i=="object"&&i!==null){var y=n.length+d;if(y===1)return i;var w=new Array(y);w[0]=h(i);for(var A=1;A<y;A++)w[A]=h(n[A]);return w.join(" ")}if(typeof i!="string")return i;var F=n.length;if(F===0)return i;for(var K="",J=1-d,G=-1,j=i&&i.length||0,V=0;V<j;){if(i.charCodeAt(V)===37&&V+1<j){switch(G=G>-1?G:0,i.charCodeAt(V+1)){case 100:case 102:if(J>=F||n[J]==null)break;G<V&&(K+=i.slice(G,V)),K+=Number(n[J]),G=V+2,V++;break;case 105:if(J>=F||n[J]==null)break;G<V&&(K+=i.slice(G,V)),K+=Math.floor(Number(n[J])),G=V+2,V++;break;case 79:case 111:case 106:if(J>=F||n[J]===void 0)break;G<V&&(K+=i.slice(G,V));var ie=typeof n[J];if(ie==="string"){K+="'"+n[J]+"'",G=V+2,V++;break}if(ie==="function"){K+=n[J].name||"<anonymous>",G=V+2,V++;break}K+=h(n[J]),G=V+2,V++;break;case 115:if(J>=F)break;G<V&&(K+=i.slice(G,V)),K+=String(n[J]),G=V+2,V++;break;case 37:G<V&&(K+=i.slice(G,V)),K+="%",G=V+2,V++,J--;break}++J}++V}return G===-1?i:(G<j&&(K+=i.slice(G)),K)}return Xa}var Za,Bh;function bm(){if(Bh)return Za;Bh=1;const c=wm();Za=o;const r=le().console||{},i={mapHttpRequest:j,mapHttpResponse:j,wrapRequestSerializer:V,wrapResponseSerializer:V,wrapErrorSerializer:V,req:j,res:j,err:J};function n(T,M){return Array.isArray(T)?T.filter(function(ve){return ve!=="!stdSerializers.err"}):T===!0?Object.keys(M):!1}function o(T){T=T||{},T.browser=T.browser||{};const M=T.browser.transmit;if(M&&typeof M.send!="function")throw Error("pino: transmit option must have a send function");const B=T.browser.write||r;T.browser.write&&(T.browser.asObject=!0);const ve=T.serializers||{},re=n(T.browser.serialize,ve);let ue=T.browser.serialize;Array.isArray(T.browser.serialize)&&T.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof B=="function"&&(B.error=B.fatal=B.warn=B.info=B.debug=B.trace=B),T.enabled===!1&&(T.level="silent");const qe=T.level||"info",v=Object.create(B);v.log||(v.log=ie),Object.defineProperty(v,"levelVal",{get:X}),Object.defineProperty(v,"level",{get:ce,set:k});const E={transmit:M,serialize:re,asObject:T.browser.asObject,levels:Te,timestamp:G(T)};v.levels=o.levels,v.level=qe,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=ie,v.serializers=ve,v._serialize=re,v._stdErrSerialize=ue,v.child=U,M&&(v._logEvent=K());function X(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function k(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,h(E,v,"error","log"),h(E,v,"fatal","error"),h(E,v,"warn","error"),h(E,v,"info","log"),h(E,v,"debug","log"),h(E,v,"trace","log")}function U(z,H){if(!z)throw new Error("missing bindings for child Pino");H=H||{},re&&z.serializers&&(H.serializers=z.serializers);const Ye=H.serializers;if(re&&Ye){var Be=Object.assign({},ve,Ye),jr=T.browser.serialize===!0?Object.keys(Be):re;delete z.serializers,w([z],jr,Be,this._stdErrSerialize)}function xe(St){this._childLevel=(St._childLevel|0)+1,this.error=A(St,z,"error"),this.fatal=A(St,z,"fatal"),this.warn=A(St,z,"warn"),this.info=A(St,z,"info"),this.debug=A(St,z,"debug"),this.trace=A(St,z,"trace"),Be&&(this.serializers=Be,this._serialize=jr),M&&(this._logEvent=K([].concat(St._logEvent.bindings,z)))}return xe.prototype=this,new xe(this)}return v}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function h(T,M,B,ve){const re=Object.getPrototypeOf(M);M[B]=M.levelVal>M.levels.values[B]?ie:re[B]?re[B]:r[B]||r[ve]||ie,d(T,M,B)}function d(T,M,B){!T.transmit&&M[B]===ie||(M[B]=function(ve){return function(){const ue=T.timestamp(),Te=new Array(arguments.length),qe=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var v=0;v<Te.length;v++)Te[v]=arguments[v];if(T.serialize&&!T.asObject&&w(Te,this._serialize,this.serializers,this._stdErrSerialize),T.asObject?ve.call(qe,y(this,B,Te,ue)):ve.apply(qe,Te),T.transmit){const E=T.transmit.level||M.level,X=o.levels.values[E],ce=o.levels.values[B];if(ce<X)return;F(this,{ts:ue,methodLevel:B,methodValue:ce,transmitLevel:E,transmitValue:o.levels.values[T.transmit.level||M.level],send:T.transmit.send,val:M.levelVal},Te)}}}(M[B]))}function y(T,M,B,ve){T._serialize&&w(B,T._serialize,T.serializers,T._stdErrSerialize);const re=B.slice();let ue=re[0];const Te={};ve&&(Te.time=ve),Te.level=o.levels.values[M];let qe=(T._childLevel|0)+1;if(qe<1&&(qe=1),ue!==null&&typeof ue=="object"){for(;qe--&&typeof re[0]=="object";)Object.assign(Te,re.shift());ue=re.length?c(re.shift(),re):void 0}else typeof ue=="string"&&(ue=c(re.shift(),re));return ue!==void 0&&(Te.msg=ue),Te}function w(T,M,B,ve){for(const re in T)if(ve&&T[re]instanceof Error)T[re]=o.stdSerializers.err(T[re]);else if(typeof T[re]=="object"&&!Array.isArray(T[re]))for(const ue in T[re])M&&M.indexOf(ue)>-1&&ue in B&&(T[re][ue]=B[ue](T[re][ue]))}function A(T,M,B){return function(){const ve=new Array(1+arguments.length);ve[0]=M;for(var re=1;re<ve.length;re++)ve[re]=arguments[re-1];return T[B].apply(this,ve)}}function F(T,M,B){const ve=M.send,re=M.ts,ue=M.methodLevel,Te=M.methodValue,qe=M.val,v=T._logEvent.bindings;w(B,T._serialize||Object.keys(T.serializers),T.serializers,T._stdErrSerialize===void 0?!0:T._stdErrSerialize),T._logEvent.ts=re,T._logEvent.messages=B.filter(function(E){return v.indexOf(E)===-1}),T._logEvent.level.label=ue,T._logEvent.level.value=Te,ve(ue,T._logEvent,qe),T._logEvent=K(v)}function K(T){return{ts:0,messages:[],bindings:T||[],level:{label:"",value:0}}}function J(T){const M={type:T.constructor.name,msg:T.message,stack:T.stack};for(const B in T)M[B]===void 0&&(M[B]=T[B]);return M}function G(T){return typeof T.timestamp=="function"?T.timestamp:T.timestamp===!1?Ee:ge}function j(){return{}}function V(T){return T}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function T(M){return typeof M<"u"&&M}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return T(self)||T(window)||T(this)||{}}}return Za}var Ui={},Vh;function tf(){return Vh||(Vh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.PINO_CUSTOM_CONTEXT_KEY=Ui.PINO_LOGGER_DEFAULTS=void 0,Ui.PINO_LOGGER_DEFAULTS={level:"info"},Ui.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ui}var tr={},Kh;function Em(){if(Kh)return tr;Kh=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.generateChildLogger=tr.formatChildLoggerContext=tr.getLoggerContext=tr.setBrowserLoggerContext=tr.getBrowserLoggerContext=tr.getDefaultLoggerOptions=void 0;const c=tf();function r(y){return Object.assign(Object.assign({},y),{level:(y==null?void 0:y.level)||c.PINO_LOGGER_DEFAULTS.level})}tr.getDefaultLoggerOptions=r;function i(y,w=c.PINO_CUSTOM_CONTEXT_KEY){return y[w]||""}tr.getBrowserLoggerContext=i;function n(y,w,A=c.PINO_CUSTOM_CONTEXT_KEY){return y[A]=w,y}tr.setBrowserLoggerContext=n;function o(y,w=c.PINO_CUSTOM_CONTEXT_KEY){let A="";return typeof y.bindings>"u"?A=i(y,w):A=y.bindings().context||"",A}tr.getLoggerContext=o;function h(y,w,A=c.PINO_CUSTOM_CONTEXT_KEY){const F=o(y,A);return F.trim()?`${F}/${w}`:w}tr.formatChildLoggerContext=h;function d(y,w,A=c.PINO_CUSTOM_CONTEXT_KEY){const F=h(y,w,A),K=y.child({context:F});return n(K,F,A)}return tr.generateChildLogger=d,tr}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const r=bi,i=r.__importDefault(bm());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return i.default}}),r.__exportStar(tf(),c),r.__exportStar(Em(),c)})(Re);class xm extends qi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class Im extends qi{constructor(r,i){super(),this.core=r,this.logger=i,this.records=new Map}}class Sm{constructor(r,i){this.logger=r,this.core=i}}let Pm=class extends qi{constructor(r,i){super(),this.relayer=r,this.logger=i}},Am=class extends qi{constructor(r){super()}},Cm=class{constructor(r,i,n,o){this.core=r,this.logger=i,this.name=n}};class Om extends qi{constructor(r,i){super(),this.relayer=r,this.logger=i}}let Rm=class extends qi{constructor(r,i){super(),this.core=r,this.logger=i}},Tm=class{constructor(r,i){this.projectId=r,this.logger=i}},Nm=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},Lm=class{constructor(r){this.client=r}};const Dm=c=>JSON.stringify(c,(r,i)=>typeof i=="bigint"?i.toString()+"n":i),Fm=c=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=c.replace(r,'$1"$2n"$3');return JSON.parse(i,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function yc(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return Fm(c)}catch{return c}}function Vs(c){return typeof c=="string"?c:Dm(c)||""}var mc={},rf={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var r=p1,i=$l;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function y(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},y.prototype.update=function(w,A){if(A===void 0&&(A=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var F=0;if(this._bytesHashed+=A,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&A>0;)this._buffer[this._bufferLength++]=w[F++],A--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(A>=this.blockSize&&(F=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,F,A),A%=this.blockSize);A>0;)this._buffer[this._bufferLength++]=w[F++],A--;return this},y.prototype.finish=function(w){if(!this._finished){var A=this._bytesHashed,F=this._bufferLength,K=A/536870912|0,J=A<<3,G=A%128<112?128:256;this._buffer[F]=128;for(var j=F+1;j<G-8;j++)this._buffer[j]=0;r.writeUint32BE(K,this._buffer,G-8),r.writeUint32BE(J,this._buffer,G-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,G),this._finished=!0}for(var j=0;j<this.digestLength/8;j++)r.writeUint32BE(this._stateHi[j],w,j*8),r.writeUint32BE(this._stateLo[j],w,j*8+4);return this},y.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(w){i.wipe(w.stateHi),i.wipe(w.stateLo),w.buffer&&i.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},y}();c.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(y,w,A,F,K,J,G){for(var j=A[0],V=A[1],ie=A[2],Ee=A[3],ge=A[4],pe=A[5],he=A[6],le=A[7],T=F[0],M=F[1],B=F[2],ve=F[3],re=F[4],ue=F[5],Te=F[6],qe=F[7],v,E,X,ce,k,U,z,H;G>=128;){for(var Ye=0;Ye<16;Ye++){var Be=8*Ye+J;y[Ye]=r.readUint32BE(K,Be),w[Ye]=r.readUint32BE(K,Be+4)}for(var Ye=0;Ye<80;Ye++){var jr=j,xe=V,St=ie,R=Ee,O=ge,P=pe,u=he,b=le,ee=T,fe=M,we=B,Ne=ve,De=re,Pe=ue,Pt=Te,_t=qe;if(v=le,E=qe,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),E=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,v=ge&pe^~ge&he,E=re&ue^~re&Te,k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,v=o[Ye*2],E=o[Ye*2+1],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,v=y[Ye%16],E=w[Ye%16],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,X=z&65535|H<<16,ce=k&65535|U<<16,v=X,E=ce,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=(j>>>28|T<<32-28)^(T>>>34-32|j<<32-(34-32))^(T>>>39-32|j<<32-(39-32)),E=(T>>>28|j<<32-28)^(j>>>34-32|T<<32-(34-32))^(j>>>39-32|T<<32-(39-32)),k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,v=j&V^j&ie^V&ie,E=T&M^T&B^M&B,k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,b=z&65535|H<<16,_t=k&65535|U<<16,v=R,E=Ne,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=X,E=ce,k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,R=z&65535|H<<16,Ne=k&65535|U<<16,V=jr,ie=xe,Ee=St,ge=R,pe=O,he=P,le=u,j=b,M=ee,B=fe,ve=we,re=Ne,ue=De,Te=Pe,qe=Pt,T=_t,Ye%16===15)for(var Be=0;Be<16;Be++)v=y[Be],E=w[Be],k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=y[(Be+9)%16],E=w[(Be+9)%16],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,X=y[(Be+1)%16],ce=w[(Be+1)%16],v=(X>>>1|ce<<32-1)^(X>>>8|ce<<32-8)^X>>>7,E=(ce>>>1|X<<32-1)^(ce>>>8|X<<32-8)^(ce>>>7|X<<32-7),k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,X=y[(Be+14)%16],ce=w[(Be+14)%16],v=(X>>>19|ce<<32-19)^(ce>>>61-32|X<<32-(61-32))^X>>>6,E=(ce>>>19|X<<32-19)^(X>>>61-32|ce<<32-(61-32))^(ce>>>6|X<<32-6),k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,y[Be]=z&65535|H<<16,w[Be]=k&65535|U<<16}v=j,E=T,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[0],E=F[0],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[0]=j=z&65535|H<<16,F[0]=T=k&65535|U<<16,v=V,E=M,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[1],E=F[1],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[1]=V=z&65535|H<<16,F[1]=M=k&65535|U<<16,v=ie,E=B,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[2],E=F[2],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[2]=ie=z&65535|H<<16,F[2]=B=k&65535|U<<16,v=Ee,E=ve,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[3],E=F[3],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[3]=Ee=z&65535|H<<16,F[3]=ve=k&65535|U<<16,v=ge,E=re,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[4],E=F[4],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[4]=ge=z&65535|H<<16,F[4]=re=k&65535|U<<16,v=pe,E=ue,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[5],E=F[5],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[5]=pe=z&65535|H<<16,F[5]=ue=k&65535|U<<16,v=he,E=Te,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[6],E=F[6],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[6]=he=z&65535|H<<16,F[6]=Te=k&65535|U<<16,v=le,E=qe,k=E&65535,U=E>>>16,z=v&65535,H=v>>>16,v=A[7],E=F[7],k+=E&65535,U+=E>>>16,z+=v&65535,H+=v>>>16,U+=k>>>16,z+=U>>>16,H+=z>>>16,A[7]=le=z&65535|H<<16,F[7]=qe=k&65535|U<<16,J+=128,G-=128}return J}function d(y){var w=new n;w.update(y);var A=w.digest();return w.clean(),A}c.hash=d})(rf);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const r=jl,i=rf,n=$l;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function o(R){const O=new Float64Array(16);if(R)for(let P=0;P<R.length;P++)O[P]=R[P];return O}const h=new Uint8Array(32);h[0]=9;const d=o(),y=o([1]),w=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),F=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),K=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),J=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function G(R,O){for(let P=0;P<16;P++)R[P]=O[P]|0}function j(R){let O=1;for(let P=0;P<16;P++){let u=R[P]+O+65535;O=Math.floor(u/65536),R[P]=u-O*65536}R[0]+=O-1+37*(O-1)}function V(R,O,P){const u=~(P-1);for(let b=0;b<16;b++){const ee=u&(R[b]^O[b]);R[b]^=ee,O[b]^=ee}}function ie(R,O){const P=o(),u=o();for(let b=0;b<16;b++)u[b]=O[b];j(u),j(u),j(u);for(let b=0;b<2;b++){P[0]=u[0]-65517;for(let fe=1;fe<15;fe++)P[fe]=u[fe]-65535-(P[fe-1]>>16&1),P[fe-1]&=65535;P[15]=u[15]-32767-(P[14]>>16&1);const ee=P[15]>>16&1;P[14]&=65535,V(u,P,1-ee)}for(let b=0;b<16;b++)R[2*b]=u[b]&255,R[2*b+1]=u[b]>>8}function Ee(R,O){let P=0;for(let u=0;u<32;u++)P|=R[u]^O[u];return(1&P-1>>>8)-1}function ge(R,O){const P=new Uint8Array(32),u=new Uint8Array(32);return ie(P,R),ie(u,O),Ee(P,u)}function pe(R){const O=new Uint8Array(32);return ie(O,R),O[0]&1}function he(R,O){for(let P=0;P<16;P++)R[P]=O[2*P]+(O[2*P+1]<<8);R[15]&=32767}function le(R,O,P){for(let u=0;u<16;u++)R[u]=O[u]+P[u]}function T(R,O,P){for(let u=0;u<16;u++)R[u]=O[u]-P[u]}function M(R,O,P){let u,b,ee=0,fe=0,we=0,Ne=0,De=0,Pe=0,Pt=0,_t=0,ot=0,$e=0,Ze=0,Qe=0,at=0,ze=0,et=0,Le=0,Ve=0,ht=0,Me=0,At=0,$t=0,Ht=0,Bt=0,Ut=0,Jt=0,ir=0,Mr=0,Yt=0,Kr=0,ai=0,Ii=0,lt=P[0],it=P[1],ft=P[2],pt=P[3],ct=P[4],st=P[5],Ct=P[6],Ot=P[7],dt=P[8],Rt=P[9],gt=P[10],wt=P[11],vt=P[12],Xe=P[13],Tt=P[14],Nt=P[15];u=O[0],ee+=u*lt,fe+=u*it,we+=u*ft,Ne+=u*pt,De+=u*ct,Pe+=u*st,Pt+=u*Ct,_t+=u*Ot,ot+=u*dt,$e+=u*Rt,Ze+=u*gt,Qe+=u*wt,at+=u*vt,ze+=u*Xe,et+=u*Tt,Le+=u*Nt,u=O[1],fe+=u*lt,we+=u*it,Ne+=u*ft,De+=u*pt,Pe+=u*ct,Pt+=u*st,_t+=u*Ct,ot+=u*Ot,$e+=u*dt,Ze+=u*Rt,Qe+=u*gt,at+=u*wt,ze+=u*vt,et+=u*Xe,Le+=u*Tt,Ve+=u*Nt,u=O[2],we+=u*lt,Ne+=u*it,De+=u*ft,Pe+=u*pt,Pt+=u*ct,_t+=u*st,ot+=u*Ct,$e+=u*Ot,Ze+=u*dt,Qe+=u*Rt,at+=u*gt,ze+=u*wt,et+=u*vt,Le+=u*Xe,Ve+=u*Tt,ht+=u*Nt,u=O[3],Ne+=u*lt,De+=u*it,Pe+=u*ft,Pt+=u*pt,_t+=u*ct,ot+=u*st,$e+=u*Ct,Ze+=u*Ot,Qe+=u*dt,at+=u*Rt,ze+=u*gt,et+=u*wt,Le+=u*vt,Ve+=u*Xe,ht+=u*Tt,Me+=u*Nt,u=O[4],De+=u*lt,Pe+=u*it,Pt+=u*ft,_t+=u*pt,ot+=u*ct,$e+=u*st,Ze+=u*Ct,Qe+=u*Ot,at+=u*dt,ze+=u*Rt,et+=u*gt,Le+=u*wt,Ve+=u*vt,ht+=u*Xe,Me+=u*Tt,At+=u*Nt,u=O[5],Pe+=u*lt,Pt+=u*it,_t+=u*ft,ot+=u*pt,$e+=u*ct,Ze+=u*st,Qe+=u*Ct,at+=u*Ot,ze+=u*dt,et+=u*Rt,Le+=u*gt,Ve+=u*wt,ht+=u*vt,Me+=u*Xe,At+=u*Tt,$t+=u*Nt,u=O[6],Pt+=u*lt,_t+=u*it,ot+=u*ft,$e+=u*pt,Ze+=u*ct,Qe+=u*st,at+=u*Ct,ze+=u*Ot,et+=u*dt,Le+=u*Rt,Ve+=u*gt,ht+=u*wt,Me+=u*vt,At+=u*Xe,$t+=u*Tt,Ht+=u*Nt,u=O[7],_t+=u*lt,ot+=u*it,$e+=u*ft,Ze+=u*pt,Qe+=u*ct,at+=u*st,ze+=u*Ct,et+=u*Ot,Le+=u*dt,Ve+=u*Rt,ht+=u*gt,Me+=u*wt,At+=u*vt,$t+=u*Xe,Ht+=u*Tt,Bt+=u*Nt,u=O[8],ot+=u*lt,$e+=u*it,Ze+=u*ft,Qe+=u*pt,at+=u*ct,ze+=u*st,et+=u*Ct,Le+=u*Ot,Ve+=u*dt,ht+=u*Rt,Me+=u*gt,At+=u*wt,$t+=u*vt,Ht+=u*Xe,Bt+=u*Tt,Ut+=u*Nt,u=O[9],$e+=u*lt,Ze+=u*it,Qe+=u*ft,at+=u*pt,ze+=u*ct,et+=u*st,Le+=u*Ct,Ve+=u*Ot,ht+=u*dt,Me+=u*Rt,At+=u*gt,$t+=u*wt,Ht+=u*vt,Bt+=u*Xe,Ut+=u*Tt,Jt+=u*Nt,u=O[10],Ze+=u*lt,Qe+=u*it,at+=u*ft,ze+=u*pt,et+=u*ct,Le+=u*st,Ve+=u*Ct,ht+=u*Ot,Me+=u*dt,At+=u*Rt,$t+=u*gt,Ht+=u*wt,Bt+=u*vt,Ut+=u*Xe,Jt+=u*Tt,ir+=u*Nt,u=O[11],Qe+=u*lt,at+=u*it,ze+=u*ft,et+=u*pt,Le+=u*ct,Ve+=u*st,ht+=u*Ct,Me+=u*Ot,At+=u*dt,$t+=u*Rt,Ht+=u*gt,Bt+=u*wt,Ut+=u*vt,Jt+=u*Xe,ir+=u*Tt,Mr+=u*Nt,u=O[12],at+=u*lt,ze+=u*it,et+=u*ft,Le+=u*pt,Ve+=u*ct,ht+=u*st,Me+=u*Ct,At+=u*Ot,$t+=u*dt,Ht+=u*Rt,Bt+=u*gt,Ut+=u*wt,Jt+=u*vt,ir+=u*Xe,Mr+=u*Tt,Yt+=u*Nt,u=O[13],ze+=u*lt,et+=u*it,Le+=u*ft,Ve+=u*pt,ht+=u*ct,Me+=u*st,At+=u*Ct,$t+=u*Ot,Ht+=u*dt,Bt+=u*Rt,Ut+=u*gt,Jt+=u*wt,ir+=u*vt,Mr+=u*Xe,Yt+=u*Tt,Kr+=u*Nt,u=O[14],et+=u*lt,Le+=u*it,Ve+=u*ft,ht+=u*pt,Me+=u*ct,At+=u*st,$t+=u*Ct,Ht+=u*Ot,Bt+=u*dt,Ut+=u*Rt,Jt+=u*gt,ir+=u*wt,Mr+=u*vt,Yt+=u*Xe,Kr+=u*Tt,ai+=u*Nt,u=O[15],Le+=u*lt,Ve+=u*it,ht+=u*ft,Me+=u*pt,At+=u*ct,$t+=u*st,Ht+=u*Ct,Bt+=u*Ot,Ut+=u*dt,Jt+=u*Rt,ir+=u*gt,Mr+=u*wt,Yt+=u*vt,Kr+=u*Xe,ai+=u*Tt,Ii+=u*Nt,ee+=38*Ve,fe+=38*ht,we+=38*Me,Ne+=38*At,De+=38*$t,Pe+=38*Ht,Pt+=38*Bt,_t+=38*Ut,ot+=38*Jt,$e+=38*ir,Ze+=38*Mr,Qe+=38*Yt,at+=38*Kr,ze+=38*ai,et+=38*Ii,b=1,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=fe+b+65535,b=Math.floor(u/65536),fe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,u=De+b+65535,b=Math.floor(u/65536),De=u-b*65536,u=Pe+b+65535,b=Math.floor(u/65536),Pe=u-b*65536,u=Pt+b+65535,b=Math.floor(u/65536),Pt=u-b*65536,u=_t+b+65535,b=Math.floor(u/65536),_t=u-b*65536,u=ot+b+65535,b=Math.floor(u/65536),ot=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=Ze+b+65535,b=Math.floor(u/65536),Ze=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=ze+b+65535,b=Math.floor(u/65536),ze=u-b*65536,u=et+b+65535,b=Math.floor(u/65536),et=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,ee+=b-1+37*(b-1),b=1,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=fe+b+65535,b=Math.floor(u/65536),fe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,u=De+b+65535,b=Math.floor(u/65536),De=u-b*65536,u=Pe+b+65535,b=Math.floor(u/65536),Pe=u-b*65536,u=Pt+b+65535,b=Math.floor(u/65536),Pt=u-b*65536,u=_t+b+65535,b=Math.floor(u/65536),_t=u-b*65536,u=ot+b+65535,b=Math.floor(u/65536),ot=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=Ze+b+65535,b=Math.floor(u/65536),Ze=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=ze+b+65535,b=Math.floor(u/65536),ze=u-b*65536,u=et+b+65535,b=Math.floor(u/65536),et=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,ee+=b-1+37*(b-1),R[0]=ee,R[1]=fe,R[2]=we,R[3]=Ne,R[4]=De,R[5]=Pe,R[6]=Pt,R[7]=_t,R[8]=ot,R[9]=$e,R[10]=Ze,R[11]=Qe,R[12]=at,R[13]=ze,R[14]=et,R[15]=Le}function B(R,O){M(R,O,O)}function ve(R,O){const P=o();let u;for(u=0;u<16;u++)P[u]=O[u];for(u=253;u>=0;u--)B(P,P),u!==2&&u!==4&&M(P,P,O);for(u=0;u<16;u++)R[u]=P[u]}function re(R,O){const P=o();let u;for(u=0;u<16;u++)P[u]=O[u];for(u=250;u>=0;u--)B(P,P),u!==1&&M(P,P,O);for(u=0;u<16;u++)R[u]=P[u]}function ue(R,O){const P=o(),u=o(),b=o(),ee=o(),fe=o(),we=o(),Ne=o(),De=o(),Pe=o();T(P,R[1],R[0]),T(Pe,O[1],O[0]),M(P,P,Pe),le(u,R[0],R[1]),le(Pe,O[0],O[1]),M(u,u,Pe),M(b,R[3],O[3]),M(b,b,A),M(ee,R[2],O[2]),le(ee,ee,ee),T(fe,u,P),T(we,ee,b),le(Ne,ee,b),le(De,u,P),M(R[0],fe,we),M(R[1],De,Ne),M(R[2],Ne,we),M(R[3],fe,De)}function Te(R,O,P){for(let u=0;u<4;u++)V(R[u],O[u],P)}function qe(R,O){const P=o(),u=o(),b=o();ve(b,O[2]),M(P,O[0],b),M(u,O[1],b),ie(R,u),R[31]^=pe(P)<<7}function v(R,O,P){G(R[0],d),G(R[1],y),G(R[2],y),G(R[3],d);for(let u=255;u>=0;--u){const b=P[u/8|0]>>(u&7)&1;Te(R,O,b),ue(O,R),ue(R,R),Te(R,O,b)}}function E(R,O){const P=[o(),o(),o(),o()];G(P[0],F),G(P[1],K),G(P[2],y),M(P[3],F,K),v(R,P,O)}function X(R){if(R.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const O=(0,i.hash)(R);O[0]&=248,O[31]&=127,O[31]|=64;const P=new Uint8Array(32),u=[o(),o(),o(),o()];E(u,O),qe(P,u);const b=new Uint8Array(64);return b.set(R),b.set(P,32),{publicKey:P,secretKey:b}}c.generateKeyPairFromSeed=X;function ce(R){const O=(0,r.randomBytes)(32,R),P=X(O);return(0,n.wipe)(O),P}c.generateKeyPair=ce;function k(R){if(R.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(R.subarray(32))}c.extractPublicKeyFromSecretKey=k;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(R,O){let P,u,b,ee;for(u=63;u>=32;--u){for(P=0,b=u-32,ee=u-12;b<ee;++b)O[b]+=P-16*O[u]*U[b-(u-32)],P=Math.floor((O[b]+128)/256),O[b]-=P*256;O[b]+=P,O[u]=0}for(P=0,b=0;b<32;b++)O[b]+=P-(O[31]>>4)*U[b],P=O[b]>>8,O[b]&=255;for(b=0;b<32;b++)O[b]-=P*U[b];for(u=0;u<32;u++)O[u+1]+=O[u]>>8,R[u]=O[u]&255}function H(R){const O=new Float64Array(64);for(let P=0;P<64;P++)O[P]=R[P];for(let P=0;P<64;P++)R[P]=0;z(R,O)}function Ye(R,O){const P=new Float64Array(64),u=[o(),o(),o(),o()],b=(0,i.hash)(R.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const ee=new Uint8Array(64);ee.set(b.subarray(32),32);const fe=new i.SHA512;fe.update(ee.subarray(32)),fe.update(O);const we=fe.digest();fe.clean(),H(we),E(u,we),qe(ee,u),fe.reset(),fe.update(ee.subarray(0,32)),fe.update(R.subarray(32)),fe.update(O);const Ne=fe.digest();H(Ne);for(let De=0;De<32;De++)P[De]=we[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)P[De+Pe]+=Ne[De]*b[Pe];return z(ee.subarray(32),P),ee}c.sign=Ye;function Be(R,O){const P=o(),u=o(),b=o(),ee=o(),fe=o(),we=o(),Ne=o();return G(R[2],y),he(R[1],O),B(b,R[1]),M(ee,b,w),T(b,b,R[2]),le(ee,R[2],ee),B(fe,ee),B(we,fe),M(Ne,we,fe),M(P,Ne,b),M(P,P,ee),re(P,P),M(P,P,b),M(P,P,ee),M(P,P,ee),M(R[0],P,ee),B(u,R[0]),M(u,u,ee),ge(u,b)&&M(R[0],R[0],J),B(u,R[0]),M(u,u,ee),ge(u,b)?-1:(pe(R[0])===O[31]>>7&&T(R[0],d,R[0]),M(R[3],R[0],R[1]),0)}function jr(R,O,P){const u=new Uint8Array(32),b=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(P.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(Be(ee,R))return!1;const fe=new i.SHA512;fe.update(P.subarray(0,32)),fe.update(R),fe.update(O);const we=fe.digest();return H(we),v(b,ee,we),E(ee,P.subarray(32)),ue(b,ee),qe(u,b),!Ee(P,u)}c.verify=jr;function xe(R){let O=[o(),o(),o(),o()];if(Be(O,R))throw new Error("Ed25519: invalid public key");let P=o(),u=o(),b=O[1];le(P,y,b),T(u,y,b),ve(u,u),M(P,P,u);let ee=new Uint8Array(32);return ie(ee,P),ee}c.convertPublicKeyToX25519=xe;function St(R){const O=(0,i.hash)(R.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const P=new Uint8Array(O.subarray(0,32));return(0,n.wipe)(O),P}c.convertSecretKeyToX25519=St})(mc);const $m="EdDSA",jm="JWT",sf=".",nf="base64url",Mm="utf8",Um="utf8",qm=":",zm="did",km="key",Gh="base58btc",Hm="z",Bm="K36",Vm=32;function co(c){return fo(vc(Vs(c),Mm),nf)}function of(c){const r=vc(Bm,Gh),i=Hm+fo(d1([r,c]),Gh);return[zm,km,i].join(qm)}function Km(c){return fo(c,nf)}function Gm(c){return vc([co(c.header),co(c.payload)].join(sf),Um)}function Wm(c){return[co(c.header),co(c.payload),Km(c.signature)].join(sf)}function Wh(c=jl.randomBytes(Vm)){return mc.generateKeyPairFromSeed(c)}async function Jm(c,r,i,n,o=ne.fromMiliseconds(Date.now())){const h={alg:$m,typ:jm},d=of(n.publicKey),y=o+i,w={iss:d,sub:c,aud:r,iat:o,exp:y},A=Gm({header:h,payload:w}),F=mc.sign(n.secretKey,A);return Wm({header:h,payload:w,signature:F})}const Ym="PARSE_ERROR",Xm="INVALID_REQUEST",Zm="METHOD_NOT_FOUND",Qm="INVALID_PARAMS",af="INTERNAL_ERROR",_c="SERVER_ERROR",e_=[-32700,-32600,-32601,-32602,-32603],Bs={[Ym]:{code:-32700,message:"Parse error"},[Xm]:{code:-32600,message:"Invalid Request"},[Zm]:{code:-32601,message:"Method not found"},[Qm]:{code:-32602,message:"Invalid params"},[af]:{code:-32603,message:"Internal error"},[_c]:{code:-32e3,message:"Server error"}},cf=_c;function t_(c){return e_.includes(c)}function Jh(c){return Object.keys(Bs).includes(c)?Bs[c]:Bs[cf]}function r_(c){const r=Object.values(Bs).find(i=>i.code===c);return r||Bs[cf]}function uf(c,r,i){return c.message.includes("getaddrinfo ENOTFOUND")||c.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${r}`):c}var hf={},si={},Yh;function i_(){if(Yh)return si;Yh=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowserCryptoAvailable=si.getSubtleCrypto=si.getBrowerCrypto=void 0;function c(){return(hr===null||hr===void 0?void 0:hr.crypto)||(hr===null||hr===void 0?void 0:hr.msCrypto)||{}}si.getBrowerCrypto=c;function r(){const n=c();return n.subtle||n.webkitSubtle}si.getSubtleCrypto=r;function i(){return!!c()&&!!r()}return si.isBrowserCryptoAvailable=i,si}var ni={},Xh;function s_(){if(Xh)return ni;Xh=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowser=ni.isNode=ni.isReactNative=void 0;function c(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ni.isReactNative=c;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ni.isNode=r;function i(){return!c()&&!r()}return ni.isBrowser=i,ni}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=bi;r.__exportStar(i_(),c),r.__exportStar(s_(),c)})(hf);function lf(c=3){const r=Date.now()*Math.pow(10,c),i=Math.floor(Math.random()*Math.pow(10,c));return r+i}function wc(c=6){return BigInt(lf(c))}function vo(c,r,i){return{id:i||lf(),jsonrpc:"2.0",method:c,params:r}}function bc(c,r){return{id:c,jsonrpc:"2.0",result:r}}function yo(c,r,i){return{id:c,jsonrpc:"2.0",error:n_(r,i)}}function n_(c,r){return typeof c>"u"?Jh(af):(typeof c=="string"&&(c=Object.assign(Object.assign({},Jh(_c)),{message:c})),typeof r<"u"&&(c.data=r),t_(c.code)&&(c=r_(c.code)),c)}class o_{}class a_ extends o_{constructor(){super()}}class c_ extends a_{constructor(r){super()}}const u_="^https?:",h_="^wss?:";function l_(c){const r=c.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function ff(c,r){const i=l_(c);return typeof i>"u"?!1:new RegExp(r).test(i)}function Zh(c){return ff(c,u_)}function Qh(c){return ff(c,h_)}function f_(c){return new RegExp("wss?://localhost(:d{2,5})?").test(c)}function pf(c){return typeof c=="object"&&"id"in c&&"jsonrpc"in c&&c.jsonrpc==="2.0"}function Ec(c){return pf(c)&&"method"in c}function mo(c){return pf(c)&&(oi(c)||$r(c))}function oi(c){return"result"in c}function $r(c){return"error"in c}class Ei extends c_{constructor(r){super(r),this.events=new kt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async request(r,i){return this.requestStrict(vo(r.method,r.params||[],r.id||wc().toString()),i)}async requestStrict(r,i){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${r.id}`,h=>{$r(h)?o(h.error):n(h.result)});try{await this.connection.send(r,i)}catch(h){o(h)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),mo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const p_=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),d_=()=>typeof window<"u",el=c=>c.split("?")[0],tl=10,g_=p_();class v_{constructor(r){if(this.url=r,this.events=new kt.EventEmitter,this.registering=!1,!Qh(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Vs(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!Qh(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((i,n)=>{const o=hf.isReactNative()?void 0:{rejectUnauthorized:!f_(r)},h=new g_(r,[],o);d_()?h.onerror=d=>{const y=d;n(this.emitError(y.error))}:h.on("error",d=>{n(this.emitError(d))}),h.onopen=()=>{this.onOpen(h),i(h)}})}onOpen(r){r.onmessage=i=>this.onPayload(i),r.onclose=i=>this.onClose(i),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?yc(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),h=yo(r,o);this.events.emit("payload",h)}parseError(r,i=this.url){return uf(r,el(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>tl&&this.events.setMaxListeners(tl)}emitError(r){const i=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${el(this.url)}`));return this.events.emit("register_error",i),i}}var uo={},y_={get exports(){return uo},set exports(c){uo=c}};(function(c,r){var i=200,n="__lodash_hash_undefined__",o=1,h=2,d=9007199254740991,y="[object Arguments]",w="[object Array]",A="[object AsyncFunction]",F="[object Boolean]",K="[object Date]",J="[object Error]",G="[object Function]",j="[object GeneratorFunction]",V="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",T="[object Set]",M="[object String]",B="[object Symbol]",ve="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",qe="[object Float32Array]",v="[object Float64Array]",E="[object Int8Array]",X="[object Int16Array]",ce="[object Int32Array]",k="[object Uint8Array]",U="[object Uint8ClampedArray]",z="[object Uint16Array]",H="[object Uint32Array]",Ye=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,jr=/^(?:0|[1-9]\d*)$/,xe={};xe[qe]=xe[v]=xe[E]=xe[X]=xe[ce]=xe[k]=xe[U]=xe[z]=xe[H]=!0,xe[y]=xe[w]=xe[ue]=xe[F]=xe[Te]=xe[K]=xe[J]=xe[G]=xe[V]=xe[ie]=xe[ge]=xe[le]=xe[T]=xe[M]=xe[re]=!1;var St=typeof hr=="object"&&hr&&hr.Object===Object&&hr,R=typeof self=="object"&&self&&self.Object===Object&&self,O=St||R||Function("return this")(),P=r&&!r.nodeType&&r,u=P&&!0&&c&&!c.nodeType&&c,b=u&&u.exports===P,ee=b&&St.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),we=fe&&fe.isTypedArray;function Ne(g,x){for(var $=-1,Y=g==null?0:g.length,Ge=0,ye=[];++$<Y;){var tt=g[$];x(tt,$,g)&&(ye[Ge++]=tt)}return ye}function De(g,x){for(var $=-1,Y=x.length,Ge=g.length;++$<Y;)g[Ge+$]=x[$];return g}function Pe(g,x){for(var $=-1,Y=g==null?0:g.length;++$<Y;)if(x(g[$],$,g))return!0;return!1}function Pt(g,x){for(var $=-1,Y=Array(g);++$<g;)Y[$]=x($);return Y}function _t(g){return function(x){return g(x)}}function ot(g,x){return g.has(x)}function $e(g,x){return g==null?void 0:g[x]}function Ze(g){var x=-1,$=Array(g.size);return g.forEach(function(Y,Ge){$[++x]=[Ge,Y]}),$}function Qe(g,x){return function($){return g(x($))}}function at(g){var x=-1,$=Array(g.size);return g.forEach(function(Y){$[++x]=Y}),$}var ze=Array.prototype,et=Function.prototype,Le=Object.prototype,Ve=O["__core-js_shared__"],ht=et.toString,Me=Le.hasOwnProperty,At=function(){var g=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),$t=Le.toString,Ht=RegExp("^"+ht.call(Me).replace(Ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bt=b?O.Buffer:void 0,Ut=O.Symbol,Jt=O.Uint8Array,ir=Le.propertyIsEnumerable,Mr=ze.splice,Yt=Ut?Ut.toStringTag:void 0,Kr=Object.getOwnPropertySymbols,ai=Bt?Bt.isBuffer:void 0,Ii=Qe(Object.keys,Object),lt=lr(O,"DataView"),it=lr(O,"Map"),ft=lr(O,"Promise"),pt=lr(O,"Set"),ct=lr(O,"WeakMap"),st=lr(Object,"create"),Ct=Wr(lt),Ot=Wr(it),dt=Wr(ft),Rt=Wr(pt),gt=Wr(ct),wt=Ut?Ut.prototype:void 0,vt=wt?wt.valueOf:void 0;function Xe(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Y=g[x];this.set(Y[0],Y[1])}}function Tt(){this.__data__=st?st(null):{},this.size=0}function Nt(g){var x=this.has(g)&&delete this.__data__[g];return this.size-=x?1:0,x}function bo(g){var x=this.__data__;if(st){var $=x[g];return $===n?void 0:$}return Me.call(x,g)?x[g]:void 0}function Eo(g){var x=this.__data__;return st?x[g]!==void 0:Me.call(x,g)}function xo(g,x){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=st&&x===void 0?n:x,this}Xe.prototype.clear=Tt,Xe.prototype.delete=Nt,Xe.prototype.get=bo,Xe.prototype.has=Eo,Xe.prototype.set=xo;function yr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Y=g[x];this.set(Y[0],Y[1])}}function Io(){this.__data__=[],this.size=0}function So(g){var x=this.__data__,$=Si(x,g);if($<0)return!1;var Y=x.length-1;return $==Y?x.pop():Mr.call(x,$,1),--this.size,!0}function Po(g){var x=this.__data__,$=Si(x,g);return $<0?void 0:x[$][1]}function Ao(g){return Si(this.__data__,g)>-1}function Co(g,x){var $=this.__data__,Y=Si($,g);return Y<0?(++this.size,$.push([g,x])):$[Y][1]=x,this}yr.prototype.clear=Io,yr.prototype.delete=So,yr.prototype.get=Po,yr.prototype.has=Ao,yr.prototype.set=Co;function Gr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Y=g[x];this.set(Y[0],Y[1])}}function ki(){this.size=0,this.__data__={hash:new Xe,map:new(it||yr),string:new Xe}}function Oo(g){var x=ci(this,g).delete(g);return this.size-=x?1:0,x}function Hi(g){return ci(this,g).get(g)}function Ro(g){return ci(this,g).has(g)}function To(g,x){var $=ci(this,g),Y=$.size;return $.set(g,x),this.size+=$.size==Y?0:1,this}Gr.prototype.clear=ki,Gr.prototype.delete=Oo,Gr.prototype.get=Hi,Gr.prototype.has=Ro,Gr.prototype.set=To;function Bi(g){var x=-1,$=g==null?0:g.length;for(this.__data__=new Gr;++x<$;)this.add(g[x])}function Ws(g){return this.__data__.set(g,n),this}function Js(g){return this.__data__.has(g)}Bi.prototype.add=Bi.prototype.push=Ws,Bi.prototype.has=Js;function Or(g){var x=this.__data__=new yr(g);this.size=x.size}function No(){this.__data__=new yr,this.size=0}function Lo(g){var x=this.__data__,$=x.delete(g);return this.size=x.size,$}function Do(g){return this.__data__.get(g)}function Fo(g){return this.__data__.has(g)}function Ys(g,x){var $=this.__data__;if($ instanceof yr){var Y=$.__data__;if(!it||Y.length<i-1)return Y.push([g,x]),this.size=++$.size,this;$=this.__data__=new Gr(Y)}return $.set(g,x),this.size=$.size,this}Or.prototype.clear=No,Or.prototype.delete=Lo,Or.prototype.get=Do,Or.prototype.has=Fo,Or.prototype.set=Ys;function Xs(g,x){var $=Gi(g),Y=!$&&hn(g),Ge=!$&&!Y&&ys(g),ye=!$&&!Y&&!Ge&&pn(g),tt=$||Y||Ge||ye,Lt=tt?Pt(g.length,String):[],Ce=Lt.length;for(var We in g)(x||Me.call(g,We))&&!(tt&&(We=="length"||Ge&&(We=="offset"||We=="parent")||ye&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||nn(We,Ce)))&&Lt.push(We);return Lt}function Si(g,x){for(var $=g.length;$--;)if(un(g[$][0],x))return $;return-1}function gs(g,x,$){var Y=x(g);return Gi(g)?Y:De(Y,$(g))}function Pi(g){return g==null?g===void 0?ve:Ee:Yt&&Yt in Object(g)?rn(g):Mo(g)}function vs(g){return Ci(g)&&Pi(g)==y}function Ai(g,x,$,Y,Ge){return g===x?!0:g==null||x==null||!Ci(g)&&!Ci(x)?g!==g&&x!==x:Zs(g,x,$,Y,Ai,Ge)}function Zs(g,x,$,Y,Ge,ye){var tt=Gi(g),Lt=Gi(x),Ce=tt?w:Ur(g),We=Lt?w:Ur(x);Ce=Ce==y?ge:Ce,We=We==y?ge:We;var bt=Ce==ge,sr=We==ge,Dt=Ce==We;if(Dt&&ys(g)){if(!ys(x))return!1;tt=!0,bt=!1}if(Dt&&!bt)return ye||(ye=new Or),tt||pn(g)?Vi(g,x,$,Y,Ge,ye):jo(g,x,Ce,$,Y,Ge,ye);if(!($&o)){var rt=bt&&Me.call(g,"__wrapped__"),Xt=sr&&Me.call(x,"__wrapped__");if(rt||Xt){var Rr=rt?g.value():g,mr=Xt?x.value():x;return ye||(ye=new Or),Ge(Rr,mr,$,Y,ye)}}return Dt?(ye||(ye=new Or),tn(g,x,$,Y,Ge,ye)):!1}function $o(g){if(!fn(g)||an(g))return!1;var x=Wi(g)?Ht:Be;return x.test(Wr(g))}function Qs(g){return Ci(g)&&ln(g.length)&&!!xe[Pi(g)]}function en(g){if(!cn(g))return Ii(g);var x=[];for(var $ in Object(g))Me.call(g,$)&&$!="constructor"&&x.push($);return x}function Vi(g,x,$,Y,Ge,ye){var tt=$&o,Lt=g.length,Ce=x.length;if(Lt!=Ce&&!(tt&&Ce>Lt))return!1;var We=ye.get(g);if(We&&ye.get(x))return We==x;var bt=-1,sr=!0,Dt=$&h?new Bi:void 0;for(ye.set(g,x),ye.set(x,g);++bt<Lt;){var rt=g[bt],Xt=x[bt];if(Y)var Rr=tt?Y(Xt,rt,bt,x,g,ye):Y(rt,Xt,bt,g,x,ye);if(Rr!==void 0){if(Rr)continue;sr=!1;break}if(Dt){if(!Pe(x,function(mr,qr){if(!ot(Dt,qr)&&(rt===mr||Ge(rt,mr,$,Y,ye)))return Dt.push(qr)})){sr=!1;break}}else if(!(rt===Xt||Ge(rt,Xt,$,Y,ye))){sr=!1;break}}return ye.delete(g),ye.delete(x),sr}function jo(g,x,$,Y,Ge,ye,tt){switch($){case Te:if(g.byteLength!=x.byteLength||g.byteOffset!=x.byteOffset)return!1;g=g.buffer,x=x.buffer;case ue:return!(g.byteLength!=x.byteLength||!ye(new Jt(g),new Jt(x)));case F:case K:case ie:return un(+g,+x);case J:return g.name==x.name&&g.message==x.message;case le:case M:return g==x+"";case V:var Lt=Ze;case T:var Ce=Y&o;if(Lt||(Lt=at),g.size!=x.size&&!Ce)return!1;var We=tt.get(g);if(We)return We==x;Y|=h,tt.set(g,x);var bt=Vi(Lt(g),Lt(x),Y,Ge,ye,tt);return tt.delete(g),bt;case B:if(vt)return vt.call(g)==vt.call(x)}return!1}function tn(g,x,$,Y,Ge,ye){var tt=$&o,Lt=Ki(g),Ce=Lt.length,We=Ki(x),bt=We.length;if(Ce!=bt&&!tt)return!1;for(var sr=Ce;sr--;){var Dt=Lt[sr];if(!(tt?Dt in x:Me.call(x,Dt)))return!1}var rt=ye.get(g);if(rt&&ye.get(x))return rt==x;var Xt=!0;ye.set(g,x),ye.set(x,g);for(var Rr=tt;++sr<Ce;){Dt=Lt[sr];var mr=g[Dt],qr=x[Dt];if(Y)var ms=tt?Y(qr,mr,Dt,x,g,ye):Y(mr,qr,Dt,g,x,ye);if(!(ms===void 0?mr===qr||Ge(mr,qr,$,Y,ye):ms)){Xt=!1;break}Rr||(Rr=Dt=="constructor")}if(Xt&&!Rr){var Oi=g.constructor,qt=x.constructor;Oi!=qt&&"constructor"in g&&"constructor"in x&&!(typeof Oi=="function"&&Oi instanceof Oi&&typeof qt=="function"&&qt instanceof qt)&&(Xt=!1)}return ye.delete(g),ye.delete(x),Xt}function Ki(g){return gs(g,zo,sn)}function ci(g,x){var $=g.__data__;return on(x)?$[typeof x=="string"?"string":"hash"]:$.map}function lr(g,x){var $=$e(g,x);return $o($)?$:void 0}function rn(g){var x=Me.call(g,Yt),$=g[Yt];try{g[Yt]=void 0;var Y=!0}catch{}var Ge=$t.call(g);return Y&&(x?g[Yt]=$:delete g[Yt]),Ge}var sn=Kr?function(g){return g==null?[]:(g=Object(g),Ne(Kr(g),function(x){return ir.call(g,x)}))}:Ke,Ur=Pi;(lt&&Ur(new lt(new ArrayBuffer(1)))!=Te||it&&Ur(new it)!=V||ft&&Ur(ft.resolve())!=pe||pt&&Ur(new pt)!=T||ct&&Ur(new ct)!=re)&&(Ur=function(g){var x=Pi(g),$=x==ge?g.constructor:void 0,Y=$?Wr($):"";if(Y)switch(Y){case Ct:return Te;case Ot:return V;case dt:return pe;case Rt:return T;case gt:return re}return x});function nn(g,x){return x=x??d,!!x&&(typeof g=="number"||jr.test(g))&&g>-1&&g%1==0&&g<x}function on(g){var x=typeof g;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?g!=="__proto__":g===null}function an(g){return!!At&&At in g}function cn(g){var x=g&&g.constructor,$=typeof x=="function"&&x.prototype||Le;return g===$}function Mo(g){return $t.call(g)}function Wr(g){if(g!=null){try{return ht.call(g)}catch{}try{return g+""}catch{}}return""}function un(g,x){return g===x||g!==g&&x!==x}var hn=vs(function(){return arguments}())?vs:function(g){return Ci(g)&&Me.call(g,"callee")&&!ir.call(g,"callee")},Gi=Array.isArray;function Uo(g){return g!=null&&ln(g.length)&&!Wi(g)}var ys=ai||ke;function qo(g,x){return Ai(g,x)}function Wi(g){if(!fn(g))return!1;var x=Pi(g);return x==G||x==j||x==A||x==he}function ln(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function fn(g){var x=typeof g;return g!=null&&(x=="object"||x=="function")}function Ci(g){return g!=null&&typeof g=="object"}var pn=we?_t(we):Qs;function zo(g){return Uo(g)?Xs(g):en(g)}function Ke(){return[]}function ke(){return!1}c.exports=qo})(y_,uo);function m_(c,r){if(c.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var o=0;o<c.length;o++){var h=c.charAt(o),d=h.charCodeAt(0);if(i[d]!==255)throw new TypeError(h+" is ambiguous");i[d]=o}var y=c.length,w=c.charAt(0),A=Math.log(y)/Math.log(256),F=Math.log(256)/Math.log(y);function K(j){if(j instanceof Uint8Array||(ArrayBuffer.isView(j)?j=new Uint8Array(j.buffer,j.byteOffset,j.byteLength):Array.isArray(j)&&(j=Uint8Array.from(j))),!(j instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(j.length===0)return"";for(var V=0,ie=0,Ee=0,ge=j.length;Ee!==ge&&j[Ee]===0;)Ee++,V++;for(var pe=(ge-Ee)*F+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=j[Ee],T=0,M=pe-1;(le!==0||T<ie)&&M!==-1;M--,T++)le+=256*he[M]>>>0,he[M]=le%y>>>0,le=le/y>>>0;if(le!==0)throw new Error("Non-zero carry");ie=T,Ee++}for(var B=pe-ie;B!==pe&&he[B]===0;)B++;for(var ve=w.repeat(V);B<pe;++B)ve+=c.charAt(he[B]);return ve}function J(j){if(typeof j!="string")throw new TypeError("Expected String");if(j.length===0)return new Uint8Array;var V=0;if(j[V]!==" "){for(var ie=0,Ee=0;j[V]===w;)ie++,V++;for(var ge=(j.length-V)*A+1>>>0,pe=new Uint8Array(ge);j[V];){var he=i[j.charCodeAt(V)];if(he===255)return;for(var le=0,T=ge-1;(he!==0||le<Ee)&&T!==-1;T--,le++)he+=y*pe[T]>>>0,pe[T]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,V++}if(j[V]!==" "){for(var M=ge-Ee;M!==ge&&pe[M]===0;)M++;for(var B=new Uint8Array(ie+(ge-M)),ve=ie;M!==ge;)B[ve++]=pe[M++];return B}}}function G(j){var V=J(j);if(V)return V;throw new Error(`Non-${r} character`)}return{encode:K,decodeUnsafe:J,decode:G}}var __=m_,w_=__;const df=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},b_=c=>new TextEncoder().encode(c),E_=c=>new TextDecoder().decode(c);class x_{constructor(r,i,n){this.name=r,this.prefix=i,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class I_{constructor(r,i,n){if(this.name=r,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return gf(this,r)}}class S_{constructor(r){this.decoders=r}or(r){return gf(this,r)}decode(r){const i=r[0],n=this.decoders[i];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const gf=(c,r)=>new S_({...c.decoders||{[c.prefix]:c},...r.decoders||{[r.prefix]:r}});class P_{constructor(r,i,n,o){this.name=r,this.prefix=i,this.baseEncode=n,this.baseDecode=o,this.encoder=new x_(r,i,n),this.decoder=new I_(r,i,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const _o=({name:c,prefix:r,encode:i,decode:n})=>new P_(c,r,i,n),Gs=({prefix:c,name:r,alphabet:i})=>{const{encode:n,decode:o}=w_(i,r);return _o({prefix:c,name:r,encode:n,decode:h=>df(o(h))})},A_=(c,r,i,n)=>{const o={};for(let F=0;F<r.length;++F)o[r[F]]=F;let h=c.length;for(;c[h-1]==="=";)--h;const d=new Uint8Array(h*i/8|0);let y=0,w=0,A=0;for(let F=0;F<h;++F){const K=o[c[F]];if(K===void 0)throw new SyntaxError(`Non-${n} character`);w=w<<i|K,y+=i,y>=8&&(y-=8,d[A++]=255&w>>y)}if(y>=i||255&w<<8-y)throw new SyntaxError("Unexpected end of data");return d},C_=(c,r,i)=>{const n=r[r.length-1]==="=",o=(1<<i)-1;let h="",d=0,y=0;for(let w=0;w<c.length;++w)for(y=y<<8|c[w],d+=8;d>i;)d-=i,h+=r[o&y>>d];if(d&&(h+=r[o&y<<i-d]),n)for(;h.length*i&7;)h+="=";return h},Kt=({name:c,prefix:r,bitsPerChar:i,alphabet:n})=>_o({prefix:r,name:c,encode(o){return C_(o,n,i)},decode(o){return A_(o,n,i,c)}}),O_=_o({prefix:"\0",name:"identity",encode:c=>E_(c),decode:c=>b_(c)});var R_=Object.freeze({__proto__:null,identity:O_});const T_=Kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var N_=Object.freeze({__proto__:null,base2:T_});const L_=Kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var D_=Object.freeze({__proto__:null,base8:L_});const F_=Gs({prefix:"9",name:"base10",alphabet:"0123456789"});var $_=Object.freeze({__proto__:null,base10:F_});const j_=Kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),M_=Kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var U_=Object.freeze({__proto__:null,base16:j_,base16upper:M_});const q_=Kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),z_=Kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),k_=Kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),H_=Kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),B_=Kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),V_=Kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),K_=Kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),G_=Kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),W_=Kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var J_=Object.freeze({__proto__:null,base32:q_,base32upper:z_,base32pad:k_,base32padupper:H_,base32hex:B_,base32hexupper:V_,base32hexpad:K_,base32hexpadupper:G_,base32z:W_});const Y_=Gs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),X_=Gs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Z_=Object.freeze({__proto__:null,base36:Y_,base36upper:X_});const Q_=Gs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ew=Gs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var tw=Object.freeze({__proto__:null,base58btc:Q_,base58flickr:ew});const rw=Kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),iw=Kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sw=Kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nw=Kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ow=Object.freeze({__proto__:null,base64:rw,base64pad:iw,base64url:sw,base64urlpad:nw});const vf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),aw=vf.reduce((c,r,i)=>(c[i]=r,c),[]),cw=vf.reduce((c,r,i)=>(c[r.codePointAt(0)]=i,c),[]);function uw(c){return c.reduce((r,i)=>(r+=aw[i],r),"")}function hw(c){const r=[];for(const i of c){const n=cw[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);r.push(n)}return new Uint8Array(r)}const lw=_o({prefix:"🚀",name:"base256emoji",encode:uw,decode:hw});var fw=Object.freeze({__proto__:null,base256emoji:lw}),pw=yf,rl=128,dw=127,gw=~dw,vw=Math.pow(2,31);function yf(c,r,i){r=r||[],i=i||0;for(var n=i;c>=vw;)r[i++]=c&255|rl,c/=128;for(;c&gw;)r[i++]=c&255|rl,c>>>=7;return r[i]=c|0,yf.bytes=i-n+1,r}var yw=hc,mw=128,il=127;function hc(c,n){var i=0,n=n||0,o=0,h=n,d,y=c.length;do{if(h>=y)throw hc.bytes=0,new RangeError("Could not decode varint");d=c[h++],i+=o<28?(d&il)<<o:(d&il)*Math.pow(2,o),o+=7}while(d>=mw);return hc.bytes=h-n,i}var _w=Math.pow(2,7),ww=Math.pow(2,14),bw=Math.pow(2,21),Ew=Math.pow(2,28),xw=Math.pow(2,35),Iw=Math.pow(2,42),Sw=Math.pow(2,49),Pw=Math.pow(2,56),Aw=Math.pow(2,63),Cw=function(c){return c<_w?1:c<ww?2:c<bw?3:c<Ew?4:c<xw?5:c<Iw?6:c<Sw?7:c<Pw?8:c<Aw?9:10},Ow={encode:pw,decode:yw,encodingLength:Cw},mf=Ow;const sl=(c,r,i=0)=>(mf.encode(c,r,i),r),nl=c=>mf.encodingLength(c),lc=(c,r)=>{const i=r.byteLength,n=nl(c),o=n+nl(i),h=new Uint8Array(o+i);return sl(c,h,0),sl(i,h,n),h.set(r,o),new Rw(c,i,r,h)};class Rw{constructor(r,i,n,o){this.code=r,this.size=i,this.digest=n,this.bytes=o}}const _f=({name:c,code:r,encode:i})=>new Tw(c,r,i);class Tw{constructor(r,i,n){this.name=r,this.code=i,this.encode=n}digest(r){if(r instanceof Uint8Array){const i=this.encode(r);return i instanceof Uint8Array?lc(this.code,i):i.then(n=>lc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const wf=c=>async r=>new Uint8Array(await crypto.subtle.digest(c,r)),Nw=_f({name:"sha2-256",code:18,encode:wf("SHA-256")}),Lw=_f({name:"sha2-512",code:19,encode:wf("SHA-512")});var Dw=Object.freeze({__proto__:null,sha256:Nw,sha512:Lw});const bf=0,Fw="identity",Ef=df,$w=c=>lc(bf,Ef(c)),jw={code:bf,name:Fw,encode:Ef,digest:$w};var Mw=Object.freeze({__proto__:null,identity:jw});new TextEncoder,new TextDecoder;const ol={...R_,...N_,...D_,...$_,...U_,...J_,...Z_,...tw,...ow,...fw};({...Dw,...Mw});function xf(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function Uw(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?xf(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function If(c,r,i,n){return{name:c,prefix:r,encoder:{name:c,prefix:r,encode:i},decoder:{decode:n}}}const al=If("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Qa=If("ascii","a",c=>{let r="a";for(let i=0;i<c.length;i++)r+=String.fromCharCode(c[i]);return r},c=>{c=c.substring(1);const r=Uw(c.length);for(let i=0;i<c.length;i++)r[i]=c.charCodeAt(i);return r}),qw={utf8:al,"utf-8":al,hex:ol.base16,latin1:Qa,ascii:Qa,binary:Qa,...ol};function zw(c,r="utf8"){const i=qw[r];if(!i)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?xf(globalThis.Buffer.from(c,"utf-8")):i.decoder.decode(`${i.prefix}${c}`)}const Sf="wc",kw=2,xc="core",wi=`${Sf}@2:${xc}:`,Hw={name:xc,logger:"error"},Bw={database:":memory:"},Vw="crypto",cl="client_ed25519_seed",Kw=ne.ONE_DAY,Gw="keychain",Ww="0.3",Jw="messages",Yw="0.3",Xw=ne.SIX_HOURS,Zw="publisher",Pf="irn",Qw="error",Af="wss://relay.walletconnect.com",ul="wss://relay.walletconnect.org",eb="relayer",mt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},tb="_subscription",Ms={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},rb=ne.ONE_SECOND/2,ib="2.9.0",sb=1e4,nb="0.3",ob="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ab="subscription",cb="0.3",ub=ne.FIVE_SECONDS*1e3,hb="pairing",lb="0.3",Us={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},fb="history",pb="0.3",db="expirer",Ar={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},gb="0.3",ec="verify-api",hl="https://verify.walletconnect.com";class vb{constructor(r,i){this.core=r,this.logger=i,this.keychain=new Map,this.name=Gw,this.version=Ww,this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=Q("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,zl(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?kl(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class yb{constructor(r,i,n){this.core=r,this.logger=i,this.name=Vw,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=Wh(o);return of(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=y1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),d=Wh(h),y=cc();return await Jm(y,o,Kw,d)},this.generateSharedKey=(o,h,d)=>{this.isInitialized();const y=this.getPrivateKey(o),w=m1(y,h);return this.setSymKey(w,d)},this.setSymKey=async(o,h)=>{this.isInitialized();const d=h||_1(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,d)=>{this.isInitialized();const y=w1(d),w=Vs(h);if(Ah(y)){const J=y.senderPublicKey,G=y.receiverPublicKey;o=await this.generateSharedKey(J,G)}const A=this.getSymKey(o),{type:F,senderPublicKey:K}=y;return b1({type:F,symKey:A,message:w,senderPublicKey:K})},this.decode=async(o,h,d)=>{this.isInitialized();const y=E1(h,d);if(Ah(y)){const F=y.receiverPublicKey,K=y.senderPublicKey;o=await this.generateSharedKey(F,K)}const w=this.getSymKey(o),A=x1({symKey:w,encoded:h});return yc(A)},this.getPayloadType=o=>{const h=Ch(o);return I1(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Ch(o);return h.senderPublicKey?fo(h.senderPublicKey,S1):void 0},this.core=r,this.logger=Re.generateChildLogger(i,this.name),this.keychain=n||new vb(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(r,i){return await this.keychain.set(r,i),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(cl)}catch{r=cc(),await this.keychain.set(cl,r)}return zw(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class mb extends Sm{constructor(r,i){super(r,i),this.logger=r,this.core=i,this.messages=new Map,this.name=Jw,this.version=Yw,this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=ls(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[h]<"u"||(d[h]=o,this.messages.set(n,d),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),d=ls(o);return typeof h[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(r,this.name),this.core=i}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,zl(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?kl(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class _b extends Pm{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.events=new kt.EventEmitter,this.name=Zw,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.queueTimeout=ne.toMiliseconds(ne.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const d=(h==null?void 0:h.ttl)||Xw,y=uc(h),w=(h==null?void 0:h.prompt)||!1,A=(h==null?void 0:h.tag)||0,F=(h==null?void 0:h.id)||wc().toString(),K={topic:n,message:o,opts:{ttl:d,relay:y,prompt:w,tag:A,id:F}},J=setTimeout(()=>this.queue.set(F,K),this.queueTimeout);try{await await oo(this.rpcPublish(n,o,d,y,w,A,F),this.publishTimeout),clearTimeout(J),this.relayer.events.emit(mt.publish,K)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=Re.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(r,i,n,o,h,d,y){var w,A,F,K;const J={method:ro(o.protocol).publish,params:{topic:r,message:i,ttl:n,prompt:h,tag:d},id:y};return _i((w=J.params)==null?void 0:w.prompt)&&((A=J.params)==null||delete A.prompt),_i((F=J.params)==null?void 0:F.tag)&&((K=J.params)==null||delete K.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:J}),this.relayer.request(J)}onPublish(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:i,message:n,opts:o}=r;await this.publish(i,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(mt.connection_stalled);return}this.checkQueue()}),this.relayer.on(mt.message_ack,r=>{this.onPublish(r.id.toString())})}}class wb{constructor(){this.map=new Map,this.set=(r,i)=>{const n=this.get(r);this.exists(r,i)||this.map.set(r,[...n,i])},this.get=r=>this.map.get(r)||[],this.exists=(r,i)=>this.get(r).includes(i),this.delete=(r,i)=>{if(typeof i>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,i))return;const o=n.filter(h=>h!==i);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var bb=Object.defineProperty,Eb=Object.defineProperties,xb=Object.getOwnPropertyDescriptors,ll=Object.getOwnPropertySymbols,Ib=Object.prototype.hasOwnProperty,Sb=Object.prototype.propertyIsEnumerable,fl=(c,r,i)=>r in c?bb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,qs=(c,r)=>{for(var i in r||(r={}))Ib.call(r,i)&&fl(c,i,r[i]);if(ll)for(var i of ll(r))Sb.call(r,i)&&fl(c,i,r[i]);return c},tc=(c,r)=>Eb(c,xb(r));class Pb extends Om{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.subscriptions=new Map,this.topicMap=new wb,this.events=new kt.EventEmitter,this.name=ab,this.version=cb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=wi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=uc(o),d={topic:n,relay:h};this.pending.set(n,d);const y=await this.rpcSubscribe(n,h);return this.onSubscribe(y,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),y}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,h)=>{const d=new ne.Watch;d.start(this.pendingSubscriptionWatchLabel);const y=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(y),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=ub&&(clearInterval(y),d.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Re.generateChildLogger(i,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,i){let n=!1;try{n=this.getSubscription(r).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,i){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,i)))}async unsubscribeById(r,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}});try{const o=uc(n);await this.rpcUnsubscribe(r,i,o);const h=rr("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,i){const n={method:ro(i.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await oo(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(mt.connection_stalled)}return ls(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const i=r[0].relay,n={method:ro(i.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await oo(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(mt.connection_stalled)}}rpcUnsubscribe(r,i,n){const o={method:ro(n.protocol).unsubscribe,params:{topic:r,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,i){this.setSubscription(r,tc(qs({},i),{id:r})),this.pending.delete(i.topic)}onBatchSubscribe(r){r.length&&r.forEach(i=>{this.setSubscription(i.id,qs({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(r,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,r)&&this.deleteSubscription(i,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,i){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:i}),this.addSubscription(r,i))}addSubscription(r,i){this.subscriptions.set(r,qs({},i)),this.topicMap.set(i.topic,r),this.events.emit(Vr.created,i)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const i=this.subscriptions.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}deleteSubscription(r,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:i});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Vr.deleted,tc(qs({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Vr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const i=await this.rpcBatchSubscribe(r);ps(i)&&this.onBatchSubscribe(i.map((n,o)=>tc(qs({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(mt.connect,async()=>{await this.onConnect()}),this.relayer.on(mt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async r=>{const i=Vr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Vr.deleted,async r=>{const i=Vr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),r())},this.pollingInterval)})}}var Ab=Object.defineProperty,pl=Object.getOwnPropertySymbols,Cb=Object.prototype.hasOwnProperty,Ob=Object.prototype.propertyIsEnumerable,dl=(c,r,i)=>r in c?Ab(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Rb=(c,r)=>{for(var i in r||(r={}))Cb.call(r,i)&&dl(c,i,r[i]);if(pl)for(var i of pl(r))Ob.call(r,i)&&dl(c,i,r[i]);return c};class Tb extends Am{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new kt.EventEmitter,this.name=eb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Re.generateChildLogger(r.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:r.logger||Qw})),this.messages=new mb(this.logger,r.core),this.subscriber=new Pb(this,this.logger),this.publisher=new _b(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Af,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ul}...`),await this.restartTransport(ul)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},sb)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,i,n){this.isInitialized(),await this.publisher.publish(r,i,n),await this.recordMessageEvent({topic:r,message:i,publishedAt:Date.now()})}async subscribe(r,i){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(h=>{this.subscriber.once(Vr.created,d=>{d.topic===r&&h()})}),new Promise(async h=>{o=await this.subscriber.subscribe(r,i),h()})]),o)}async unsubscribe(r,i){this.isInitialized(),await this.subscriber.unsubscribe(r,i)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(mt.transport_closed))}async transportOpen(r){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=r||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(i=>{this.initialized||i(),this.subscriber.once(Vr.resubscribed,()=>{i()})}),await Promise.race([new Promise(async(i,n)=>{await oo(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>n(o)).then(()=>i()).finally(()=>this.removeListener(mt.transport_closed,this.rejectTransportOpen))}),new Promise(i=>this.once(mt.transport_closed,this.rejectTransportOpen))])])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.events.emit(mt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(r){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=r||this.relayUrl,this.connected&&await Promise.all([new Promise(i=>{this.provider.once(Ms.disconnect,()=>{i()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(r){return this.staleConnectionErrors.some(i=>r.includes(i))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new v_(P1({sdkVersion:ib,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:i,message:n}=r;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(r){const{topic:i,message:n}=r;return await this.subscriber.isSubscribed(i)?this.messages.has(i,n):!0}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Ec(r)){if(!r.method.endsWith(tb))return;const i=r.params,{topic:n,message:o,publishedAt:h}=i.data,d={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Rb({type:"event",event:i.id},d)),this.events.emit(i.id,d),await this.acknowledgePayload(r),await this.onMessageEvent(d)}else mo(r)&&this.events.emit(mt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(mt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const i=bc(r.id,!0);await this.provider.connection.send(i)}registerProviderListeners(){this.provider.on(Ms.payload,r=>this.onProviderPayload(r)),this.provider.on(Ms.connect,()=>{this.events.emit(mt.connect)}),this.provider.on(Ms.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Ms.error,r=>{this.logger.error(r),this.events.emit(mt.error,r)})}registerEventListeners(){this.events.on(mt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(mt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ne.toMiliseconds(rb))}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(r=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Nb=Object.defineProperty,gl=Object.getOwnPropertySymbols,Lb=Object.prototype.hasOwnProperty,Db=Object.prototype.propertyIsEnumerable,vl=(c,r,i)=>r in c?Nb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,yl=(c,r)=>{for(var i in r||(r={}))Lb.call(r,i)&&vl(c,i,r[i]);if(gl)for(var i of gl(r))Db.call(r,i)&&vl(c,i,r[i]);return c};class wo extends Cm{constructor(r,i,n,o=wi,h=void 0){super(r,i,n,o),this.core=r,this.logger=i,this.name=n,this.map=new Map,this.version=nb,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):g1(d)?this.map.set(d.id,d):v1(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,y)=>{this.isInitialized(),this.map.has(d)?await this.update(d,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:y}),this.map.set(d,y),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(y=>Object.keys(d).every(w=>uo(y[w],d[w]))):this.values),this.update=async(d,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:y});const w=yl(yl({},this.getData(d)),y);this.map.set(d,w),await this.persist()},this.delete=async(d,y)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:y}),this.map.delete(d),await this.persist())},this.logger=Re.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const i=this.map.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Fb{constructor(r,i){this.core=r,this.logger=i,this.name=hb,this.version=lb,this.events=new kt,this.initialized=!1,this.storagePrefix=wi,this.ignoredPayloadTypes=[Ml],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=cc(),o=await this.core.crypto.setSymKey(n),h=Fr(ne.FIVE_MINUTES),d={protocol:Pf},y={topic:o,expiry:h,relay:d,active:!1},w=A1({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,y),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:w}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:d}=C1(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const y=Fr(ne.FIVE_MINUTES),w={topic:o,relay:d,expiry:y,active:!1};return await this.pairings.set(o,w),await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:d}),this.core.expirer.set(o,y),n.activatePairing&&await this.activate({topic:o}),w},this.activate=async({topic:n})=>{this.isInitialized();const o=Fr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:y,reject:w}=cs();this.events.once(Ft("pairing_ping",h),({error:A})=>{A?w(A):y()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",rr("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const d=vo(o,h),y=await this.core.crypto.encode(n,d),w=Us[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,y,w),d.id},this.sendResult=async(n,o,h)=>{const d=bc(n,h),y=await this.core.crypto.encode(o,d),w=await this.core.history.get(o,n),A=Us[w.request.method].res;await this.core.relayer.publish(o,y,A),await this.core.history.resolve(d)},this.sendError=async(n,o,h)=>{const d=yo(n,h),y=await this.core.crypto.encode(o,d),w=await this.core.history.get(o,n),A=Us[w.request.method]?Us[w.request.method].res:Us.unregistered_method.res;await this.core.relayer.publish(o,y,A),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,rr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>mi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n,d=h.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,d=(await this.core.history.get(o,h.id)).request.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit("pairing_ping",{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{oi(o)?this.events.emit(Ft("pairing_ping",h),{}):$r(o)&&this.events.emit(Ft("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:d}=o;try{if(this.registeredMethods.includes(d))return;const y=rr("WC_METHOD_UNSUPPORTED",d);await this.sendError(h,n,y),this.logger.error(y)}catch(y){await this.sendError(h,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(rr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ur(n)){const{message:o}=Q("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!O1(n.uri)){const{message:o}=Q("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!ur(n)){const{message:h}=Q("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ur(n)){const{message:h}=Q("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!us(n,!1)){const{message:o}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(mi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Q("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=Re.generateChildLogger(i,this.name),this.pairings=new wo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(mt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(i,n);Ec(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):mo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))})}registerExpirerEvents(){this.core.expirer.on(Ar.expired,async r=>{const{topic:i}=Ul(r.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit("pairing_expire",{topic:i}))})}}class $b extends Im{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.records=new Map,this.events=new kt.EventEmitter,this.name=fb,this.version=pb,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Fr(ne.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Br.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=$r(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Br.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Br.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:vo(i.request.method,i.request.params,i.id),chainId:i.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const i=this.records.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Br.created,r=>{const i=Br.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Br.updated,r=>{const i=Br.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Br.deleted,r=>{const i=Br.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{ne.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class jb extends Rm{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.expirations=new Map,this.events=new kt.EventEmitter,this.name=db,this.version=gb,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),d={target:h,expiry:o};this.expirations.set(h,d),this.checkExpiry(h,d),this.events.emit(Ar.created,{target:h,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Ar.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Re.generateChildLogger(i,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return R1(r);if(typeof r=="number")return T1(r);const{message:i}=Q("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(i)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ar.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:i}=Q("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const i=this.expirations.get(r);if(!i){const{message:n}=Q("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(r,i){const{expiry:n}=i;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(r,i)}expire(r,i){this.expirations.delete(r),this.events.emit(Ar.expired,{target:r,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,i)=>this.checkExpiry(i,r))}registerEventListeners(){this.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Ar.created,r=>{const i=Ar.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Ar.expired,r=>{const i=Ar.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Ar.deleted,r=>{const i=Ar.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}}class Mb extends Tm{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.name=ec,this.initialized=!1,this.init=async n=>{N1()||!ql()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||hl,await this.createIframe())},this.register=async n=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const h=this.startAbortTimer(ne.FIVE_SECONDS),d=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(h),d.status===200?(o=await d.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,o)=>{if(document.getElementById(ec))return n();const h=document.createElement("iframe");h.setAttribute("id",ec),h.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),h.style.display="none",h.addEventListener("load",()=>{this.initialized=!0,n()}),h.addEventListener("error",d=>{o(d)}),document.body.append(h),this.iframe=h}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),ne.toMiliseconds(ne.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Re.generateChildLogger(i,this.name),this.verifyUrl=hl,this.abortController=new AbortController,this.isDevEnv=L1()&&{}.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(r){return setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(r))}}var Ub=Object.defineProperty,ml=Object.getOwnPropertySymbols,qb=Object.prototype.hasOwnProperty,zb=Object.prototype.propertyIsEnumerable,_l=(c,r,i)=>r in c?Ub(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,wl=(c,r)=>{for(var i in r||(r={}))qb.call(r,i)&&_l(c,i,r[i]);if(ml)for(var i of ml(r))zb.call(r,i)&&_l(c,i,r[i]);return c};class Ic extends xm{constructor(r){super(r),this.protocol=Sf,this.version=kw,this.name=xc,this.events=new kt.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Af;const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Hw.logger}));this.logger=Re.generateChildLogger(i,this.name),this.heartbeat=new ds.HeartBeat,this.crypto=new yb(this,this.logger,r==null?void 0:r.keychain),this.history=new $b(this,this.logger),this.expirer=new jb(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new dm(wl(wl({},Bw),r==null?void 0:r.storageOptions)),this.relayer=new Tb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Fb(this,this.logger),this.verify=new Mb(this.projectId||"",this.logger)}static async init(r){const i=new Ic(r);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(ob,n),i}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const kb=Ic,Cf="wc",Of=2,Rf="client",Sc=`${Cf}@${Of}:${Rf}:`,rc={name:Rf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Hb="WALLETCONNECT_DEEPLINK_CHOICE",Bb="proposal",Tf="Proposal expired",Vb="session",Qn=ne.SEVEN_DAYS,Kb="engine",zs={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},ic={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},Gb="request",Wb=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Jb=Object.defineProperty,Yb=Object.defineProperties,Xb=Object.getOwnPropertyDescriptors,bl=Object.getOwnPropertySymbols,Zb=Object.prototype.hasOwnProperty,Qb=Object.prototype.propertyIsEnumerable,El=(c,r,i)=>r in c?Jb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Pr=(c,r)=>{for(var i in r||(r={}))Zb.call(r,i)&&El(c,i,r[i]);if(bl)for(var i of bl(r))Qb.call(r,i)&&El(c,i,r[i]);return c},sc=(c,r)=>Yb(c,Xb(r));class eE extends Lm{constructor(r){super(r),this.name=Kb,this.events=new kt,this.initialized=!1,this.ignoredPayloadTypes=[Ml],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(zs)}),this.initialized=!0)},this.connect=async i=>{this.isInitialized();const n=sc(Pr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:d,sessionProperties:y,relays:w}=n;let A=o,F,K=!1;if(A&&(K=this.client.core.pairing.pairings.get(A).active),!A||!K){const{topic:pe,uri:he}=await this.client.core.pairing.create();A=pe,F=he}const J=await this.client.core.crypto.generateKeyPair(),G=Pr({requiredNamespaces:h,optionalNamespaces:d,relays:w??[{protocol:Pf}],proposer:{publicKey:J,metadata:this.client.metadata}},y&&{sessionProperties:y}),{reject:j,resolve:V,done:ie}=cs(ne.FIVE_MINUTES,Tf);if(this.events.once(Ft("session_connect"),async({error:pe,session:he})=>{if(pe)j(pe);else if(he){he.self.publicKey=J;const le=sc(Pr({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:he.peer.metadata}),V(le)}}),!A){const{message:pe}=Q("NO_MATCHING_KEY",`connect() pairing topic: ${A}`);throw new Error(pe)}const Ee=await this.sendRequest(A,"wc_sessionPropose",G),ge=Fr(ne.FIVE_MINUTES);return await this.setProposal(Ee,Pr({id:Ee,expiry:ge},G)),{uri:F,approval:ie}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:d}=i,y=this.client.proposal.get(n);let{pairingTopic:w,proposer:A,requiredNamespaces:F,optionalNamespaces:K}=y;w=w||"",io(F)||(F=F1(h,"approve()"));const J=await this.client.core.crypto.generateKeyPair(),G=A.publicKey,j=await this.client.core.crypto.generateSharedKey(J,G);w&&n&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:A.metadata}),await this.sendResult(n,w,{relay:{protocol:o??"irn"},responderPublicKey:J}),await this.client.proposal.delete(n,rr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const V=Pr({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:F,optionalNamespaces:K,pairingTopic:w,controller:{publicKey:J,metadata:this.client.metadata},expiry:Fr(Qn)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(j),await this.sendRequest(j,"wc_sessionSettle",V);const ie=sc(Pr({},V),{topic:j,pairingTopic:w,acknowledged:!1,self:V.controller,peer:{publicKey:A.publicKey,metadata:A.metadata},controller:J});return await this.client.session.set(j,ie),await this.setExpiry(j,Fr(Qn)),{topic:j,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(j)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:n,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,rr("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:o}=i,h=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:o}),{done:d,resolve:y,reject:w}=cs();return this.events.once(Ft("session_update",h),({error:A})=>{A?w(A):y()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,o=await this.sendRequest(n,"wc_sessionExtend",{}),{done:h,resolve:d,reject:y}=cs();return this.events.once(Ft("session_extend",o),({error:w})=>{w?y(w):d()}),await this.setExpiry(n,Fr(Qn)),{acknowledged:h}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:o,topic:h,expiry:d}=i,y=await this.sendRequest(h,"wc_sessionRequest",{request:o,chainId:n},d),{done:w,resolve:A,reject:F}=cs(d);this.events.once(Ft("session_request",y),({error:J,result:G})=>{J?F(J):A(G)}),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:y});const K=await this.client.core.storage.getItem(Hb);return $1({id:y,topic:h,wcDeepLink:K}),await w()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:o}=i,{id:h}=o;oi(o)?await this.sendResult(h,n,o.result):$r(o)&&await this.sendError(h,n,o.error),this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=await this.sendRequest(n,"wc_sessionPing",{}),{done:h,resolve:d,reject:y}=cs();this.events.once(Ft("session_ping",o),({error:w})=>{w?y(w):d()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:o,chainId:h}=i;await this.sendRequest(n,"wc_sessionEvent",{event:o,chainId:h})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=wc().toString();let h;const d=y=>{(y==null?void 0:y.id.toString())===o&&(this.client.core.relayer.events.removeListener(mt.message_ack,d),h())};await Promise.all([new Promise(y=>{h=y,this.client.core.relayer.on(mt.message_ack,d)}),this.sendRequest(n,"wc_sessionDelete",rr("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>j1(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var d,y;return((d=h.peerMetadata)==null?void 0:d.url)&&((y=h.peerMetadata)==null?void 0:y.url)===i.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,rr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i)},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,rr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),o?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=zs.wc_sessionRequest.req.ttl,{id:o,topic:h,params:d}=i;await this.client.pendingRequest.set(o,{id:o,topic:h,params:d}),n&&this.client.core.expirer.set(o,Fr(n))},this.sendRequest=async(i,n,o,h,d)=>{const y=vo(n,o);if(ql()&&Wb.includes(n)){const F=ls(JSON.stringify(y));await this.client.core.verify.register({attestationId:F})}const w=await this.client.core.crypto.encode(i,y),A=zs[n].req;return h&&(A.ttl=h),d&&(A.id=d),this.client.core.history.set(i,y),this.client.core.relayer.publish(i,w,A),y.id},this.sendResult=async(i,n,o)=>{const h=bc(i,o),d=await this.client.core.crypto.encode(n,h),y=await this.client.core.history.get(n,i),w=zs[y.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(h)},this.sendError=async(i,n,o)=>{const h=yo(i,o),d=await this.client.core.crypto.encode(n,h),y=await this.client.core.history.get(n,i),w=zs[y.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(o=>{mi(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{mi(o.expiry)&&n.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=i=>{const{topic:n,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:o}=Q("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(Pr({},n.params));const d=Fr(ne.FIVE_MINUTES),y=Pr({id:h,pairingTopic:i,expiry:d},o);await this.setProposal(h,y);const w=ls(JSON.stringify(n)),A=await this.getVerifyContext(w,y.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:y,verifyContext:A})}catch(d){await this.sendError(h,i,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(i,n)=>{const{id:o}=n;if(oi(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const y=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const w=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const A=await this.client.core.crypto.generateSharedKey(y,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:A});const F=await this.client.core.relayer.subscribe(A);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:F}),await this.client.core.pairing.activate({topic:i})}else $r(n)&&(await this.client.proposal.delete(o,rr("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:d,controller:y,expiry:w,namespaces:A,requiredNamespaces:F,optionalNamespaces:K,sessionProperties:J,pairingTopic:G}=n.params,j=Pr({topic:i,relay:d,expiry:w,namespaces:A,acknowledged:!0,pairingTopic:G,requiredNamespaces:F,optionalNamespaces:K,controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},J&&{sessionProperties:J});await this.sendResult(n.id,i,!0),this.events.emit(Ft("session_connect"),{session:j}),this.cleanupDuplicatePairings(j)}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(i,n)=>{const{id:o}=n;oi(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):$r(n)&&(await this.client.session.delete(i,rr("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:o,id:h}=n;try{this.isValidUpdate(Pr({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult(h,i,!0),this.client.events.emit("session_update",{id:h,topic:i,params:o})}catch(d){await this.sendError(h,i,d),this.client.logger.error(d)}},this.onSessionUpdateResponse=(i,n)=>{const{id:o}=n;oi(n)?this.events.emit(Ft("session_update",o),{}):$r(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:o}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Fr(Qn)),await this.sendResult(o,i,!0),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,n)=>{const{id:o}=n;oi(n)?this.events.emit(Ft("session_extend",o),{}):$r(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{oi(n)?this.events.emit(Ft("session_ping",o),{}):$r(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(mt.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult(o,i,!0)]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(Pr({topic:i},h)),await this.setPendingSessionRequest({id:o,topic:i,params:h});const d=ls(JSON.stringify(n)),y=this.client.session.get(i),w=await this.getVerifyContext(d,y.peer.metadata);this.client.events.emit("session_request",{id:o,topic:i,params:h,verifyContext:w})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(i,n)=>{const{id:o}=n;oi(n)?this.events.emit(Ft("session_request",o),{result:n.result}):$r(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidEmit(Pr({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.isValidConnect=async i=>{if(!ur(i)){const{message:w}=Q("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(w)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:d,relays:y}=i;if(_i(n)||await this.isValidPairingTopic(n),!M1(y,!0)){const{message:w}=Q("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(w)}!_i(o)&&io(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!_i(h)&&io(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(i,n)=>{const o=U1(i,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!ur(i))throw new Error(Q("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:d}=i;await this.isValidProposalId(n);const y=this.client.proposal.get(n),w=Va(o,"approve()");if(w)throw new Error(w.message);const A=Oh(y.requiredNamespaces,o,"approve()");if(A)throw new Error(A.message);if(!us(h,!0)){const{message:F}=Q("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(F)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async i=>{if(!ur(i)){const{message:h}=Q("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:n,reason:o}=i;if(await this.isValidProposalId(n),!q1(o)){const{message:h}=Q("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!ur(i)){const{message:A}=Q("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(A)}const{relay:n,controller:o,namespaces:h,expiry:d}=i;if(!z1(n)){const{message:A}=Q("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(A)}const y=k1(o,"onSessionSettleRequest()");if(y)throw new Error(y.message);const w=Va(h,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(mi(d)){const{message:A}=Q("EXPIRED","onSessionSettleRequest()");throw new Error(A)}},this.isValidUpdate=async i=>{if(!ur(i)){const{message:w}=Q("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(w)}const{topic:n,namespaces:o}=i;await this.isValidSessionTopic(n);const h=this.client.session.get(n),d=Va(o,"update()");if(d)throw new Error(d.message);const y=Oh(h.requiredNamespaces,o,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async i=>{if(!ur(i)){const{message:o}=Q("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!ur(i)){const{message:w}=Q("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(w)}const{topic:n,request:o,chainId:h,expiry:d}=i;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!Rh(y,h)){const{message:w}=Q("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(w)}if(!H1(o)){const{message:w}=Q("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(w)}if(!B1(y,h,o.method)){const{message:w}=Q("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(w)}if(d&&!V1(d,ic)){const{message:w}=Q("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${ic.min} and ${ic.max}`);throw new Error(w)}},this.isValidRespond=async i=>{if(!ur(i)){const{message:h}=Q("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(h)}const{topic:n,response:o}=i;if(await this.isValidSessionTopic(n),!K1(o)){const{message:h}=Q("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidPing=async i=>{if(!ur(i)){const{message:o}=Q("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!ur(i)){const{message:y}=Q("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(y)}const{topic:n,event:o,chainId:h}=i;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Rh(d,h)){const{message:y}=Q("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(y)}if(!G1(o)){const{message:y}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}if(!W1(d,h,o.name)){const{message:y}=Q("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}},this.isValidDisconnect=async i=>{if(!ur(i)){const{message:o}=Q("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const o={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h,o.verified.validation=h===n.url?"VALID":"INVALID")}catch(h){this.client.logger.error(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(o=>{if(!us(o,!1)){const{message:h}=Q("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}isInitialized(){if(!this.initialized){const{message:r}=Q("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.client.core.relayer.on(mt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(i,n);Ec(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):mo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Ar.expired,async r=>{const{topic:i,id:n}=Ul(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Q("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!us(r,!1)){const{message:i}=Q("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:i}=Q("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(mi(this.client.core.pairing.pairings.get(r).expiry)){const{message:i}=Q("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}async isValidSessionTopic(r){if(!us(r,!1)){const{message:i}=Q("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(i)}if(!this.client.session.keys.includes(r)){const{message:i}=Q("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(i)}if(mi(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:i}=Q("EXPIRED",`session topic: ${r}`);throw new Error(i)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(us(r,!1)){const{message:i}=Q("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(i)}else{const{message:i}=Q("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(i)}}async isValidProposalId(r){if(!J1(r)){const{message:i}=Q("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(i)}if(!this.client.proposal.keys.includes(r)){const{message:i}=Q("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(i)}if(mi(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:i}=Q("EXPIRED",`proposal id: ${r}`);throw new Error(i)}}}class tE extends wo{constructor(r,i){super(r,i,Bb,Sc),this.core=r,this.logger=i}}class rE extends wo{constructor(r,i){super(r,i,Vb,Sc),this.core=r,this.logger=i}}class iE extends wo{constructor(r,i){super(r,i,Gb,Sc,n=>n.id),this.core=r,this.logger=i}}let sE=class Nf extends Nm{constructor(r){super(r),this.protocol=Cf,this.version=Of,this.name=rc.name,this.events=new kt.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||rc.name,this.metadata=(r==null?void 0:r.metadata)||D1();const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||rc.logger}));this.core=(r==null?void 0:r.core)||new kb(r),this.logger=Re.generateChildLogger(i,this.name),this.session=new rE(this.core,this.logger),this.proposal=new tE(this.core,this.logger),this.pendingRequest=new iE(this.core,this.logger),this.engine=new eE(this)}static async init(r){const i=new Nf(r);return await i.initialize(),i}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var ho={},nE={get exports(){return ho},set exports(c){ho=c}};(function(c,r){var i=typeof self<"u"?self:hr,n=function(){function h(){this.fetch=!1,this.DOMException=i.DOMException}return h.prototype=i,new h}();(function(h){(function(d){var y={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function w(v){return v&&DataView.prototype.isPrototypeOf(v)}if(y.arrayBuffer)var A=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],F=ArrayBuffer.isView||function(v){return v&&A.indexOf(Object.prototype.toString.call(v))>-1};function K(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(v))throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function J(v){return typeof v!="string"&&(v=String(v)),v}function G(v){var E={next:function(){var X=v.shift();return{done:X===void 0,value:X}}};return y.iterable&&(E[Symbol.iterator]=function(){return E}),E}function j(v){this.map={},v instanceof j?v.forEach(function(E,X){this.append(X,E)},this):Array.isArray(v)?v.forEach(function(E){this.append(E[0],E[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(E){this.append(E,v[E])},this)}j.prototype.append=function(v,E){v=K(v),E=J(E);var X=this.map[v];this.map[v]=X?X+", "+E:E},j.prototype.delete=function(v){delete this.map[K(v)]},j.prototype.get=function(v){return v=K(v),this.has(v)?this.map[v]:null},j.prototype.has=function(v){return this.map.hasOwnProperty(K(v))},j.prototype.set=function(v,E){this.map[K(v)]=J(E)},j.prototype.forEach=function(v,E){for(var X in this.map)this.map.hasOwnProperty(X)&&v.call(E,this.map[X],X,this)},j.prototype.keys=function(){var v=[];return this.forEach(function(E,X){v.push(X)}),G(v)},j.prototype.values=function(){var v=[];return this.forEach(function(E){v.push(E)}),G(v)},j.prototype.entries=function(){var v=[];return this.forEach(function(E,X){v.push([X,E])}),G(v)},y.iterable&&(j.prototype[Symbol.iterator]=j.prototype.entries);function V(v){if(v.bodyUsed)return Promise.reject(new TypeError("Already read"));v.bodyUsed=!0}function ie(v){return new Promise(function(E,X){v.onload=function(){E(v.result)},v.onerror=function(){X(v.error)}})}function Ee(v){var E=new FileReader,X=ie(E);return E.readAsArrayBuffer(v),X}function ge(v){var E=new FileReader,X=ie(E);return E.readAsText(v),X}function pe(v){for(var E=new Uint8Array(v),X=new Array(E.length),ce=0;ce<E.length;ce++)X[ce]=String.fromCharCode(E[ce]);return X.join("")}function he(v){if(v.slice)return v.slice(0);var E=new Uint8Array(v.byteLength);return E.set(new Uint8Array(v)),E.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(v){this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:y.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:y.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():y.arrayBuffer&&y.blob&&w(v)?(this._bodyArrayBuffer=he(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||F(v))?this._bodyArrayBuffer=he(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var v=V(this);if(v)return v;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?V(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var v=V(this);if(v)return v;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function M(v){var E=v.toUpperCase();return T.indexOf(E)>-1?E:v}function B(v,E){E=E||{};var X=E.body;if(v instanceof B){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,E.headers||(this.headers=new j(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!X&&v._bodyInit!=null&&(X=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new j(E.headers)),this.method=M(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}B.prototype.clone=function(){return new B(this,{body:this._bodyInit})};function ve(v){var E=new FormData;return v.trim().split("&").forEach(function(X){if(X){var ce=X.split("="),k=ce.shift().replace(/\+/g," "),U=ce.join("=").replace(/\+/g," ");E.append(decodeURIComponent(k),decodeURIComponent(U))}}),E}function re(v){var E=new j,X=v.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(ce){var k=ce.split(":"),U=k.shift().trim();if(U){var z=k.join(":").trim();E.append(U,z)}}),E}le.call(B.prototype);function ue(v,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new j(E.headers),this.url=E.url||"",this._initBody(v)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new j(this.headers),url:this.url})},ue.error=function(){var v=new ue(null,{status:0,statusText:""});return v.type="error",v};var Te=[301,302,303,307,308];ue.redirect=function(v,E){if(Te.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:E,headers:{location:v}})},d.DOMException=h.DOMException;try{new d.DOMException}catch{d.DOMException=function(E,X){this.message=E,this.name=X;var ce=Error(E);this.stack=ce.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function qe(v,E){return new Promise(function(X,ce){var k=new B(v,E);if(k.signal&&k.signal.aborted)return ce(new d.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function z(){U.abort()}U.onload=function(){var H={status:U.status,statusText:U.statusText,headers:re(U.getAllResponseHeaders()||"")};H.url="responseURL"in U?U.responseURL:H.headers.get("X-Request-URL");var Ye="response"in U?U.response:U.responseText;X(new ue(Ye,H))},U.onerror=function(){ce(new TypeError("Network request failed"))},U.ontimeout=function(){ce(new TypeError("Network request failed"))},U.onabort=function(){ce(new d.DOMException("Aborted","AbortError"))},U.open(k.method,k.url,!0),k.credentials==="include"?U.withCredentials=!0:k.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&y.blob&&(U.responseType="blob"),k.headers.forEach(function(H,Ye){U.setRequestHeader(Ye,H)}),k.signal&&(k.signal.addEventListener("abort",z),U.onreadystatechange=function(){U.readyState===4&&k.signal.removeEventListener("abort",z)}),U.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return qe.polyfill=!0,h.fetch||(h.fetch=qe,h.Headers=j,h.Request=B,h.Response=ue),d.Headers=j,d.Request=B,d.Response=ue,d.fetch=qe,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,c.exports=r})(nE,ho);const xl=Y1(ho),oE={Accept:"application/json","Content-Type":"application/json"},aE="POST",Il={headers:oE,method:aE},Sl=10;class zi{constructor(r,i=!1){if(this.url=r,this.disableProviderPing=i,this.events=new kt.EventEmitter,this.isAvailable=!1,this.registering=!1,!Zh(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,i){this.isAvailable||await this.register();try{const n=Vs(r),h=await(await xl(this.url,Object.assign(Object.assign({},Il),{body:n}))).json();this.onPayload({data:h})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!Zh(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const i=Vs({id:1,jsonrpc:"2.0",method:"test",params:[]});await xl(r,Object.assign(Object.assign({},Il),{body:i}))}this.onOpen()}catch(i){const n=this.parseError(i);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?yc(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),h=yo(r,o);this.events.emit("payload",h)}parseError(r,i=this.url){return uf(r,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Sl&&this.events.setMaxListeners(Sl)}}const Pl="error",cE="wss://relay.walletconnect.com",uE="wc",hE="universal_provider",Al=`${uE}@2:${hE}:`,lE="https://rpc.walletconnect.com/v1",xi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,r){(function(){var i,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",y="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",A=500,F="__lodash_placeholder__",K=1,J=2,G=4,j=1,V=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,T=64,M=128,B=256,ve=512,re=30,ue="...",Te=800,qe=16,v=1,E=2,X=3,ce=1/0,k=9007199254740991,U=17976931348623157e292,z=0/0,H=4294967295,Ye=H-1,Be=H>>>1,jr=[["ary",M],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ve],["partial",le],["partialRight",T],["rearg",B]],xe="[object Arguments]",St="[object Array]",R="[object AsyncFunction]",O="[object Boolean]",P="[object Date]",u="[object DOMException]",b="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",we="[object Map]",Ne="[object Number]",De="[object Null]",Pe="[object Object]",Pt="[object Promise]",_t="[object Proxy]",ot="[object RegExp]",$e="[object Set]",Ze="[object String]",Qe="[object Symbol]",at="[object Undefined]",ze="[object WeakMap]",et="[object WeakSet]",Le="[object ArrayBuffer]",Ve="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",At="[object Int8Array]",$t="[object Int16Array]",Ht="[object Int32Array]",Bt="[object Uint8Array]",Ut="[object Uint8ClampedArray]",Jt="[object Uint16Array]",ir="[object Uint32Array]",Mr=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,Ii=/[&<>"']/g,lt=RegExp(ai.source),it=RegExp(Ii.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,st=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ct=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,wt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Xe=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,bo=/[()=,{}\[\]\/\s]/,Eo=/\\(\\)?/g,xo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Io=/^[-+]0x[0-9a-f]+$/i,So=/^0b[01]+$/i,Po=/^\[object .+?Constructor\]$/,Ao=/^0o[0-7]+$/i,Co=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ki=/($^)/,Oo=/['\n\r\u2028\u2029\\]/g,Hi="\\ud800-\\udfff",Ro="\\u0300-\\u036f",To="\\ufe20-\\ufe2f",Bi="\\u20d0-\\u20ff",Ws=Ro+To+Bi,Js="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",No="\\xac\\xb1\\xd7\\xf7",Lo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Do="\\u2000-\\u206f",Fo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ys="A-Z\\xc0-\\xd6\\xd8-\\xde",Xs="\\ufe0e\\ufe0f",Si=No+Lo+Do+Fo,gs="['’]",Pi="["+Hi+"]",vs="["+Si+"]",Ai="["+Ws+"]",Zs="\\d+",$o="["+Js+"]",Qs="["+Or+"]",en="[^"+Hi+Si+Zs+Js+Or+Ys+"]",Vi="\\ud83c[\\udffb-\\udfff]",jo="(?:"+Ai+"|"+Vi+")",tn="[^"+Hi+"]",Ki="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+Ys+"]",rn="\\u200d",sn="(?:"+Qs+"|"+en+")",Ur="(?:"+lr+"|"+en+")",nn="(?:"+gs+"(?:d|ll|m|re|s|t|ve))?",on="(?:"+gs+"(?:D|LL|M|RE|S|T|VE))?",an=jo+"?",cn="["+Xs+"]?",Mo="(?:"+rn+"(?:"+[tn,Ki,ci].join("|")+")"+cn+an+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",un="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",hn=cn+an+Mo,Gi="(?:"+[$o,Ki,ci].join("|")+")"+hn,Uo="(?:"+[tn+Ai+"?",Ai,Ki,ci,Pi].join("|")+")",ys=RegExp(gs,"g"),qo=RegExp(Ai,"g"),Wi=RegExp(Vi+"(?="+Vi+")|"+Uo+hn,"g"),ln=RegExp([lr+"?"+Qs+"+"+nn+"(?="+[vs,lr,"$"].join("|")+")",Ur+"+"+on+"(?="+[vs,lr+sn,"$"].join("|")+")",lr+"?"+sn+"+"+nn,lr+"+"+on,un,Wr,Zs,Gi].join("|"),"g"),fn=RegExp("["+rn+Hi+Ws+Xs+"]"),Ci=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,pn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zo=-1,Ke={};Ke[ht]=Ke[Me]=Ke[At]=Ke[$t]=Ke[Ht]=Ke[Bt]=Ke[Ut]=Ke[Jt]=Ke[ir]=!0,Ke[xe]=Ke[St]=Ke[Le]=Ke[O]=Ke[Ve]=Ke[P]=Ke[b]=Ke[ee]=Ke[we]=Ke[Ne]=Ke[Pe]=Ke[ot]=Ke[$e]=Ke[Ze]=Ke[ze]=!1;var ke={};ke[xe]=ke[St]=ke[Le]=ke[Ve]=ke[O]=ke[P]=ke[ht]=ke[Me]=ke[At]=ke[$t]=ke[Ht]=ke[we]=ke[Ne]=ke[Pe]=ke[ot]=ke[$e]=ke[Ze]=ke[Qe]=ke[Bt]=ke[Ut]=ke[Jt]=ke[ir]=!0,ke[b]=ke[ee]=ke[ze]=!1;var g={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,ye=parseInt,tt=typeof ks=="object"&&ks&&ks.Object===Object&&ks,Lt=typeof self=="object"&&self&&self.Object===Object&&self,Ce=tt||Lt||Function("return this")(),We=r&&!r.nodeType&&r,bt=We&&!0&&c&&!c.nodeType&&c,sr=bt&&bt.exports===We,Dt=sr&&tt.process,rt=function(){try{var I=bt&&bt.require&&bt.require("util").types;return I||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),Xt=rt&&rt.isArrayBuffer,Rr=rt&&rt.isDate,mr=rt&&rt.isMap,qr=rt&&rt.isRegExp,ms=rt&&rt.isSet,Oi=rt&&rt.isTypedArray;function qt(I,N,C){switch(C.length){case 0:return I.call(N);case 1:return I.call(N,C[0]);case 2:return I.call(N,C[0],C[1]);case 3:return I.call(N,C[0],C[1],C[2])}return I.apply(N,C)}function Ff(I,N,C,Z){for(var de=-1,Fe=I==null?0:I.length;++de<Fe;){var jt=I[de];N(Z,jt,C(jt),I)}return Z}function _r(I,N){for(var C=-1,Z=I==null?0:I.length;++C<Z&&N(I[C],C,I)!==!1;);return I}function $f(I,N){for(var C=I==null?0:I.length;C--&&N(I[C],C,I)!==!1;);return I}function Cc(I,N){for(var C=-1,Z=I==null?0:I.length;++C<Z;)if(!N(I[C],C,I))return!1;return!0}function ui(I,N){for(var C=-1,Z=I==null?0:I.length,de=0,Fe=[];++C<Z;){var jt=I[C];N(jt,C,I)&&(Fe[de++]=jt)}return Fe}function dn(I,N){var C=I==null?0:I.length;return!!C&&Ji(I,N,0)>-1}function ko(I,N,C){for(var Z=-1,de=I==null?0:I.length;++Z<de;)if(C(N,I[Z]))return!0;return!1}function nt(I,N){for(var C=-1,Z=I==null?0:I.length,de=Array(Z);++C<Z;)de[C]=N(I[C],C,I);return de}function hi(I,N){for(var C=-1,Z=N.length,de=I.length;++C<Z;)I[de+C]=N[C];return I}function Ho(I,N,C,Z){var de=-1,Fe=I==null?0:I.length;for(Z&&Fe&&(C=I[++de]);++de<Fe;)C=N(C,I[de],de,I);return C}function jf(I,N,C,Z){var de=I==null?0:I.length;for(Z&&de&&(C=I[--de]);de--;)C=N(C,I[de],de,I);return C}function Bo(I,N){for(var C=-1,Z=I==null?0:I.length;++C<Z;)if(N(I[C],C,I))return!0;return!1}var Mf=Vo("length");function Uf(I){return I.split("")}function qf(I){return I.match(Nt)||[]}function Oc(I,N,C){var Z;return C(I,function(de,Fe,jt){if(N(de,Fe,jt))return Z=Fe,!1}),Z}function gn(I,N,C,Z){for(var de=I.length,Fe=C+(Z?1:-1);Z?Fe--:++Fe<de;)if(N(I[Fe],Fe,I))return Fe;return-1}function Ji(I,N,C){return N===N?Zf(I,N,C):gn(I,Rc,C)}function zf(I,N,C,Z){for(var de=C-1,Fe=I.length;++de<Fe;)if(Z(I[de],N))return de;return-1}function Rc(I){return I!==I}function Tc(I,N){var C=I==null?0:I.length;return C?Go(I,N)/C:z}function Vo(I){return function(N){return N==null?i:N[I]}}function Ko(I){return function(N){return I==null?i:I[N]}}function Nc(I,N,C,Z,de){return de(I,function(Fe,jt,Je){C=Z?(Z=!1,Fe):N(C,Fe,jt,Je)}),C}function kf(I,N){var C=I.length;for(I.sort(N);C--;)I[C]=I[C].value;return I}function Go(I,N){for(var C,Z=-1,de=I.length;++Z<de;){var Fe=N(I[Z]);Fe!==i&&(C=C===i?Fe:C+Fe)}return C}function Wo(I,N){for(var C=-1,Z=Array(I);++C<I;)Z[C]=N(C);return Z}function Hf(I,N){return nt(N,function(C){return[C,I[C]]})}function Lc(I){return I&&I.slice(0,jc(I)+1).replace(gt,"")}function fr(I){return function(N){return I(N)}}function Jo(I,N){return nt(N,function(C){return I[C]})}function _s(I,N){return I.has(N)}function Dc(I,N){for(var C=-1,Z=I.length;++C<Z&&Ji(N,I[C],0)>-1;);return C}function Fc(I,N){for(var C=I.length;C--&&Ji(N,I[C],0)>-1;);return C}function Bf(I,N){for(var C=I.length,Z=0;C--;)I[C]===N&&++Z;return Z}var Vf=Ko(g),Kf=Ko(x);function Gf(I){return"\\"+Y[I]}function Wf(I,N){return I==null?i:I[N]}function Yi(I){return fn.test(I)}function Jf(I){return Ci.test(I)}function Yf(I){for(var N,C=[];!(N=I.next()).done;)C.push(N.value);return C}function Yo(I){var N=-1,C=Array(I.size);return I.forEach(function(Z,de){C[++N]=[de,Z]}),C}function $c(I,N){return function(C){return I(N(C))}}function li(I,N){for(var C=-1,Z=I.length,de=0,Fe=[];++C<Z;){var jt=I[C];(jt===N||jt===F)&&(I[C]=F,Fe[de++]=C)}return Fe}function vn(I){var N=-1,C=Array(I.size);return I.forEach(function(Z){C[++N]=Z}),C}function Xf(I){var N=-1,C=Array(I.size);return I.forEach(function(Z){C[++N]=[Z,Z]}),C}function Zf(I,N,C){for(var Z=C-1,de=I.length;++Z<de;)if(I[Z]===N)return Z;return-1}function Qf(I,N,C){for(var Z=C+1;Z--;)if(I[Z]===N)return Z;return Z}function Xi(I){return Yi(I)?tp(I):Mf(I)}function Tr(I){return Yi(I)?rp(I):Uf(I)}function jc(I){for(var N=I.length;N--&&wt.test(I.charAt(N)););return N}var ep=Ko($);function tp(I){for(var N=Wi.lastIndex=0;Wi.test(I);)++N;return N}function rp(I){return I.match(Wi)||[]}function ip(I){return I.match(ln)||[]}var sp=function I(N){N=N==null?Ce:Zi.defaults(Ce.Object(),N,Zi.pick(Ce,pn));var C=N.Array,Z=N.Date,de=N.Error,Fe=N.Function,jt=N.Math,Je=N.Object,Xo=N.RegExp,np=N.String,wr=N.TypeError,yn=C.prototype,op=Fe.prototype,Qi=Je.prototype,mn=N["__core-js_shared__"],_n=op.toString,Ue=Qi.hasOwnProperty,ap=0,Mc=function(){var e=/[^.]+$/.exec(mn&&mn.keys&&mn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),wn=Qi.toString,cp=_n.call(Je),up=Ce._,hp=Xo("^"+_n.call(Ue).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bn=sr?N.Buffer:i,fi=N.Symbol,En=N.Uint8Array,Uc=bn?bn.allocUnsafe:i,xn=$c(Je.getPrototypeOf,Je),qc=Je.create,zc=Qi.propertyIsEnumerable,In=yn.splice,kc=fi?fi.isConcatSpreadable:i,ws=fi?fi.iterator:i,Ri=fi?fi.toStringTag:i,Sn=function(){try{var e=Fi(Je,"defineProperty");return e({},"",{}),e}catch{}}(),lp=N.clearTimeout!==Ce.clearTimeout&&N.clearTimeout,fp=Z&&Z.now!==Ce.Date.now&&Z.now,pp=N.setTimeout!==Ce.setTimeout&&N.setTimeout,Pn=jt.ceil,An=jt.floor,Zo=Je.getOwnPropertySymbols,dp=bn?bn.isBuffer:i,Hc=N.isFinite,gp=yn.join,vp=$c(Je.keys,Je),Mt=jt.max,Gt=jt.min,yp=Z.now,mp=N.parseInt,Bc=jt.random,_p=yn.reverse,Qo=Fi(N,"DataView"),bs=Fi(N,"Map"),ea=Fi(N,"Promise"),es=Fi(N,"Set"),Es=Fi(N,"WeakMap"),xs=Fi(Je,"create"),Cn=Es&&new Es,ts={},wp=$i(Qo),bp=$i(bs),Ep=$i(ea),xp=$i(es),Ip=$i(Es),On=fi?fi.prototype:i,Is=On?On.valueOf:i,Vc=On?On.toString:i;function f(e){if(yt(e)&&!me(e)&&!(e instanceof Ae)){if(e instanceof br)return e;if(Ue.call(e,"__wrapped__"))return Ku(e)}return new br(e)}var rs=function(){function e(){}return function(t){if(!ut(t))return{};if(qc)return qc(t);e.prototype=t;var s=new e;return e.prototype=i,s}}();function Rn(){}function br(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}f.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:f}},f.prototype=Rn.prototype,f.prototype.constructor=f,br.prototype=rs(Rn.prototype),br.prototype.constructor=br;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=H,this.__views__=[]}function Sp(){var e=new Ae(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function Pp(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ap(){var e=this.__wrapped__.value(),t=this.__dir__,s=me(e),a=t<0,l=s?e.length:0,p=Ud(0,l,this.__views__),m=p.start,_=p.end,S=_-m,L=a?_:m-1,D=this.__iteratees__,q=D.length,W=0,te=Gt(S,this.__takeCount__);if(!s||!a&&l==S&&te==S)return gu(e,this.__actions__);var oe=[];e:for(;S--&&W<te;){L+=t;for(var be=-1,ae=e[L];++be<q;){var Se=D[be],Oe=Se.iteratee,gr=Se.type,er=Oe(ae);if(gr==E)ae=er;else if(!er){if(gr==v)continue e;break e}}oe[W++]=ae}return oe}Ae.prototype=rs(Rn.prototype),Ae.prototype.constructor=Ae;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Cp(){this.__data__=xs?xs(null):{},this.size=0}function Op(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Rp(e){var t=this.__data__;if(xs){var s=t[e];return s===w?i:s}return Ue.call(t,e)?t[e]:i}function Tp(e){var t=this.__data__;return xs?t[e]!==i:Ue.call(t,e)}function Np(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=xs&&t===i?w:t,this}Ti.prototype.clear=Cp,Ti.prototype.delete=Op,Ti.prototype.get=Rp,Ti.prototype.has=Tp,Ti.prototype.set=Np;function Jr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Lp(){this.__data__=[],this.size=0}function Dp(e){var t=this.__data__,s=Tn(t,e);if(s<0)return!1;var a=t.length-1;return s==a?t.pop():In.call(t,s,1),--this.size,!0}function Fp(e){var t=this.__data__,s=Tn(t,e);return s<0?i:t[s][1]}function $p(e){return Tn(this.__data__,e)>-1}function jp(e,t){var s=this.__data__,a=Tn(s,e);return a<0?(++this.size,s.push([e,t])):s[a][1]=t,this}Jr.prototype.clear=Lp,Jr.prototype.delete=Dp,Jr.prototype.get=Fp,Jr.prototype.has=$p,Jr.prototype.set=jp;function Yr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Mp(){this.size=0,this.__data__={hash:new Ti,map:new(bs||Jr),string:new Ti}}function Up(e){var t=Hn(this,e).delete(e);return this.size-=t?1:0,t}function qp(e){return Hn(this,e).get(e)}function zp(e){return Hn(this,e).has(e)}function kp(e,t){var s=Hn(this,e),a=s.size;return s.set(e,t),this.size+=s.size==a?0:1,this}Yr.prototype.clear=Mp,Yr.prototype.delete=Up,Yr.prototype.get=qp,Yr.prototype.has=zp,Yr.prototype.set=kp;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Yr;++t<s;)this.add(e[t])}function Hp(e){return this.__data__.set(e,w),this}function Bp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=Hp,Ni.prototype.has=Bp;function Nr(e){var t=this.__data__=new Jr(e);this.size=t.size}function Vp(){this.__data__=new Jr,this.size=0}function Kp(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function Gp(e){return this.__data__.get(e)}function Wp(e){return this.__data__.has(e)}function Jp(e,t){var s=this.__data__;if(s instanceof Jr){var a=s.__data__;if(!bs||a.length<o-1)return a.push([e,t]),this.size=++s.size,this;s=this.__data__=new Yr(a)}return s.set(e,t),this.size=s.size,this}Nr.prototype.clear=Vp,Nr.prototype.delete=Kp,Nr.prototype.get=Gp,Nr.prototype.has=Wp,Nr.prototype.set=Jp;function Kc(e,t){var s=me(e),a=!s&&ji(e),l=!s&&!a&&yi(e),p=!s&&!a&&!l&&os(e),m=s||a||l||p,_=m?Wo(e.length,np):[],S=_.length;for(var L in e)(t||Ue.call(e,L))&&!(m&&(L=="length"||l&&(L=="offset"||L=="parent")||p&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||ei(L,S)))&&_.push(L);return _}function Gc(e){var t=e.length;return t?e[la(0,t-1)]:i}function Yp(e,t){return Bn(nr(e),Li(t,0,e.length))}function Xp(e){return Bn(nr(e))}function ta(e,t,s){(s!==i&&!Lr(e[t],s)||s===i&&!(t in e))&&Xr(e,t,s)}function Ss(e,t,s){var a=e[t];(!(Ue.call(e,t)&&Lr(a,s))||s===i&&!(t in e))&&Xr(e,t,s)}function Tn(e,t){for(var s=e.length;s--;)if(Lr(e[s][0],t))return s;return-1}function Zp(e,t,s,a){return pi(e,function(l,p,m){t(a,l,s(l),m)}),a}function Wc(e,t){return e&&kr(t,zt(t),e)}function Qp(e,t){return e&&kr(t,ar(t),e)}function Xr(e,t,s){t=="__proto__"&&Sn?Sn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function ra(e,t){for(var s=-1,a=t.length,l=C(a),p=e==null;++s<a;)l[s]=p?i:$a(e,t[s]);return l}function Li(e,t,s){return e===e&&(s!==i&&(e=e<=s?e:s),t!==i&&(e=e>=t?e:t)),e}function Er(e,t,s,a,l,p){var m,_=t&K,S=t&J,L=t&G;if(s&&(m=l?s(e,a,l,p):s(e)),m!==i)return m;if(!ut(e))return e;var D=me(e);if(D){if(m=zd(e),!_)return nr(e,m)}else{var q=Wt(e),W=q==ee||q==fe;if(yi(e))return mu(e,_);if(q==Pe||q==xe||W&&!l){if(m=S||W?{}:ju(e),!_)return S?Rd(e,Qp(m,e)):Od(e,Wc(m,e))}else{if(!ke[q])return l?e:{};m=kd(e,q,_)}}p||(p=new Nr);var te=p.get(e);if(te)return te;p.set(e,m),fh(e)?e.forEach(function(ae){m.add(Er(ae,t,s,ae,e,p))}):hh(e)&&e.forEach(function(ae,Se){m.set(Se,Er(ae,t,s,Se,e,p))});var oe=L?S?Ea:ba:S?ar:zt,be=D?i:oe(e);return _r(be||e,function(ae,Se){be&&(Se=ae,ae=e[Se]),Ss(m,Se,Er(ae,t,s,Se,e,p))}),m}function ed(e){var t=zt(e);return function(s){return Jc(s,e,t)}}function Jc(e,t,s){var a=s.length;if(e==null)return!a;for(e=Je(e);a--;){var l=s[a],p=t[l],m=e[l];if(m===i&&!(l in e)||!p(m))return!1}return!0}function Yc(e,t,s){if(typeof e!="function")throw new wr(d);return Ns(function(){e.apply(i,s)},t)}function Ps(e,t,s,a){var l=-1,p=dn,m=!0,_=e.length,S=[],L=t.length;if(!_)return S;s&&(t=nt(t,fr(s))),a?(p=ko,m=!1):t.length>=o&&(p=_s,m=!1,t=new Ni(t));e:for(;++l<_;){var D=e[l],q=s==null?D:s(D);if(D=a||D!==0?D:0,m&&q===q){for(var W=L;W--;)if(t[W]===q)continue e;S.push(D)}else p(t,q,a)||S.push(D)}return S}var pi=xu(zr),Xc=xu(sa,!0);function td(e,t){var s=!0;return pi(e,function(a,l,p){return s=!!t(a,l,p),s}),s}function Nn(e,t,s){for(var a=-1,l=e.length;++a<l;){var p=e[a],m=t(p);if(m!=null&&(_===i?m===m&&!dr(m):s(m,_)))var _=m,S=p}return S}function rd(e,t,s,a){var l=e.length;for(s=_e(s),s<0&&(s=-s>l?0:l+s),a=a===i||a>l?l:_e(a),a<0&&(a+=l),a=s>a?0:dh(a);s<a;)e[s++]=t;return e}function Zc(e,t){var s=[];return pi(e,function(a,l,p){t(a,l,p)&&s.push(a)}),s}function Vt(e,t,s,a,l){var p=-1,m=e.length;for(s||(s=Bd),l||(l=[]);++p<m;){var _=e[p];t>0&&s(_)?t>1?Vt(_,t-1,s,a,l):hi(l,_):a||(l[l.length]=_)}return l}var ia=Iu(),Qc=Iu(!0);function zr(e,t){return e&&ia(e,t,zt)}function sa(e,t){return e&&Qc(e,t,zt)}function Ln(e,t){return ui(t,function(s){return ti(e[s])})}function Di(e,t){t=gi(t,e);for(var s=0,a=t.length;e!=null&&s<a;)e=e[Hr(t[s++])];return s&&s==a?e:i}function eu(e,t,s){var a=t(e);return me(e)?a:hi(a,s(e))}function Zt(e){return e==null?e===i?at:De:Ri&&Ri in Je(e)?Md(e):Xd(e)}function na(e,t){return e>t}function id(e,t){return e!=null&&Ue.call(e,t)}function sd(e,t){return e!=null&&t in Je(e)}function nd(e,t,s){return e>=Gt(t,s)&&e<Mt(t,s)}function oa(e,t,s){for(var a=s?ko:dn,l=e[0].length,p=e.length,m=p,_=C(p),S=1/0,L=[];m--;){var D=e[m];m&&t&&(D=nt(D,fr(t))),S=Gt(D.length,S),_[m]=!s&&(t||l>=120&&D.length>=120)?new Ni(m&&D):i}D=e[0];var q=-1,W=_[0];e:for(;++q<l&&L.length<S;){var te=D[q],oe=t?t(te):te;if(te=s||te!==0?te:0,!(W?_s(W,oe):a(L,oe,s))){for(m=p;--m;){var be=_[m];if(!(be?_s(be,oe):a(e[m],oe,s)))continue e}W&&W.push(oe),L.push(te)}}return L}function od(e,t,s,a){return zr(e,function(l,p,m){t(a,s(l),p,m)}),a}function As(e,t,s){t=gi(t,e),e=zu(e,t);var a=e==null?e:e[Hr(Ir(t))];return a==null?i:qt(a,e,s)}function tu(e){return yt(e)&&Zt(e)==xe}function ad(e){return yt(e)&&Zt(e)==Le}function cd(e){return yt(e)&&Zt(e)==P}function Cs(e,t,s,a,l){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:ud(e,t,s,a,Cs,l)}function ud(e,t,s,a,l,p){var m=me(e),_=me(t),S=m?St:Wt(e),L=_?St:Wt(t);S=S==xe?Pe:S,L=L==xe?Pe:L;var D=S==Pe,q=L==Pe,W=S==L;if(W&&yi(e)){if(!yi(t))return!1;m=!0,D=!1}if(W&&!D)return p||(p=new Nr),m||os(e)?Du(e,t,s,a,l,p):$d(e,t,S,s,a,l,p);if(!(s&j)){var te=D&&Ue.call(e,"__wrapped__"),oe=q&&Ue.call(t,"__wrapped__");if(te||oe){var be=te?e.value():e,ae=oe?t.value():t;return p||(p=new Nr),l(be,ae,s,a,p)}}return W?(p||(p=new Nr),jd(e,t,s,a,l,p)):!1}function hd(e){return yt(e)&&Wt(e)==we}function aa(e,t,s,a){var l=s.length,p=l,m=!a;if(e==null)return!p;for(e=Je(e);l--;){var _=s[l];if(m&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<p;){_=s[l];var S=_[0],L=e[S],D=_[1];if(m&&_[2]){if(L===i&&!(S in e))return!1}else{var q=new Nr;if(a)var W=a(L,D,S,e,t,q);if(!(W===i?Cs(D,L,j|V,a,q):W))return!1}}return!0}function ru(e){if(!ut(e)||Kd(e))return!1;var t=ti(e)?hp:Po;return t.test($i(e))}function ld(e){return yt(e)&&Zt(e)==ot}function fd(e){return yt(e)&&Wt(e)==$e}function pd(e){return yt(e)&&Yn(e.length)&&!!Ke[Zt(e)]}function iu(e){return typeof e=="function"?e:e==null?cr:typeof e=="object"?me(e)?ou(e[0],e[1]):nu(e):Sh(e)}function ca(e){if(!Ts(e))return vp(e);var t=[];for(var s in Je(e))Ue.call(e,s)&&s!="constructor"&&t.push(s);return t}function dd(e){if(!ut(e))return Yd(e);var t=Ts(e),s=[];for(var a in e)a=="constructor"&&(t||!Ue.call(e,a))||s.push(a);return s}function ua(e,t){return e<t}function su(e,t){var s=-1,a=or(e)?C(e.length):[];return pi(e,function(l,p,m){a[++s]=t(l,p,m)}),a}function nu(e){var t=Ia(e);return t.length==1&&t[0][2]?Uu(t[0][0],t[0][1]):function(s){return s===e||aa(s,e,t)}}function ou(e,t){return Pa(e)&&Mu(t)?Uu(Hr(e),t):function(s){var a=$a(s,e);return a===i&&a===t?ja(s,e):Cs(t,a,j|V)}}function Dn(e,t,s,a,l){e!==t&&ia(t,function(p,m){if(l||(l=new Nr),ut(p))gd(e,t,m,s,Dn,a,l);else{var _=a?a(Ca(e,m),p,m+"",e,t,l):i;_===i&&(_=p),ta(e,m,_)}},ar)}function gd(e,t,s,a,l,p,m){var _=Ca(e,s),S=Ca(t,s),L=m.get(S);if(L){ta(e,s,L);return}var D=p?p(_,S,s+"",e,t,m):i,q=D===i;if(q){var W=me(S),te=!W&&yi(S),oe=!W&&!te&&os(S);D=S,W||te||oe?me(_)?D=_:Et(_)?D=nr(_):te?(q=!1,D=mu(S,!0)):oe?(q=!1,D=_u(S,!0)):D=[]:Ls(S)||ji(S)?(D=_,ji(_)?D=gh(_):(!ut(_)||ti(_))&&(D=ju(S))):q=!1}q&&(m.set(S,D),l(D,S,a,p,m),m.delete(S)),ta(e,s,D)}function au(e,t){var s=e.length;if(s)return t+=t<0?s:0,ei(t,s)?e[t]:i}function cu(e,t,s){t.length?t=nt(t,function(p){return me(p)?function(m){return Di(m,p.length===1?p[0]:p)}:p}):t=[cr];var a=-1;t=nt(t,fr(se()));var l=su(e,function(p,m,_){var S=nt(t,function(L){return L(p)});return{criteria:S,index:++a,value:p}});return kf(l,function(p,m){return Cd(p,m,s)})}function vd(e,t){return uu(e,t,function(s,a){return ja(e,a)})}function uu(e,t,s){for(var a=-1,l=t.length,p={};++a<l;){var m=t[a],_=Di(e,m);s(_,m)&&Os(p,gi(m,e),_)}return p}function yd(e){return function(t){return Di(t,e)}}function ha(e,t,s,a){var l=a?zf:Ji,p=-1,m=t.length,_=e;for(e===t&&(t=nr(t)),s&&(_=nt(e,fr(s)));++p<m;)for(var S=0,L=t[p],D=s?s(L):L;(S=l(_,D,S,a))>-1;)_!==e&&In.call(_,S,1),In.call(e,S,1);return e}function hu(e,t){for(var s=e?t.length:0,a=s-1;s--;){var l=t[s];if(s==a||l!==p){var p=l;ei(l)?In.call(e,l,1):da(e,l)}}return e}function la(e,t){return e+An(Bc()*(t-e+1))}function md(e,t,s,a){for(var l=-1,p=Mt(Pn((t-e)/(s||1)),0),m=C(p);p--;)m[a?p:++l]=e,e+=s;return m}function fa(e,t){var s="";if(!e||t<1||t>k)return s;do t%2&&(s+=e),t=An(t/2),t&&(e+=e);while(t);return s}function Ie(e,t){return Oa(qu(e,t,cr),e+"")}function _d(e){return Gc(as(e))}function wd(e,t){var s=as(e);return Bn(s,Li(t,0,s.length))}function Os(e,t,s,a){if(!ut(e))return e;t=gi(t,e);for(var l=-1,p=t.length,m=p-1,_=e;_!=null&&++l<p;){var S=Hr(t[l]),L=s;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(l!=m){var D=_[S];L=a?a(D,S,_):i,L===i&&(L=ut(D)?D:ei(t[l+1])?[]:{})}Ss(_,S,L),_=_[S]}return e}var lu=Cn?function(e,t){return Cn.set(e,t),e}:cr,bd=Sn?function(e,t){return Sn(e,"toString",{configurable:!0,enumerable:!1,value:Ua(t),writable:!0})}:cr;function Ed(e){return Bn(as(e))}function xr(e,t,s){var a=-1,l=e.length;t<0&&(t=-t>l?0:l+t),s=s>l?l:s,s<0&&(s+=l),l=t>s?0:s-t>>>0,t>>>=0;for(var p=C(l);++a<l;)p[a]=e[a+t];return p}function xd(e,t){var s;return pi(e,function(a,l,p){return s=t(a,l,p),!s}),!!s}function Fn(e,t,s){var a=0,l=e==null?a:e.length;if(typeof t=="number"&&t===t&&l<=Be){for(;a<l;){var p=a+l>>>1,m=e[p];m!==null&&!dr(m)&&(s?m<=t:m<t)?a=p+1:l=p}return l}return pa(e,t,cr,s)}function pa(e,t,s,a){var l=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var m=t!==t,_=t===null,S=dr(t),L=t===i;l<p;){var D=An((l+p)/2),q=s(e[D]),W=q!==i,te=q===null,oe=q===q,be=dr(q);if(m)var ae=a||oe;else L?ae=oe&&(a||W):_?ae=oe&&W&&(a||!te):S?ae=oe&&W&&!te&&(a||!be):te||be?ae=!1:ae=a?q<=t:q<t;ae?l=D+1:p=D}return Gt(p,Ye)}function fu(e,t){for(var s=-1,a=e.length,l=0,p=[];++s<a;){var m=e[s],_=t?t(m):m;if(!s||!Lr(_,S)){var S=_;p[l++]=m===0?0:m}}return p}function pu(e){return typeof e=="number"?e:dr(e)?z:+e}function pr(e){if(typeof e=="string")return e;if(me(e))return nt(e,pr)+"";if(dr(e))return Vc?Vc.call(e):"";var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function di(e,t,s){var a=-1,l=dn,p=e.length,m=!0,_=[],S=_;if(s)m=!1,l=ko;else if(p>=o){var L=t?null:Dd(e);if(L)return vn(L);m=!1,l=_s,S=new Ni}else S=t?[]:_;e:for(;++a<p;){var D=e[a],q=t?t(D):D;if(D=s||D!==0?D:0,m&&q===q){for(var W=S.length;W--;)if(S[W]===q)continue e;t&&S.push(q),_.push(D)}else l(S,q,s)||(S!==_&&S.push(q),_.push(D))}return _}function da(e,t){return t=gi(t,e),e=zu(e,t),e==null||delete e[Hr(Ir(t))]}function du(e,t,s,a){return Os(e,t,s(Di(e,t)),a)}function $n(e,t,s,a){for(var l=e.length,p=a?l:-1;(a?p--:++p<l)&&t(e[p],p,e););return s?xr(e,a?0:p,a?p+1:l):xr(e,a?p+1:0,a?l:p)}function gu(e,t){var s=e;return s instanceof Ae&&(s=s.value()),Ho(t,function(a,l){return l.func.apply(l.thisArg,hi([a],l.args))},s)}function ga(e,t,s){var a=e.length;if(a<2)return a?di(e[0]):[];for(var l=-1,p=C(a);++l<a;)for(var m=e[l],_=-1;++_<a;)_!=l&&(p[l]=Ps(p[l]||m,e[_],t,s));return di(Vt(p,1),t,s)}function vu(e,t,s){for(var a=-1,l=e.length,p=t.length,m={};++a<l;){var _=a<p?t[a]:i;s(m,e[a],_)}return m}function va(e){return Et(e)?e:[]}function ya(e){return typeof e=="function"?e:cr}function gi(e,t){return me(e)?e:Pa(e,t)?[e]:Vu(je(e))}var Id=Ie;function vi(e,t,s){var a=e.length;return s=s===i?a:s,!t&&s>=a?e:xr(e,t,s)}var yu=lp||function(e){return Ce.clearTimeout(e)};function mu(e,t){if(t)return e.slice();var s=e.length,a=Uc?Uc(s):new e.constructor(s);return e.copy(a),a}function ma(e){var t=new e.constructor(e.byteLength);return new En(t).set(new En(e)),t}function Sd(e,t){var s=t?ma(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Pd(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function Ad(e){return Is?Je(Is.call(e)):{}}function _u(e,t){var s=t?ma(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function wu(e,t){if(e!==t){var s=e!==i,a=e===null,l=e===e,p=dr(e),m=t!==i,_=t===null,S=t===t,L=dr(t);if(!_&&!L&&!p&&e>t||p&&m&&S&&!_&&!L||a&&m&&S||!s&&S||!l)return 1;if(!a&&!p&&!L&&e<t||L&&s&&l&&!a&&!p||_&&s&&l||!m&&l||!S)return-1}return 0}function Cd(e,t,s){for(var a=-1,l=e.criteria,p=t.criteria,m=l.length,_=s.length;++a<m;){var S=wu(l[a],p[a]);if(S){if(a>=_)return S;var L=s[a];return S*(L=="desc"?-1:1)}}return e.index-t.index}function bu(e,t,s,a){for(var l=-1,p=e.length,m=s.length,_=-1,S=t.length,L=Mt(p-m,0),D=C(S+L),q=!a;++_<S;)D[_]=t[_];for(;++l<m;)(q||l<p)&&(D[s[l]]=e[l]);for(;L--;)D[_++]=e[l++];return D}function Eu(e,t,s,a){for(var l=-1,p=e.length,m=-1,_=s.length,S=-1,L=t.length,D=Mt(p-_,0),q=C(D+L),W=!a;++l<D;)q[l]=e[l];for(var te=l;++S<L;)q[te+S]=t[S];for(;++m<_;)(W||l<p)&&(q[te+s[m]]=e[l++]);return q}function nr(e,t){var s=-1,a=e.length;for(t||(t=C(a));++s<a;)t[s]=e[s];return t}function kr(e,t,s,a){var l=!s;s||(s={});for(var p=-1,m=t.length;++p<m;){var _=t[p],S=a?a(s[_],e[_],_,s,e):i;S===i&&(S=e[_]),l?Xr(s,_,S):Ss(s,_,S)}return s}function Od(e,t){return kr(e,Sa(e),t)}function Rd(e,t){return kr(e,Fu(e),t)}function jn(e,t){return function(s,a){var l=me(s)?Ff:Zp,p=t?t():{};return l(s,e,se(a,2),p)}}function is(e){return Ie(function(t,s){var a=-1,l=s.length,p=l>1?s[l-1]:i,m=l>2?s[2]:i;for(p=e.length>3&&typeof p=="function"?(l--,p):i,m&&Qt(s[0],s[1],m)&&(p=l<3?i:p,l=1),t=Je(t);++a<l;){var _=s[a];_&&e(t,_,a,p)}return t})}function xu(e,t){return function(s,a){if(s==null)return s;if(!or(s))return e(s,a);for(var l=s.length,p=t?l:-1,m=Je(s);(t?p--:++p<l)&&a(m[p],p,m)!==!1;);return s}}function Iu(e){return function(t,s,a){for(var l=-1,p=Je(t),m=a(t),_=m.length;_--;){var S=m[e?_:++l];if(s(p[S],S,p)===!1)break}return t}}function Td(e,t,s){var a=t&ie,l=Rs(e);function p(){var m=this&&this!==Ce&&this instanceof p?l:e;return m.apply(a?s:this,arguments)}return p}function Su(e){return function(t){t=je(t);var s=Yi(t)?Tr(t):i,a=s?s[0]:t.charAt(0),l=s?vi(s,1).join(""):t.slice(1);return a[e]()+l}}function ss(e){return function(t){return Ho(xh(Eh(t).replace(ys,"")),e,"")}}function Rs(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=rs(e.prototype),a=e.apply(s,t);return ut(a)?a:s}}function Nd(e,t,s){var a=Rs(e);function l(){for(var p=arguments.length,m=C(p),_=p,S=ns(l);_--;)m[_]=arguments[_];var L=p<3&&m[0]!==S&&m[p-1]!==S?[]:li(m,S);if(p-=L.length,p<s)return Ru(e,t,Mn,l.placeholder,i,m,L,i,i,s-p);var D=this&&this!==Ce&&this instanceof l?a:e;return qt(D,this,m)}return l}function Pu(e){return function(t,s,a){var l=Je(t);if(!or(t)){var p=se(s,3);t=zt(t),s=function(_){return p(l[_],_,l)}}var m=e(t,s,a);return m>-1?l[p?t[m]:m]:i}}function Au(e){return Qr(function(t){var s=t.length,a=s,l=br.prototype.thru;for(e&&t.reverse();a--;){var p=t[a];if(typeof p!="function")throw new wr(d);if(l&&!m&&kn(p)=="wrapper")var m=new br([],!0)}for(a=m?a:s;++a<s;){p=t[a];var _=kn(p),S=_=="wrapper"?xa(p):i;S&&Aa(S[0])&&S[1]==(M|pe|le|B)&&!S[4].length&&S[9]==1?m=m[kn(S[0])].apply(m,S[3]):m=p.length==1&&Aa(p)?m[_]():m.thru(p)}return function(){var L=arguments,D=L[0];if(m&&L.length==1&&me(D))return m.plant(D).value();for(var q=0,W=s?t[q].apply(this,L):D;++q<s;)W=t[q].call(this,W);return W}})}function Mn(e,t,s,a,l,p,m,_,S,L){var D=t&M,q=t&ie,W=t&Ee,te=t&(pe|he),oe=t&ve,be=W?i:Rs(e);function ae(){for(var Se=arguments.length,Oe=C(Se),gr=Se;gr--;)Oe[gr]=arguments[gr];if(te)var er=ns(ae),vr=Bf(Oe,er);if(a&&(Oe=bu(Oe,a,l,te)),p&&(Oe=Eu(Oe,p,m,te)),Se-=vr,te&&Se<L){var xt=li(Oe,er);return Ru(e,t,Mn,ae.placeholder,s,Oe,xt,_,S,L-Se)}var Dr=q?s:this,ii=W?Dr[e]:e;return Se=Oe.length,_?Oe=Zd(Oe,_):oe&&Se>1&&Oe.reverse(),D&&S<Se&&(Oe.length=S),this&&this!==Ce&&this instanceof ae&&(ii=be||Rs(ii)),ii.apply(Dr,Oe)}return ae}function Cu(e,t){return function(s,a){return od(s,e,t(a),{})}}function Un(e,t){return function(s,a){var l;if(s===i&&a===i)return t;if(s!==i&&(l=s),a!==i){if(l===i)return a;typeof s=="string"||typeof a=="string"?(s=pr(s),a=pr(a)):(s=pu(s),a=pu(a)),l=e(s,a)}return l}}function _a(e){return Qr(function(t){return t=nt(t,fr(se())),Ie(function(s){var a=this;return e(t,function(l){return qt(l,a,s)})})})}function qn(e,t){t=t===i?" ":pr(t);var s=t.length;if(s<2)return s?fa(t,e):t;var a=fa(t,Pn(e/Xi(t)));return Yi(t)?vi(Tr(a),0,e).join(""):a.slice(0,e)}function Ld(e,t,s,a){var l=t&ie,p=Rs(e);function m(){for(var _=-1,S=arguments.length,L=-1,D=a.length,q=C(D+S),W=this&&this!==Ce&&this instanceof m?p:e;++L<D;)q[L]=a[L];for(;S--;)q[L++]=arguments[++_];return qt(W,l?s:this,q)}return m}function Ou(e){return function(t,s,a){return a&&typeof a!="number"&&Qt(t,s,a)&&(s=a=i),t=ri(t),s===i?(s=t,t=0):s=ri(s),a=a===i?t<s?1:-1:ri(a),md(t,s,a,e)}}function zn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Sr(t),s=Sr(s)),e(t,s)}}function Ru(e,t,s,a,l,p,m,_,S,L){var D=t&pe,q=D?m:i,W=D?i:m,te=D?p:i,oe=D?i:p;t|=D?le:T,t&=~(D?T:le),t&ge||(t&=~(ie|Ee));var be=[e,t,l,te,q,oe,W,_,S,L],ae=s.apply(i,be);return Aa(e)&&ku(ae,be),ae.placeholder=a,Hu(ae,e,t)}function wa(e){var t=jt[e];return function(s,a){if(s=Sr(s),a=a==null?0:Gt(_e(a),292),a&&Hc(s)){var l=(je(s)+"e").split("e"),p=t(l[0]+"e"+(+l[1]+a));return l=(je(p)+"e").split("e"),+(l[0]+"e"+(+l[1]-a))}return t(s)}}var Dd=es&&1/vn(new es([,-0]))[1]==ce?function(e){return new es(e)}:ka;function Tu(e){return function(t){var s=Wt(t);return s==we?Yo(t):s==$e?Xf(t):Hf(t,e(t))}}function Zr(e,t,s,a,l,p,m,_){var S=t&Ee;if(!S&&typeof e!="function")throw new wr(d);var L=a?a.length:0;if(L||(t&=~(le|T),a=l=i),m=m===i?m:Mt(_e(m),0),_=_===i?_:_e(_),L-=l?l.length:0,t&T){var D=a,q=l;a=l=i}var W=S?i:xa(e),te=[e,t,s,a,l,D,q,p,m,_];if(W&&Jd(te,W),e=te[0],t=te[1],s=te[2],a=te[3],l=te[4],_=te[9]=te[9]===i?S?0:e.length:Mt(te[9]-L,0),!_&&t&(pe|he)&&(t&=~(pe|he)),!t||t==ie)var oe=Td(e,t,s);else t==pe||t==he?oe=Nd(e,t,_):(t==le||t==(ie|le))&&!l.length?oe=Ld(e,t,s,a):oe=Mn.apply(i,te);var be=W?lu:ku;return Hu(be(oe,te),e,t)}function Nu(e,t,s,a){return e===i||Lr(e,Qi[s])&&!Ue.call(a,s)?t:e}function Lu(e,t,s,a,l,p){return ut(e)&&ut(t)&&(p.set(t,e),Dn(e,t,i,Lu,p),p.delete(t)),e}function Fd(e){return Ls(e)?i:e}function Du(e,t,s,a,l,p){var m=s&j,_=e.length,S=t.length;if(_!=S&&!(m&&S>_))return!1;var L=p.get(e),D=p.get(t);if(L&&D)return L==t&&D==e;var q=-1,W=!0,te=s&V?new Ni:i;for(p.set(e,t),p.set(t,e);++q<_;){var oe=e[q],be=t[q];if(a)var ae=m?a(be,oe,q,t,e,p):a(oe,be,q,e,t,p);if(ae!==i){if(ae)continue;W=!1;break}if(te){if(!Bo(t,function(Se,Oe){if(!_s(te,Oe)&&(oe===Se||l(oe,Se,s,a,p)))return te.push(Oe)})){W=!1;break}}else if(!(oe===be||l(oe,be,s,a,p))){W=!1;break}}return p.delete(e),p.delete(t),W}function $d(e,t,s,a,l,p,m){switch(s){case Ve:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Le:return!(e.byteLength!=t.byteLength||!p(new En(e),new En(t)));case O:case P:case Ne:return Lr(+e,+t);case b:return e.name==t.name&&e.message==t.message;case ot:case Ze:return e==t+"";case we:var _=Yo;case $e:var S=a&j;if(_||(_=vn),e.size!=t.size&&!S)return!1;var L=m.get(e);if(L)return L==t;a|=V,m.set(e,t);var D=Du(_(e),_(t),a,l,p,m);return m.delete(e),D;case Qe:if(Is)return Is.call(e)==Is.call(t)}return!1}function jd(e,t,s,a,l,p){var m=s&j,_=ba(e),S=_.length,L=ba(t),D=L.length;if(S!=D&&!m)return!1;for(var q=S;q--;){var W=_[q];if(!(m?W in t:Ue.call(t,W)))return!1}var te=p.get(e),oe=p.get(t);if(te&&oe)return te==t&&oe==e;var be=!0;p.set(e,t),p.set(t,e);for(var ae=m;++q<S;){W=_[q];var Se=e[W],Oe=t[W];if(a)var gr=m?a(Oe,Se,W,t,e,p):a(Se,Oe,W,e,t,p);if(!(gr===i?Se===Oe||l(Se,Oe,s,a,p):gr)){be=!1;break}ae||(ae=W=="constructor")}if(be&&!ae){var er=e.constructor,vr=t.constructor;er!=vr&&"constructor"in e&&"constructor"in t&&!(typeof er=="function"&&er instanceof er&&typeof vr=="function"&&vr instanceof vr)&&(be=!1)}return p.delete(e),p.delete(t),be}function Qr(e){return Oa(qu(e,i,Ju),e+"")}function ba(e){return eu(e,zt,Sa)}function Ea(e){return eu(e,ar,Fu)}var xa=Cn?function(e){return Cn.get(e)}:ka;function kn(e){for(var t=e.name+"",s=ts[t],a=Ue.call(ts,t)?s.length:0;a--;){var l=s[a],p=l.func;if(p==null||p==e)return l.name}return t}function ns(e){var t=Ue.call(f,"placeholder")?f:e;return t.placeholder}function se(){var e=f.iteratee||qa;return e=e===qa?iu:e,arguments.length?e(arguments[0],arguments[1]):e}function Hn(e,t){var s=e.__data__;return Vd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Ia(e){for(var t=zt(e),s=t.length;s--;){var a=t[s],l=e[a];t[s]=[a,l,Mu(l)]}return t}function Fi(e,t){var s=Wf(e,t);return ru(s)?s:i}function Md(e){var t=Ue.call(e,Ri),s=e[Ri];try{e[Ri]=i;var a=!0}catch{}var l=wn.call(e);return a&&(t?e[Ri]=s:delete e[Ri]),l}var Sa=Zo?function(e){return e==null?[]:(e=Je(e),ui(Zo(e),function(t){return zc.call(e,t)}))}:Ha,Fu=Zo?function(e){for(var t=[];e;)hi(t,Sa(e)),e=xn(e);return t}:Ha,Wt=Zt;(Qo&&Wt(new Qo(new ArrayBuffer(1)))!=Ve||bs&&Wt(new bs)!=we||ea&&Wt(ea.resolve())!=Pt||es&&Wt(new es)!=$e||Es&&Wt(new Es)!=ze)&&(Wt=function(e){var t=Zt(e),s=t==Pe?e.constructor:i,a=s?$i(s):"";if(a)switch(a){case wp:return Ve;case bp:return we;case Ep:return Pt;case xp:return $e;case Ip:return ze}return t});function Ud(e,t,s){for(var a=-1,l=s.length;++a<l;){var p=s[a],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Gt(t,e+m);break;case"takeRight":e=Mt(e,t-m);break}}return{start:e,end:t}}function qd(e){var t=e.match(Xe);return t?t[1].split(Tt):[]}function $u(e,t,s){t=gi(t,e);for(var a=-1,l=t.length,p=!1;++a<l;){var m=Hr(t[a]);if(!(p=e!=null&&s(e,m)))break;e=e[m]}return p||++a!=l?p:(l=e==null?0:e.length,!!l&&Yn(l)&&ei(m,l)&&(me(e)||ji(e)))}function zd(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&Ue.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function ju(e){return typeof e.constructor=="function"&&!Ts(e)?rs(xn(e)):{}}function kd(e,t,s){var a=e.constructor;switch(t){case Le:return ma(e);case O:case P:return new a(+e);case Ve:return Sd(e,s);case ht:case Me:case At:case $t:case Ht:case Bt:case Ut:case Jt:case ir:return _u(e,s);case we:return new a;case Ne:case Ze:return new a(e);case ot:return Pd(e);case $e:return new a;case Qe:return Ad(e)}}function Hd(e,t){var s=t.length;if(!s)return e;var a=s-1;return t[a]=(s>1?"& ":"")+t[a],t=t.join(s>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+t+`] */
`)}function Bd(e){return me(e)||ji(e)||!!(kc&&e&&e[kc])}function ei(e,t){var s=typeof e;return t=t??k,!!t&&(s=="number"||s!="symbol"&&Co.test(e))&&e>-1&&e%1==0&&e<t}function Qt(e,t,s){if(!ut(s))return!1;var a=typeof t;return(a=="number"?or(s)&&ei(t,s.length):a=="string"&&t in s)?Lr(s[t],e):!1}function Pa(e,t){if(me(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||dr(e)?!0:Ct.test(e)||!st.test(e)||t!=null&&e in Je(t)}function Vd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Aa(e){var t=kn(e),s=f[t];if(typeof s!="function"||!(t in Ae.prototype))return!1;if(e===s)return!0;var a=xa(s);return!!a&&e===a[0]}function Kd(e){return!!Mc&&Mc in e}var Gd=mn?ti:Ba;function Ts(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||Qi;return e===s}function Mu(e){return e===e&&!ut(e)}function Uu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==i||e in Je(s))}}function Wd(e){var t=Wn(e,function(a){return s.size===A&&s.clear(),a}),s=t.cache;return t}function Jd(e,t){var s=e[1],a=t[1],l=s|a,p=l<(ie|Ee|M),m=a==M&&s==pe||a==M&&s==B&&e[7].length<=t[8]||a==(M|B)&&t[7].length<=t[8]&&s==pe;if(!(p||m))return e;a&ie&&(e[2]=t[2],l|=s&ie?0:ge);var _=t[3];if(_){var S=e[3];e[3]=S?bu(S,_,t[4]):_,e[4]=S?li(e[3],F):t[4]}return _=t[5],_&&(S=e[5],e[5]=S?Eu(S,_,t[6]):_,e[6]=S?li(e[5],F):t[6]),_=t[7],_&&(e[7]=_),a&M&&(e[8]=e[8]==null?t[8]:Gt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}function Yd(e){var t=[];if(e!=null)for(var s in Je(e))t.push(s);return t}function Xd(e){return wn.call(e)}function qu(e,t,s){return t=Mt(t===i?e.length-1:t,0),function(){for(var a=arguments,l=-1,p=Mt(a.length-t,0),m=C(p);++l<p;)m[l]=a[t+l];l=-1;for(var _=C(t+1);++l<t;)_[l]=a[l];return _[t]=s(m),qt(e,this,_)}}function zu(e,t){return t.length<2?e:Di(e,xr(t,0,-1))}function Zd(e,t){for(var s=e.length,a=Gt(t.length,s),l=nr(e);a--;){var p=t[a];e[a]=ei(p,s)?l[p]:i}return e}function Ca(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var ku=Bu(lu),Ns=pp||function(e,t){return Ce.setTimeout(e,t)},Oa=Bu(bd);function Hu(e,t,s){var a=t+"";return Oa(e,Hd(a,Qd(qd(a),s)))}function Bu(e){var t=0,s=0;return function(){var a=yp(),l=qe-(a-s);if(s=a,l>0){if(++t>=Te)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Bn(e,t){var s=-1,a=e.length,l=a-1;for(t=t===i?a:t;++s<t;){var p=la(s,l),m=e[p];e[p]=e[s],e[s]=m}return e.length=t,e}var Vu=Wd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ot,function(s,a,l,p){t.push(l?p.replace(Eo,"$1"):a||s)}),t});function Hr(e){if(typeof e=="string"||dr(e))return e;var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function $i(e){if(e!=null){try{return _n.call(e)}catch{}try{return e+""}catch{}}return""}function Qd(e,t){return _r(jr,function(s){var a="_."+s[0];t&s[1]&&!dn(e,a)&&e.push(a)}),e.sort()}function Ku(e){if(e instanceof Ae)return e.clone();var t=new br(e.__wrapped__,e.__chain__);return t.__actions__=nr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function eg(e,t,s){(s?Qt(e,t,s):t===i)?t=1:t=Mt(_e(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var l=0,p=0,m=C(Pn(a/t));l<a;)m[p++]=xr(e,l,l+=t);return m}function tg(e){for(var t=-1,s=e==null?0:e.length,a=0,l=[];++t<s;){var p=e[t];p&&(l[a++]=p)}return l}function rg(){var e=arguments.length;if(!e)return[];for(var t=C(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return hi(me(s)?nr(s):[s],Vt(t,1))}var ig=Ie(function(e,t){return Et(e)?Ps(e,Vt(t,1,Et,!0)):[]}),sg=Ie(function(e,t){var s=Ir(t);return Et(s)&&(s=i),Et(e)?Ps(e,Vt(t,1,Et,!0),se(s,2)):[]}),ng=Ie(function(e,t){var s=Ir(t);return Et(s)&&(s=i),Et(e)?Ps(e,Vt(t,1,Et,!0),i,s):[]});function og(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:_e(t),xr(e,t<0?0:t,a)):[]}function ag(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:_e(t),t=a-t,xr(e,0,t<0?0:t)):[]}function cg(e,t){return e&&e.length?$n(e,se(t,3),!0,!0):[]}function ug(e,t){return e&&e.length?$n(e,se(t,3),!0):[]}function hg(e,t,s,a){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Qt(e,t,s)&&(s=0,a=l),rd(e,t,s,a)):[]}function Gu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=s==null?0:_e(s);return l<0&&(l=Mt(a+l,0)),gn(e,se(t,3),l)}function Wu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=a-1;return s!==i&&(l=_e(s),l=s<0?Mt(a+l,0):Gt(l,a-1)),gn(e,se(t,3),l,!0)}function Ju(e){var t=e==null?0:e.length;return t?Vt(e,1):[]}function lg(e){var t=e==null?0:e.length;return t?Vt(e,ce):[]}function fg(e,t){var s=e==null?0:e.length;return s?(t=t===i?1:_e(t),Vt(e,t)):[]}function pg(e){for(var t=-1,s=e==null?0:e.length,a={};++t<s;){var l=e[t];a[l[0]]=l[1]}return a}function Yu(e){return e&&e.length?e[0]:i}function dg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=s==null?0:_e(s);return l<0&&(l=Mt(a+l,0)),Ji(e,t,l)}function gg(e){var t=e==null?0:e.length;return t?xr(e,0,-1):[]}var vg=Ie(function(e){var t=nt(e,va);return t.length&&t[0]===e[0]?oa(t):[]}),yg=Ie(function(e){var t=Ir(e),s=nt(e,va);return t===Ir(s)?t=i:s.pop(),s.length&&s[0]===e[0]?oa(s,se(t,2)):[]}),mg=Ie(function(e){var t=Ir(e),s=nt(e,va);return t=typeof t=="function"?t:i,t&&s.pop(),s.length&&s[0]===e[0]?oa(s,i,t):[]});function _g(e,t){return e==null?"":gp.call(e,t)}function Ir(e){var t=e==null?0:e.length;return t?e[t-1]:i}function wg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=a;return s!==i&&(l=_e(s),l=l<0?Mt(a+l,0):Gt(l,a-1)),t===t?Qf(e,t,l):gn(e,Rc,l,!0)}function bg(e,t){return e&&e.length?au(e,_e(t)):i}var Eg=Ie(Xu);function Xu(e,t){return e&&e.length&&t&&t.length?ha(e,t):e}function xg(e,t,s){return e&&e.length&&t&&t.length?ha(e,t,se(s,2)):e}function Ig(e,t,s){return e&&e.length&&t&&t.length?ha(e,t,i,s):e}var Sg=Qr(function(e,t){var s=e==null?0:e.length,a=ra(e,t);return hu(e,nt(t,function(l){return ei(l,s)?+l:l}).sort(wu)),a});function Pg(e,t){var s=[];if(!(e&&e.length))return s;var a=-1,l=[],p=e.length;for(t=se(t,3);++a<p;){var m=e[a];t(m,a,e)&&(s.push(m),l.push(a))}return hu(e,l),s}function Ra(e){return e==null?e:_p.call(e)}function Ag(e,t,s){var a=e==null?0:e.length;return a?(s&&typeof s!="number"&&Qt(e,t,s)?(t=0,s=a):(t=t==null?0:_e(t),s=s===i?a:_e(s)),xr(e,t,s)):[]}function Cg(e,t){return Fn(e,t)}function Og(e,t,s){return pa(e,t,se(s,2))}function Rg(e,t){var s=e==null?0:e.length;if(s){var a=Fn(e,t);if(a<s&&Lr(e[a],t))return a}return-1}function Tg(e,t){return Fn(e,t,!0)}function Ng(e,t,s){return pa(e,t,se(s,2),!0)}function Lg(e,t){var s=e==null?0:e.length;if(s){var a=Fn(e,t,!0)-1;if(Lr(e[a],t))return a}return-1}function Dg(e){return e&&e.length?fu(e):[]}function Fg(e,t){return e&&e.length?fu(e,se(t,2)):[]}function $g(e){var t=e==null?0:e.length;return t?xr(e,1,t):[]}function jg(e,t,s){return e&&e.length?(t=s||t===i?1:_e(t),xr(e,0,t<0?0:t)):[]}function Mg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:_e(t),t=a-t,xr(e,t<0?0:t,a)):[]}function Ug(e,t){return e&&e.length?$n(e,se(t,3),!1,!0):[]}function qg(e,t){return e&&e.length?$n(e,se(t,3)):[]}var zg=Ie(function(e){return di(Vt(e,1,Et,!0))}),kg=Ie(function(e){var t=Ir(e);return Et(t)&&(t=i),di(Vt(e,1,Et,!0),se(t,2))}),Hg=Ie(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,di(Vt(e,1,Et,!0),i,t)});function Bg(e){return e&&e.length?di(e):[]}function Vg(e,t){return e&&e.length?di(e,se(t,2)):[]}function Kg(e,t){return t=typeof t=="function"?t:i,e&&e.length?di(e,i,t):[]}function Ta(e){if(!(e&&e.length))return[];var t=0;return e=ui(e,function(s){if(Et(s))return t=Mt(s.length,t),!0}),Wo(t,function(s){return nt(e,Vo(s))})}function Zu(e,t){if(!(e&&e.length))return[];var s=Ta(e);return t==null?s:nt(s,function(a){return qt(t,i,a)})}var Gg=Ie(function(e,t){return Et(e)?Ps(e,t):[]}),Wg=Ie(function(e){return ga(ui(e,Et))}),Jg=Ie(function(e){var t=Ir(e);return Et(t)&&(t=i),ga(ui(e,Et),se(t,2))}),Yg=Ie(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,ga(ui(e,Et),i,t)}),Xg=Ie(Ta);function Zg(e,t){return vu(e||[],t||[],Ss)}function Qg(e,t){return vu(e||[],t||[],Os)}var ev=Ie(function(e){var t=e.length,s=t>1?e[t-1]:i;return s=typeof s=="function"?(e.pop(),s):i,Zu(e,s)});function Qu(e){var t=f(e);return t.__chain__=!0,t}function tv(e,t){return t(e),e}function Vn(e,t){return t(e)}var rv=Qr(function(e){var t=e.length,s=t?e[0]:0,a=this.__wrapped__,l=function(p){return ra(p,e)};return t>1||this.__actions__.length||!(a instanceof Ae)||!ei(s)?this.thru(l):(a=a.slice(s,+s+(t?1:0)),a.__actions__.push({func:Vn,args:[l],thisArg:i}),new br(a,this.__chain__).thru(function(p){return t&&!p.length&&p.push(i),p}))});function iv(){return Qu(this)}function sv(){return new br(this.value(),this.__chain__)}function nv(){this.__values__===i&&(this.__values__=ph(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function ov(){return this}function av(e){for(var t,s=this;s instanceof Rn;){var a=Ku(s);a.__index__=0,a.__values__=i,t?l.__wrapped__=a:t=a;var l=a;s=s.__wrapped__}return l.__wrapped__=e,t}function cv(){var e=this.__wrapped__;if(e instanceof Ae){var t=e;return this.__actions__.length&&(t=new Ae(this)),t=t.reverse(),t.__actions__.push({func:Vn,args:[Ra],thisArg:i}),new br(t,this.__chain__)}return this.thru(Ra)}function uv(){return gu(this.__wrapped__,this.__actions__)}var hv=jn(function(e,t,s){Ue.call(e,s)?++e[s]:Xr(e,s,1)});function lv(e,t,s){var a=me(e)?Cc:td;return s&&Qt(e,t,s)&&(t=i),a(e,se(t,3))}function fv(e,t){var s=me(e)?ui:Zc;return s(e,se(t,3))}var pv=Pu(Gu),dv=Pu(Wu);function gv(e,t){return Vt(Kn(e,t),1)}function vv(e,t){return Vt(Kn(e,t),ce)}function yv(e,t,s){return s=s===i?1:_e(s),Vt(Kn(e,t),s)}function eh(e,t){var s=me(e)?_r:pi;return s(e,se(t,3))}function th(e,t){var s=me(e)?$f:Xc;return s(e,se(t,3))}var mv=jn(function(e,t,s){Ue.call(e,s)?e[s].push(t):Xr(e,s,[t])});function _v(e,t,s,a){e=or(e)?e:as(e),s=s&&!a?_e(s):0;var l=e.length;return s<0&&(s=Mt(l+s,0)),Xn(e)?s<=l&&e.indexOf(t,s)>-1:!!l&&Ji(e,t,s)>-1}var wv=Ie(function(e,t,s){var a=-1,l=typeof t=="function",p=or(e)?C(e.length):[];return pi(e,function(m){p[++a]=l?qt(t,m,s):As(m,t,s)}),p}),bv=jn(function(e,t,s){Xr(e,s,t)});function Kn(e,t){var s=me(e)?nt:su;return s(e,se(t,3))}function Ev(e,t,s,a){return e==null?[]:(me(t)||(t=t==null?[]:[t]),s=a?i:s,me(s)||(s=s==null?[]:[s]),cu(e,t,s))}var xv=jn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function Iv(e,t,s){var a=me(e)?Ho:Nc,l=arguments.length<3;return a(e,se(t,4),s,l,pi)}function Sv(e,t,s){var a=me(e)?jf:Nc,l=arguments.length<3;return a(e,se(t,4),s,l,Xc)}function Pv(e,t){var s=me(e)?ui:Zc;return s(e,Jn(se(t,3)))}function Av(e){var t=me(e)?Gc:_d;return t(e)}function Cv(e,t,s){(s?Qt(e,t,s):t===i)?t=1:t=_e(t);var a=me(e)?Yp:wd;return a(e,t)}function Ov(e){var t=me(e)?Xp:Ed;return t(e)}function Rv(e){if(e==null)return 0;if(or(e))return Xn(e)?Xi(e):e.length;var t=Wt(e);return t==we||t==$e?e.size:ca(e).length}function Tv(e,t,s){var a=me(e)?Bo:xd;return s&&Qt(e,t,s)&&(t=i),a(e,se(t,3))}var Nv=Ie(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Qt(e,t[0],t[1])?t=[]:s>2&&Qt(t[0],t[1],t[2])&&(t=[t[0]]),cu(e,Vt(t,1),[])}),Gn=fp||function(){return Ce.Date.now()};function Lv(e,t){if(typeof t!="function")throw new wr(d);return e=_e(e),function(){if(--e<1)return t.apply(this,arguments)}}function rh(e,t,s){return t=s?i:t,t=e&&t==null?e.length:t,Zr(e,M,i,i,i,i,t)}function ih(e,t){var s;if(typeof t!="function")throw new wr(d);return e=_e(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=i),s}}var Na=Ie(function(e,t,s){var a=ie;if(s.length){var l=li(s,ns(Na));a|=le}return Zr(e,a,t,s,l)}),sh=Ie(function(e,t,s){var a=ie|Ee;if(s.length){var l=li(s,ns(sh));a|=le}return Zr(t,a,e,s,l)});function nh(e,t,s){t=s?i:t;var a=Zr(e,pe,i,i,i,i,i,t);return a.placeholder=nh.placeholder,a}function oh(e,t,s){t=s?i:t;var a=Zr(e,he,i,i,i,i,i,t);return a.placeholder=oh.placeholder,a}function ah(e,t,s){var a,l,p,m,_,S,L=0,D=!1,q=!1,W=!0;if(typeof e!="function")throw new wr(d);t=Sr(t)||0,ut(s)&&(D=!!s.leading,q="maxWait"in s,p=q?Mt(Sr(s.maxWait)||0,t):p,W="trailing"in s?!!s.trailing:W);function te(xt){var Dr=a,ii=l;return a=l=i,L=xt,m=e.apply(ii,Dr),m}function oe(xt){return L=xt,_=Ns(Se,t),D?te(xt):m}function be(xt){var Dr=xt-S,ii=xt-L,Ph=t-Dr;return q?Gt(Ph,p-ii):Ph}function ae(xt){var Dr=xt-S,ii=xt-L;return S===i||Dr>=t||Dr<0||q&&ii>=p}function Se(){var xt=Gn();if(ae(xt))return Oe(xt);_=Ns(Se,be(xt))}function Oe(xt){return _=i,W&&a?te(xt):(a=l=i,m)}function gr(){_!==i&&yu(_),L=0,a=S=l=_=i}function er(){return _===i?m:Oe(Gn())}function vr(){var xt=Gn(),Dr=ae(xt);if(a=arguments,l=this,S=xt,Dr){if(_===i)return oe(S);if(q)return yu(_),_=Ns(Se,t),te(S)}return _===i&&(_=Ns(Se,t)),m}return vr.cancel=gr,vr.flush=er,vr}var Dv=Ie(function(e,t){return Yc(e,1,t)}),Fv=Ie(function(e,t,s){return Yc(e,Sr(t)||0,s)});function $v(e){return Zr(e,ve)}function Wn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new wr(d);var s=function(){var a=arguments,l=t?t.apply(this,a):a[0],p=s.cache;if(p.has(l))return p.get(l);var m=e.apply(this,a);return s.cache=p.set(l,m)||p,m};return s.cache=new(Wn.Cache||Yr),s}Wn.Cache=Yr;function Jn(e){if(typeof e!="function")throw new wr(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function jv(e){return ih(2,e)}var Mv=Id(function(e,t){t=t.length==1&&me(t[0])?nt(t[0],fr(se())):nt(Vt(t,1),fr(se()));var s=t.length;return Ie(function(a){for(var l=-1,p=Gt(a.length,s);++l<p;)a[l]=t[l].call(this,a[l]);return qt(e,this,a)})}),La=Ie(function(e,t){var s=li(t,ns(La));return Zr(e,le,i,t,s)}),ch=Ie(function(e,t){var s=li(t,ns(ch));return Zr(e,T,i,t,s)}),Uv=Qr(function(e,t){return Zr(e,B,i,i,i,t)});function qv(e,t){if(typeof e!="function")throw new wr(d);return t=t===i?t:_e(t),Ie(e,t)}function zv(e,t){if(typeof e!="function")throw new wr(d);return t=t==null?0:Mt(_e(t),0),Ie(function(s){var a=s[t],l=vi(s,0,t);return a&&hi(l,a),qt(e,this,l)})}function kv(e,t,s){var a=!0,l=!0;if(typeof e!="function")throw new wr(d);return ut(s)&&(a="leading"in s?!!s.leading:a,l="trailing"in s?!!s.trailing:l),ah(e,t,{leading:a,maxWait:t,trailing:l})}function Hv(e){return rh(e,1)}function Bv(e,t){return La(ya(t),e)}function Vv(){if(!arguments.length)return[];var e=arguments[0];return me(e)?e:[e]}function Kv(e){return Er(e,G)}function Gv(e,t){return t=typeof t=="function"?t:i,Er(e,G,t)}function Wv(e){return Er(e,K|G)}function Jv(e,t){return t=typeof t=="function"?t:i,Er(e,K|G,t)}function Yv(e,t){return t==null||Jc(e,t,zt(t))}function Lr(e,t){return e===t||e!==e&&t!==t}var Xv=zn(na),Zv=zn(function(e,t){return e>=t}),ji=tu(function(){return arguments}())?tu:function(e){return yt(e)&&Ue.call(e,"callee")&&!zc.call(e,"callee")},me=C.isArray,Qv=Xt?fr(Xt):ad;function or(e){return e!=null&&Yn(e.length)&&!ti(e)}function Et(e){return yt(e)&&or(e)}function ey(e){return e===!0||e===!1||yt(e)&&Zt(e)==O}var yi=dp||Ba,ty=Rr?fr(Rr):cd;function ry(e){return yt(e)&&e.nodeType===1&&!Ls(e)}function iy(e){if(e==null)return!0;if(or(e)&&(me(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||os(e)||ji(e)))return!e.length;var t=Wt(e);if(t==we||t==$e)return!e.size;if(Ts(e))return!ca(e).length;for(var s in e)if(Ue.call(e,s))return!1;return!0}function sy(e,t){return Cs(e,t)}function ny(e,t,s){s=typeof s=="function"?s:i;var a=s?s(e,t):i;return a===i?Cs(e,t,i,s):!!a}function Da(e){if(!yt(e))return!1;var t=Zt(e);return t==b||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ls(e)}function oy(e){return typeof e=="number"&&Hc(e)}function ti(e){if(!ut(e))return!1;var t=Zt(e);return t==ee||t==fe||t==R||t==_t}function uh(e){return typeof e=="number"&&e==_e(e)}function Yn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function ut(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var hh=mr?fr(mr):hd;function ay(e,t){return e===t||aa(e,t,Ia(t))}function cy(e,t,s){return s=typeof s=="function"?s:i,aa(e,t,Ia(t),s)}function uy(e){return lh(e)&&e!=+e}function hy(e){if(Gd(e))throw new de(h);return ru(e)}function ly(e){return e===null}function fy(e){return e==null}function lh(e){return typeof e=="number"||yt(e)&&Zt(e)==Ne}function Ls(e){if(!yt(e)||Zt(e)!=Pe)return!1;var t=xn(e);if(t===null)return!0;var s=Ue.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&_n.call(s)==cp}var Fa=qr?fr(qr):ld;function py(e){return uh(e)&&e>=-k&&e<=k}var fh=ms?fr(ms):fd;function Xn(e){return typeof e=="string"||!me(e)&&yt(e)&&Zt(e)==Ze}function dr(e){return typeof e=="symbol"||yt(e)&&Zt(e)==Qe}var os=Oi?fr(Oi):pd;function dy(e){return e===i}function gy(e){return yt(e)&&Wt(e)==ze}function vy(e){return yt(e)&&Zt(e)==et}var yy=zn(ua),my=zn(function(e,t){return e<=t});function ph(e){if(!e)return[];if(or(e))return Xn(e)?Tr(e):nr(e);if(ws&&e[ws])return Yf(e[ws]());var t=Wt(e),s=t==we?Yo:t==$e?vn:as;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=Sr(e),e===ce||e===-ce){var t=e<0?-1:1;return t*U}return e===e?e:0}function _e(e){var t=ri(e),s=t%1;return t===t?s?t-s:t:0}function dh(e){return e?Li(_e(e),0,H):0}function Sr(e){if(typeof e=="number")return e;if(dr(e))return z;if(ut(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ut(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Lc(e);var s=So.test(e);return s||Ao.test(e)?ye(e.slice(2),s?2:8):Io.test(e)?z:+e}function gh(e){return kr(e,ar(e))}function _y(e){return e?Li(_e(e),-k,k):e===0?e:0}function je(e){return e==null?"":pr(e)}var wy=is(function(e,t){if(Ts(t)||or(t)){kr(t,zt(t),e);return}for(var s in t)Ue.call(t,s)&&Ss(e,s,t[s])}),vh=is(function(e,t){kr(t,ar(t),e)}),Zn=is(function(e,t,s,a){kr(t,ar(t),e,a)}),by=is(function(e,t,s,a){kr(t,zt(t),e,a)}),Ey=Qr(ra);function xy(e,t){var s=rs(e);return t==null?s:Wc(s,t)}var Iy=Ie(function(e,t){e=Je(e);var s=-1,a=t.length,l=a>2?t[2]:i;for(l&&Qt(t[0],t[1],l)&&(a=1);++s<a;)for(var p=t[s],m=ar(p),_=-1,S=m.length;++_<S;){var L=m[_],D=e[L];(D===i||Lr(D,Qi[L])&&!Ue.call(e,L))&&(e[L]=p[L])}return e}),Sy=Ie(function(e){return e.push(i,Lu),qt(yh,i,e)});function Py(e,t){return Oc(e,se(t,3),zr)}function Ay(e,t){return Oc(e,se(t,3),sa)}function Cy(e,t){return e==null?e:ia(e,se(t,3),ar)}function Oy(e,t){return e==null?e:Qc(e,se(t,3),ar)}function Ry(e,t){return e&&zr(e,se(t,3))}function Ty(e,t){return e&&sa(e,se(t,3))}function Ny(e){return e==null?[]:Ln(e,zt(e))}function Ly(e){return e==null?[]:Ln(e,ar(e))}function $a(e,t,s){var a=e==null?i:Di(e,t);return a===i?s:a}function Dy(e,t){return e!=null&&$u(e,t,id)}function ja(e,t){return e!=null&&$u(e,t,sd)}var Fy=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=wn.call(t)),e[t]=s},Ua(cr)),$y=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=wn.call(t)),Ue.call(e,t)?e[t].push(s):e[t]=[s]},se),jy=Ie(As);function zt(e){return or(e)?Kc(e):ca(e)}function ar(e){return or(e)?Kc(e,!0):dd(e)}function My(e,t){var s={};return t=se(t,3),zr(e,function(a,l,p){Xr(s,t(a,l,p),a)}),s}function Uy(e,t){var s={};return t=se(t,3),zr(e,function(a,l,p){Xr(s,l,t(a,l,p))}),s}var qy=is(function(e,t,s){Dn(e,t,s)}),yh=is(function(e,t,s,a){Dn(e,t,s,a)}),zy=Qr(function(e,t){var s={};if(e==null)return s;var a=!1;t=nt(t,function(p){return p=gi(p,e),a||(a=p.length>1),p}),kr(e,Ea(e),s),a&&(s=Er(s,K|J|G,Fd));for(var l=t.length;l--;)da(s,t[l]);return s});function ky(e,t){return mh(e,Jn(se(t)))}var Hy=Qr(function(e,t){return e==null?{}:vd(e,t)});function mh(e,t){if(e==null)return{};var s=nt(Ea(e),function(a){return[a]});return t=se(t),uu(e,s,function(a,l){return t(a,l[0])})}function By(e,t,s){t=gi(t,e);var a=-1,l=t.length;for(l||(l=1,e=i);++a<l;){var p=e==null?i:e[Hr(t[a])];p===i&&(a=l,p=s),e=ti(p)?p.call(e):p}return e}function Vy(e,t,s){return e==null?e:Os(e,t,s)}function Ky(e,t,s,a){return a=typeof a=="function"?a:i,e==null?e:Os(e,t,s,a)}var _h=Tu(zt),wh=Tu(ar);function Gy(e,t,s){var a=me(e),l=a||yi(e)||os(e);if(t=se(t,4),s==null){var p=e&&e.constructor;l?s=a?new p:[]:ut(e)?s=ti(p)?rs(xn(e)):{}:s={}}return(l?_r:zr)(e,function(m,_,S){return t(s,m,_,S)}),s}function Wy(e,t){return e==null?!0:da(e,t)}function Jy(e,t,s){return e==null?e:du(e,t,ya(s))}function Yy(e,t,s,a){return a=typeof a=="function"?a:i,e==null?e:du(e,t,ya(s),a)}function as(e){return e==null?[]:Jo(e,zt(e))}function Xy(e){return e==null?[]:Jo(e,ar(e))}function Zy(e,t,s){return s===i&&(s=t,t=i),s!==i&&(s=Sr(s),s=s===s?s:0),t!==i&&(t=Sr(t),t=t===t?t:0),Li(Sr(e),t,s)}function Qy(e,t,s){return t=ri(t),s===i?(s=t,t=0):s=ri(s),e=Sr(e),nd(e,t,s)}function e0(e,t,s){if(s&&typeof s!="boolean"&&Qt(e,t,s)&&(t=s=i),s===i&&(typeof t=="boolean"?(s=t,t=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ri(e),t===i?(t=e,e=0):t=ri(t)),e>t){var a=e;e=t,t=a}if(s||e%1||t%1){var l=Bc();return Gt(e+l*(t-e+Ge("1e-"+((l+"").length-1))),t)}return la(e,t)}var t0=ss(function(e,t,s){return t=t.toLowerCase(),e+(s?bh(t):t)});function bh(e){return Ma(je(e).toLowerCase())}function Eh(e){return e=je(e),e&&e.replace(Gr,Vf).replace(qo,"")}function r0(e,t,s){e=je(e),t=pr(t);var a=e.length;s=s===i?a:Li(_e(s),0,a);var l=s;return s-=t.length,s>=0&&e.slice(s,l)==t}function i0(e){return e=je(e),e&&it.test(e)?e.replace(Ii,Kf):e}function s0(e){return e=je(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var n0=ss(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),o0=ss(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),a0=Su("toLowerCase");function c0(e,t,s){e=je(e),t=_e(t);var a=t?Xi(e):0;if(!t||a>=t)return e;var l=(t-a)/2;return qn(An(l),s)+e+qn(Pn(l),s)}function u0(e,t,s){e=je(e),t=_e(t);var a=t?Xi(e):0;return t&&a<t?e+qn(t-a,s):e}function h0(e,t,s){e=je(e),t=_e(t);var a=t?Xi(e):0;return t&&a<t?qn(t-a,s)+e:e}function l0(e,t,s){return s||t==null?t=0:t&&(t=+t),mp(je(e).replace(gt,""),t||0)}function f0(e,t,s){return(s?Qt(e,t,s):t===i)?t=1:t=_e(t),fa(je(e),t)}function p0(){var e=arguments,t=je(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var d0=ss(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function g0(e,t,s){return s&&typeof s!="number"&&Qt(e,t,s)&&(t=s=i),s=s===i?H:s>>>0,s?(e=je(e),e&&(typeof t=="string"||t!=null&&!Fa(t))&&(t=pr(t),!t&&Yi(e))?vi(Tr(e),0,s):e.split(t,s)):[]}var v0=ss(function(e,t,s){return e+(s?" ":"")+Ma(t)});function y0(e,t,s){return e=je(e),s=s==null?0:Li(_e(s),0,e.length),t=pr(t),e.slice(s,s+t.length)==t}function m0(e,t,s){var a=f.templateSettings;s&&Qt(e,t,s)&&(t=i),e=je(e),t=Zn({},t,a,Nu);var l=Zn({},t.imports,a.imports,Nu),p=zt(l),m=Jo(l,p),_,S,L=0,D=t.interpolate||ki,q="__p += '",W=Xo((t.escape||ki).source+"|"+D.source+"|"+(D===ct?xo:ki).source+"|"+(t.evaluate||ki).source+"|$","g"),te="//# sourceURL="+(Ue.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zo+"]")+`
`;e.replace(W,function(ae,Se,Oe,gr,er,vr){return Oe||(Oe=gr),q+=e.slice(L,vr).replace(Oo,Gf),Se&&(_=!0,q+=`' +
__e(`+Se+`) +
'`),er&&(S=!0,q+=`';
`+er+`;
__p += '`),Oe&&(q+=`' +
((__t = (`+Oe+`)) == null ? '' : __t) +
'`),L=vr+ae.length,ae}),q+=`';
`;var oe=Ue.call(t,"variable")&&t.variable;if(!oe)q=`with (obj) {
`+q+`
}
`;else if(bo.test(oe))throw new de(y);q=(S?q.replace(Mr,""):q).replace(Yt,"$1").replace(Kr,"$1;"),q="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+q+`return __p
}`;var be=Ih(function(){return Fe(p,te+"return "+q).apply(i,m)});if(be.source=q,Da(be))throw be;return be}function _0(e){return je(e).toLowerCase()}function w0(e){return je(e).toUpperCase()}function b0(e,t,s){if(e=je(e),e&&(s||t===i))return Lc(e);if(!e||!(t=pr(t)))return e;var a=Tr(e),l=Tr(t),p=Dc(a,l),m=Fc(a,l)+1;return vi(a,p,m).join("")}function E0(e,t,s){if(e=je(e),e&&(s||t===i))return e.slice(0,jc(e)+1);if(!e||!(t=pr(t)))return e;var a=Tr(e),l=Fc(a,Tr(t))+1;return vi(a,0,l).join("")}function x0(e,t,s){if(e=je(e),e&&(s||t===i))return e.replace(gt,"");if(!e||!(t=pr(t)))return e;var a=Tr(e),l=Dc(a,Tr(t));return vi(a,l).join("")}function I0(e,t){var s=re,a=ue;if(ut(t)){var l="separator"in t?t.separator:l;s="length"in t?_e(t.length):s,a="omission"in t?pr(t.omission):a}e=je(e);var p=e.length;if(Yi(e)){var m=Tr(e);p=m.length}if(s>=p)return e;var _=s-Xi(a);if(_<1)return a;var S=m?vi(m,0,_).join(""):e.slice(0,_);if(l===i)return S+a;if(m&&(_+=S.length-_),Fa(l)){if(e.slice(_).search(l)){var L,D=S;for(l.global||(l=Xo(l.source,je(yr.exec(l))+"g")),l.lastIndex=0;L=l.exec(D);)var q=L.index;S=S.slice(0,q===i?_:q)}}else if(e.indexOf(pr(l),_)!=_){var W=S.lastIndexOf(l);W>-1&&(S=S.slice(0,W))}return S+a}function S0(e){return e=je(e),e&&lt.test(e)?e.replace(ai,ep):e}var P0=ss(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),Ma=Su("toUpperCase");function xh(e,t,s){return e=je(e),t=s?i:t,t===i?Jf(e)?ip(e):qf(e):e.match(t)||[]}var Ih=Ie(function(e,t){try{return qt(e,i,t)}catch(s){return Da(s)?s:new de(s)}}),A0=Qr(function(e,t){return _r(t,function(s){s=Hr(s),Xr(e,s,Na(e[s],e))}),e});function C0(e){var t=e==null?0:e.length,s=se();return e=t?nt(e,function(a){if(typeof a[1]!="function")throw new wr(d);return[s(a[0]),a[1]]}):[],Ie(function(a){for(var l=-1;++l<t;){var p=e[l];if(qt(p[0],this,a))return qt(p[1],this,a)}})}function O0(e){return ed(Er(e,K))}function Ua(e){return function(){return e}}function R0(e,t){return e==null||e!==e?t:e}var T0=Au(),N0=Au(!0);function cr(e){return e}function qa(e){return iu(typeof e=="function"?e:Er(e,K))}function L0(e){return nu(Er(e,K))}function D0(e,t){return ou(e,Er(t,K))}var F0=Ie(function(e,t){return function(s){return As(s,e,t)}}),$0=Ie(function(e,t){return function(s){return As(e,s,t)}});function za(e,t,s){var a=zt(t),l=Ln(t,a);s==null&&!(ut(t)&&(l.length||!a.length))&&(s=t,t=e,e=this,l=Ln(t,zt(t)));var p=!(ut(s)&&"chain"in s)||!!s.chain,m=ti(e);return _r(l,function(_){var S=t[_];e[_]=S,m&&(e.prototype[_]=function(){var L=this.__chain__;if(p||L){var D=e(this.__wrapped__),q=D.__actions__=nr(this.__actions__);return q.push({func:S,args:arguments,thisArg:e}),D.__chain__=L,D}return S.apply(e,hi([this.value()],arguments))})}),e}function j0(){return Ce._===this&&(Ce._=up),this}function ka(){}function M0(e){return e=_e(e),Ie(function(t){return au(t,e)})}var U0=_a(nt),q0=_a(Cc),z0=_a(Bo);function Sh(e){return Pa(e)?Vo(Hr(e)):yd(e)}function k0(e){return function(t){return e==null?i:Di(e,t)}}var H0=Ou(),B0=Ou(!0);function Ha(){return[]}function Ba(){return!1}function V0(){return{}}function K0(){return""}function G0(){return!0}function W0(e,t){if(e=_e(e),e<1||e>k)return[];var s=H,a=Gt(e,H);t=se(t),e-=H;for(var l=Wo(a,t);++s<e;)t(s);return l}function J0(e){return me(e)?nt(e,Hr):dr(e)?[e]:nr(Vu(je(e)))}function Y0(e){var t=++ap;return je(e)+t}var X0=Un(function(e,t){return e+t},0),Z0=wa("ceil"),Q0=Un(function(e,t){return e/t},1),e1=wa("floor");function t1(e){return e&&e.length?Nn(e,cr,na):i}function r1(e,t){return e&&e.length?Nn(e,se(t,2),na):i}function i1(e){return Tc(e,cr)}function s1(e,t){return Tc(e,se(t,2))}function n1(e){return e&&e.length?Nn(e,cr,ua):i}function o1(e,t){return e&&e.length?Nn(e,se(t,2),ua):i}var a1=Un(function(e,t){return e*t},1),c1=wa("round"),u1=Un(function(e,t){return e-t},0);function h1(e){return e&&e.length?Go(e,cr):0}function l1(e,t){return e&&e.length?Go(e,se(t,2)):0}return f.after=Lv,f.ary=rh,f.assign=wy,f.assignIn=vh,f.assignInWith=Zn,f.assignWith=by,f.at=Ey,f.before=ih,f.bind=Na,f.bindAll=A0,f.bindKey=sh,f.castArray=Vv,f.chain=Qu,f.chunk=eg,f.compact=tg,f.concat=rg,f.cond=C0,f.conforms=O0,f.constant=Ua,f.countBy=hv,f.create=xy,f.curry=nh,f.curryRight=oh,f.debounce=ah,f.defaults=Iy,f.defaultsDeep=Sy,f.defer=Dv,f.delay=Fv,f.difference=ig,f.differenceBy=sg,f.differenceWith=ng,f.drop=og,f.dropRight=ag,f.dropRightWhile=cg,f.dropWhile=ug,f.fill=hg,f.filter=fv,f.flatMap=gv,f.flatMapDeep=vv,f.flatMapDepth=yv,f.flatten=Ju,f.flattenDeep=lg,f.flattenDepth=fg,f.flip=$v,f.flow=T0,f.flowRight=N0,f.fromPairs=pg,f.functions=Ny,f.functionsIn=Ly,f.groupBy=mv,f.initial=gg,f.intersection=vg,f.intersectionBy=yg,f.intersectionWith=mg,f.invert=Fy,f.invertBy=$y,f.invokeMap=wv,f.iteratee=qa,f.keyBy=bv,f.keys=zt,f.keysIn=ar,f.map=Kn,f.mapKeys=My,f.mapValues=Uy,f.matches=L0,f.matchesProperty=D0,f.memoize=Wn,f.merge=qy,f.mergeWith=yh,f.method=F0,f.methodOf=$0,f.mixin=za,f.negate=Jn,f.nthArg=M0,f.omit=zy,f.omitBy=ky,f.once=jv,f.orderBy=Ev,f.over=U0,f.overArgs=Mv,f.overEvery=q0,f.overSome=z0,f.partial=La,f.partialRight=ch,f.partition=xv,f.pick=Hy,f.pickBy=mh,f.property=Sh,f.propertyOf=k0,f.pull=Eg,f.pullAll=Xu,f.pullAllBy=xg,f.pullAllWith=Ig,f.pullAt=Sg,f.range=H0,f.rangeRight=B0,f.rearg=Uv,f.reject=Pv,f.remove=Pg,f.rest=qv,f.reverse=Ra,f.sampleSize=Cv,f.set=Vy,f.setWith=Ky,f.shuffle=Ov,f.slice=Ag,f.sortBy=Nv,f.sortedUniq=Dg,f.sortedUniqBy=Fg,f.split=g0,f.spread=zv,f.tail=$g,f.take=jg,f.takeRight=Mg,f.takeRightWhile=Ug,f.takeWhile=qg,f.tap=tv,f.throttle=kv,f.thru=Vn,f.toArray=ph,f.toPairs=_h,f.toPairsIn=wh,f.toPath=J0,f.toPlainObject=gh,f.transform=Gy,f.unary=Hv,f.union=zg,f.unionBy=kg,f.unionWith=Hg,f.uniq=Bg,f.uniqBy=Vg,f.uniqWith=Kg,f.unset=Wy,f.unzip=Ta,f.unzipWith=Zu,f.update=Jy,f.updateWith=Yy,f.values=as,f.valuesIn=Xy,f.without=Gg,f.words=xh,f.wrap=Bv,f.xor=Wg,f.xorBy=Jg,f.xorWith=Yg,f.zip=Xg,f.zipObject=Zg,f.zipObjectDeep=Qg,f.zipWith=ev,f.entries=_h,f.entriesIn=wh,f.extend=vh,f.extendWith=Zn,za(f,f),f.add=X0,f.attempt=Ih,f.camelCase=t0,f.capitalize=bh,f.ceil=Z0,f.clamp=Zy,f.clone=Kv,f.cloneDeep=Wv,f.cloneDeepWith=Jv,f.cloneWith=Gv,f.conformsTo=Yv,f.deburr=Eh,f.defaultTo=R0,f.divide=Q0,f.endsWith=r0,f.eq=Lr,f.escape=i0,f.escapeRegExp=s0,f.every=lv,f.find=pv,f.findIndex=Gu,f.findKey=Py,f.findLast=dv,f.findLastIndex=Wu,f.findLastKey=Ay,f.floor=e1,f.forEach=eh,f.forEachRight=th,f.forIn=Cy,f.forInRight=Oy,f.forOwn=Ry,f.forOwnRight=Ty,f.get=$a,f.gt=Xv,f.gte=Zv,f.has=Dy,f.hasIn=ja,f.head=Yu,f.identity=cr,f.includes=_v,f.indexOf=dg,f.inRange=Qy,f.invoke=jy,f.isArguments=ji,f.isArray=me,f.isArrayBuffer=Qv,f.isArrayLike=or,f.isArrayLikeObject=Et,f.isBoolean=ey,f.isBuffer=yi,f.isDate=ty,f.isElement=ry,f.isEmpty=iy,f.isEqual=sy,f.isEqualWith=ny,f.isError=Da,f.isFinite=oy,f.isFunction=ti,f.isInteger=uh,f.isLength=Yn,f.isMap=hh,f.isMatch=ay,f.isMatchWith=cy,f.isNaN=uy,f.isNative=hy,f.isNil=fy,f.isNull=ly,f.isNumber=lh,f.isObject=ut,f.isObjectLike=yt,f.isPlainObject=Ls,f.isRegExp=Fa,f.isSafeInteger=py,f.isSet=fh,f.isString=Xn,f.isSymbol=dr,f.isTypedArray=os,f.isUndefined=dy,f.isWeakMap=gy,f.isWeakSet=vy,f.join=_g,f.kebabCase=n0,f.last=Ir,f.lastIndexOf=wg,f.lowerCase=o0,f.lowerFirst=a0,f.lt=yy,f.lte=my,f.max=t1,f.maxBy=r1,f.mean=i1,f.meanBy=s1,f.min=n1,f.minBy=o1,f.stubArray=Ha,f.stubFalse=Ba,f.stubObject=V0,f.stubString=K0,f.stubTrue=G0,f.multiply=a1,f.nth=bg,f.noConflict=j0,f.noop=ka,f.now=Gn,f.pad=c0,f.padEnd=u0,f.padStart=h0,f.parseInt=l0,f.random=e0,f.reduce=Iv,f.reduceRight=Sv,f.repeat=f0,f.replace=p0,f.result=By,f.round=c1,f.runInContext=I,f.sample=Av,f.size=Rv,f.snakeCase=d0,f.some=Tv,f.sortedIndex=Cg,f.sortedIndexBy=Og,f.sortedIndexOf=Rg,f.sortedLastIndex=Tg,f.sortedLastIndexBy=Ng,f.sortedLastIndexOf=Lg,f.startCase=v0,f.startsWith=y0,f.subtract=u1,f.sum=h1,f.sumBy=l1,f.template=m0,f.times=W0,f.toFinite=ri,f.toInteger=_e,f.toLength=dh,f.toLower=_0,f.toNumber=Sr,f.toSafeInteger=_y,f.toString=je,f.toUpper=w0,f.trim=b0,f.trimEnd=E0,f.trimStart=x0,f.truncate=I0,f.unescape=S0,f.uniqueId=Y0,f.upperCase=P0,f.upperFirst=Ma,f.each=eh,f.eachRight=th,f.first=Yu,za(f,function(){var e={};return zr(f,function(t,s){Ue.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),_r(["drop","take"],function(e,t){Ae.prototype[e]=function(s){s=s===i?1:Mt(_e(s),0);var a=this.__filtered__&&!t?new Ae(this):this.clone();return a.__filtered__?a.__takeCount__=Gt(s,a.__takeCount__):a.__views__.push({size:Gt(s,H),type:e+(a.__dir__<0?"Right":"")}),a},Ae.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),_r(["filter","map","takeWhile"],function(e,t){var s=t+1,a=s==v||s==X;Ae.prototype[e]=function(l){var p=this.clone();return p.__iteratees__.push({iteratee:se(l,3),type:s}),p.__filtered__=p.__filtered__||a,p}}),_r(["head","last"],function(e,t){var s="take"+(t?"Right":"");Ae.prototype[e]=function(){return this[s](1).value()[0]}}),_r(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[s](1)}}),Ae.prototype.compact=function(){return this.filter(cr)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=Ie(function(e,t){return typeof e=="function"?new Ae(this):this.map(function(s){return As(s,e,t)})}),Ae.prototype.reject=function(e){return this.filter(Jn(se(e)))},Ae.prototype.slice=function(e,t){e=_e(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Ae(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==i&&(t=_e(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(H)},zr(Ae.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),l=f[a?"take"+(t=="last"?"Right":""):t],p=a||/^find/.test(t);l&&(f.prototype[t]=function(){var m=this.__wrapped__,_=a?[1]:arguments,S=m instanceof Ae,L=_[0],D=S||me(m),q=function(Se){var Oe=l.apply(f,hi([Se],_));return a&&W?Oe[0]:Oe};D&&s&&typeof L=="function"&&L.length!=1&&(S=D=!1);var W=this.__chain__,te=!!this.__actions__.length,oe=p&&!W,be=S&&!te;if(!p&&D){m=be?m:new Ae(this);var ae=e.apply(m,_);return ae.__actions__.push({func:Vn,args:[q],thisArg:i}),new br(ae,W)}return oe&&be?e.apply(this,_):(ae=this.thru(q),oe?a?ae.value()[0]:ae.value():ae)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var t=yn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(a&&!this.__chain__){var p=this.value();return t.apply(me(p)?p:[],l)}return this[s](function(m){return t.apply(me(m)?m:[],l)})}}),zr(Ae.prototype,function(e,t){var s=f[t];if(s){var a=s.name+"";Ue.call(ts,a)||(ts[a]=[]),ts[a].push({name:t,func:s})}}),ts[Mn(i,Ee).name]=[{name:"wrapper",func:i}],Ae.prototype.clone=Sp,Ae.prototype.reverse=Pp,Ae.prototype.value=Ap,f.prototype.at=rv,f.prototype.chain=iv,f.prototype.commit=sv,f.prototype.next=nv,f.prototype.plant=av,f.prototype.reverse=cv,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=uv,f.prototype.first=f.prototype.head,ws&&(f.prototype[ws]=ov),f},Zi=sp();bt?((bt.exports=Zi)._=Zi,We._=Zi):Ce._=Zi}).call(ks)})(fc,fc.exports);var fE=Object.defineProperty,pE=Object.defineProperties,dE=Object.getOwnPropertyDescriptors,Cl=Object.getOwnPropertySymbols,gE=Object.prototype.hasOwnProperty,vE=Object.prototype.propertyIsEnumerable,Ol=(c,r,i)=>r in c?fE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,eo=(c,r)=>{for(var i in r||(r={}))gE.call(r,i)&&Ol(c,i,r[i]);if(Cl)for(var i of Cl(r))vE.call(r,i)&&Ol(c,i,r[i]);return c},yE=(c,r)=>pE(c,dE(r));function Cr(c,r,i){let n;const o=pc(c);return r.rpcMap&&(n=r.rpcMap[o]),n||(n=`${lE}?chainId=eip155:${o}&projectId=${i}`),n}function pc(c){return c.includes("eip155")?Number(c.split(":")[1]):Number(c)}function Lf(c){return c.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function mE(c,r){const i=Object.keys(r.namespaces).filter(o=>o.includes(c));if(!i.length)return[];const n=[];return i.forEach(o=>{const h=r.namespaces[o].accounts;n.push(...h)}),n}function _E(c={},r={}){const i=Rl(c),n=Rl(r);return fc.exports.merge(i,n)}function Rl(c){var r,i,n,o;const h={};if(!io(c))return h;for(const[d,y]of Object.entries(c)){const w=Hl(d)?[d]:y.chains,A=y.methods||[],F=y.events||[],K=y.rpcMap||{},J=so(d);h[J]=yE(eo(eo({},h[J]),y),{chains:Ka(w,(r=h[J])==null?void 0:r.chains),methods:Ka(A,(i=h[J])==null?void 0:i.methods),events:Ka(F,(n=h[J])==null?void 0:n.events),rpcMap:eo(eo({},K),(o=h[J])==null?void 0:o.rpcMap)})}return h}function wE(c){return c.includes(":")?c.split(":")[2]:c}function bE(c){const r={};for(const[i,n]of Object.entries(c)){const o=n.methods||[],h=n.events||[],d=n.accounts||[],y=Hl(i)?[i]:n.chains?n.chains:Lf(n.accounts);r[i]={chains:y,methods:o,events:h,accounts:d}}return r}const Df={},It=c=>Df[c],nc=(c,r)=>{Df[c]=r};class EE{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Cr(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Cr(r,this.namespace);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}}class xE{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,i){const n=pc(r);if(!this.httpProviders[n]){const o=i||Cr(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,i){const n=i||Cr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=pc(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}async handleSwitchChain(r){var i,n;let o=r.request.params?(i=r.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class IE{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Cr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Cr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}}class SE{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Cr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Cr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}}class PE{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i);r[i]=this.createHttpProvider(i,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}getCardanoRPCUrl(r){const i=this.namespace.rpcMap;if(i)return i[r]}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}}class AE{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Cr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Cr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}}class CE{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Cr(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Cr(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new zi(n,It("disableProviderPing")))}}var OE=Object.defineProperty,RE=Object.defineProperties,TE=Object.getOwnPropertyDescriptors,Tl=Object.getOwnPropertySymbols,NE=Object.prototype.hasOwnProperty,LE=Object.prototype.propertyIsEnumerable,Nl=(c,r,i)=>r in c?OE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,to=(c,r)=>{for(var i in r||(r={}))NE.call(r,i)&&Nl(c,i,r[i]);if(Tl)for(var i of Tl(r))LE.call(r,i)&&Nl(c,i,r[i]);return c},oc=(c,r)=>RE(c,TE(r));class Pc{constructor(r){this.events=new kt,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Re.pino(Re.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Pl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const i=new Pc(r);return await i.initialize(),i}async request(r,i){const[n,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:to({},r),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(r,i,n){this.request(r,n).then(o=>i(null,o)).catch(o=>i(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:rr("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}removeListener(r,i){this.events.removeListener(r,i)}off(r,i){this.events.off(r,i)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=bE(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Tf)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,i){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(ps(i)){for(const n of i)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await sE.init({logger:this.providerOpts.logger||Pl,relayUrl:this.providerOpts.relayUrl||cE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(i=>so(i)))];nc("client",this.client),nc("events",this.events),nc("disableProviderPing",this.disableProviderPing),r.forEach(i=>{if(!this.session)return;const n=mE(i,this.session),o=Lf(n),h=_E(this.namespaces,this.optionalNamespaces),d=oc(to({},h[i]),{accounts:n,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new xE({namespace:d});break;case"solana":this.rpcProviders[i]=new IE({namespace:d});break;case"cosmos":this.rpcProviders[i]=new SE({namespace:d});break;case"polkadot":this.rpcProviders[i]=new EE({namespace:d});break;case"cip34":this.rpcProviders[i]=new PE({namespace:d});break;case"elrond":this.rpcProviders[i]=new AE({namespace:d});break;case"multiversx":this.rpcProviders[i]=new CE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:i}=r,{event:n}=i;if(n.name==="accountsChanged"){const o=n.data;o&&ps(o)&&this.events.emit("accountsChanged",o.map(wE))}else n.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:i})=>{var n;const{namespaces:o}=i,h=(n=this.client)==null?void 0:n.session.get(r);this.session=oc(to({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:i})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",oc(to({},rr("USER_DISCONNECTED")),{data:r.topic}))}),this.on(xi.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var i;this.getProvider(r).updateNamespace((i=this.session)==null?void 0:i.namespaces[r])})}setNamespaces(r){const{namespaces:i,optionalNamespaces:n,sessionProperties:o}=r;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(r){const[i,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(d=>so(d)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const o=so(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,i=!1){var n;if(!this.namespaces)return;const[o,h]=this.validateChain(r);i||this.getProvider(o).setDefaultChain(h),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,i){this.client.core.storage.setItem(`${Al}/${r}`,i)}async getFromStore(r){return await this.client.core.storage.getItem(`${Al}/${r}`)}}const DE=Pc,FE="wc",$E="ethereum_provider",jE=`${FE}@2:${$E}:`,ME="https://rpc.walletconnect.com/v1/",dc=["eth_sendTransaction","personal_sign"],UE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],gc=["chainChanged","accountsChanged"],qE=["message","disconnect","connect"];var zE=Object.defineProperty,kE=Object.defineProperties,HE=Object.getOwnPropertyDescriptors,Ll=Object.getOwnPropertySymbols,BE=Object.prototype.hasOwnProperty,VE=Object.prototype.propertyIsEnumerable,Dl=(c,r,i)=>r in c?zE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Hs=(c,r)=>{for(var i in r||(r={}))BE.call(r,i)&&Dl(c,i,r[i]);if(Ll)for(var i of Ll(r))VE.call(r,i)&&Dl(c,i,r[i]);return c},Fl=(c,r)=>kE(c,HE(r));function lo(c){return Number(c[0].split(":")[1])}function ac(c){return`0x${c.toString(16)}`}function KE(c){const{chains:r,optionalChains:i,methods:n,optionalMethods:o,events:h,optionalEvents:d,rpcMap:y}=c;if(!ps(r))throw new Error("Invalid chains");const w={chains:r,methods:n||dc,events:h||gc,rpcMap:Hs({},r.length?{[lo(r)]:y[lo(r)]}:{})},A=h==null?void 0:h.filter(G=>!gc.includes(G)),F=n==null?void 0:n.filter(G=>!dc.includes(G));if(!i&&!d&&!o&&!(A!=null&&A.length)&&!(F!=null&&F.length))return{required:r.length?w:void 0};const K=(A==null?void 0:A.length)&&(F==null?void 0:F.length)||!i,J={chains:[...new Set(K?w.chains.concat(i||[]):i)],methods:[...new Set(w.methods.concat(o!=null&&o.length?o:UE))],events:[...new Set(w.events.concat(d||qE))],rpcMap:y};return{required:r.length?w:void 0,optional:i.length?J:void 0}}class Ac{constructor(){this.events=new kt.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=jE,this.on=(r,i)=>(this.events.on(r,i),this),this.once=(r,i)=>(this.events.once(r,i),this),this.removeListener=(r,i)=>(this.events.removeListener(r,i),this),this.off=(r,i)=>(this.events.off(r,i),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const i=new Ac;return await i.initialize(r),i}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,i){this.signer.sendAsync(r,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:i,optional:n}=KE(this.rpc);try{const o=await new Promise(async(d,y)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(A=>{!A.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Fl(Hs({namespaces:Hs({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(A=>{d(A)}).catch(A=>{y(new Error(A.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const h=X1(o.namespaces,[this.namespace]);this.setAccounts(h),this.events.emit("connect",{chainId:ac(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:i}=r,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const i=parseInt(r);this.chainId=i,this.events.emit("chainChanged",ac(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",Fl(Hs({},rr("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const i=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",ac(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const i=this.parseChainId(r);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(r){const[i,n,o]=r.split(":");return{chainId:`${i}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var i,n;const o=(i=r==null?void 0:r.chains)!=null?i:[],h=(n=r==null?void 0:r.optionalChains)!=null?n:[],d=o.concat(h);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=o.length?(r==null?void 0:r.methods)||dc:[],w=o.length?(r==null?void 0:r.events)||gc:[],A=(r==null?void 0:r.optionalMethods)||[],F=(r==null?void 0:r.optionalEvents)||[],K=(r==null?void 0:r.rpcMap)||this.buildRpcMap(d,r.projectId),J=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(G=>this.formatChainId(G)),optionalChains:h.map(G=>this.formatChainId(G)),methods:y,events:w,optionalMethods:A,optionalEvents:F,rpcMap:K,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:J,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,i){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,i)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?lo(this.rpc.chains):lo(this.rpc.optionalChains),this.signer=await DE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await Z1(()=>import("./index-72b80703.js").then(o=>o.a),["./index-72b80703.js","./index-f0cc94c3.js","./index-c452249a.css"],import.meta.url);i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Hs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:i,optionalChains:n,rpcMap:o}=r;i&&ps(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&ps(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(r,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${ME}?chainId=eip155:${r}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(i=>this.parseAccount(i))}}const rx=Ac;export{rx as EthereumProvider,qE as OPTIONAL_EVENTS,UE as OPTIONAL_METHODS,gc as REQUIRED_EVENTS,dc as REQUIRED_METHODS,Ac as default};
